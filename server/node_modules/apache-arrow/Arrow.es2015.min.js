// Licensed to the Apache Software Foundation (ASF) under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The ASF licenses this file
// to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.  You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing,
// software distributed under the License is distributed on an
// "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
// KIND, either express or implied.  See the License for the
// specific language governing permissions and limitations
// under the License.
(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :
    typeof define === 'function' && define.amd ? define(['exports'], factory) :
    (factory(global.Arrow = global.Arrow || {}));
}(this, (function (exports) {'use strict';var g;function aa(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}var ba="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};
function ca(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");}var da=ca(this);function ea(a,b){if(b)a:{var c=da;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];if(!(e in c))break a;c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&ba(c,a,{configurable:!0,writable:!0,value:b})}}
ea("Symbol",function(a){function b(f){if(this instanceof b)throw new TypeError("Symbol is not a constructor");return new c(d+(f||"")+"_"+e++,f)}function c(f,h){this.dc=f;ba(this,"description",{configurable:!0,writable:!0,value:h})}if(a)return a;c.prototype.toString=function(){return this.dc};var d="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",e=0;return b});
ea("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),c=0;c<b.length;c++){var d=da[b[c]];"function"===typeof d&&"function"!=typeof d.prototype[a]&&ba(d.prototype,a,{configurable:!0,writable:!0,value:function(){return fa(aa(this))}})}return a});ea("Symbol.asyncIterator",function(a){return a?a:Symbol("Symbol.asyncIterator")});
function fa(a){a={next:a};a[Symbol.iterator]=function(){return this};return a}function ha(a){function b(d){return a.next(d)}function c(d){return a.throw(d)}return new Promise(function(d,e){function f(h){h.done?d(h.value):Promise.resolve(h.value).then(b,c).then(f,e)}f(a.next())})}function l(a){return ha(a())}
function ia(a){var b=a[Symbol.asyncIterator];if(void 0!==b)a=b.call(a);else{b=ja;var c="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];a=c?c.call(a):{next:aa(a)};a=new b(a)}return a}
function ja(a){this[Symbol.asyncIterator]=function(){return this};this[Symbol.iterator]=function(){return a};this.next=function(b){return Promise.resolve(a.next(b))};void 0!==a["throw"]&&(this["throw"]=function(b){return Promise.resolve(a["throw"](b))});void 0!==a["return"]&&(this["return"]=function(b){return Promise.resolve(a["return"](b))})}function m(a,b){this.action=a;this.value=b}function ka(a,b,c,d){this.method=a;this.ia=b;this.resolve=c;this.reject=d}
function la(a){this.frame=a;this.next=null}function ma(){this.fb=this.X=null}ma.prototype.first=function(){if(this.X)return this.X.frame;throw Error("no frames in executionQueue");};function na(a){a.X&&(a.X=a.X.next,a.X||(a.fb=null))}ma.prototype.enqueue=function(a){a=new la(a);this.fb?this.fb.next=a:this.X=a;this.fb=a};
function oa(a){this.$b=a;this.P=null;this.K=new ma;this[Symbol.asyncIterator]=function(){return this};var b=this;this.uc=function(c){var d=b.K.first();!0===c.done?(b.P=null,d.method="next",d.ia=c.value):(d.resolve({value:c.value,done:!1}),na(b.K));pa(b)};this.tc=function(c){qa(b,c)};this.yb=function(c){ra(b,c)}}function sa(a,b,c){return new Promise(function(d,e){var f=null===a.K.X;a.K.enqueue(new ka(b,c,d,e));f&&pa(a)})}oa.prototype.next=function(a){return sa(this,"next",a)};
oa.prototype.return=function(a){return sa(this,"return",new m(0,a))};oa.prototype.throw=function(a){return sa(this,"throw",a)};function pa(a){if(null!==a.K.X)try{if(a.P){if(!a.P)throw Error("no delegate to perform execution");var b=a.K.first();if(b.method in a.P)try{a.P[b.method](b.ia).then(a.uc,a.tc).catch(a.yb)}catch(c){qa(a,c)}else a.P=null,pa(a)}else ta(a)}catch(c){ra(a,c)}}
function ta(a){var b=a.K.first();try{var c=a.$b[b.method](b.ia);if(c.value instanceof m)switch(c.value.action){case 0:Promise.resolve(c.value.value).then(function(d){b.resolve({value:d,done:c.done});na(a.K);pa(a)},function(d){b.reject(d);na(a.K);pa(a)}).catch(a.yb);break;case 1:a.P=ia(c.value.value);b.method="next";b.ia=void 0;pa(a);break;case 2:Promise.resolve(c.value.value).then(function(d){b.method="next";b.ia=d;pa(a)},function(d){b.method="throw";b.ia=d;pa(a)}).catch(a.yb);break;default:throw Error("Unrecognized AsyncGeneratorWrapper$ActionEnum");
}else b.resolve(c),na(a.K),pa(a)}catch(d){b.reject(d),na(a.K),pa(a)}}function qa(a,b){var c=a.K.first();a.P=null;c.method="throw";c.ia=b;pa(a)}function ra(a,b){null!==a.K.X&&(a.K.first().reject(b),na(a.K));a.P&&"return"in a.P&&(a.P["return"](void 0),a.P=null);a.$b["return"](void 0);pa(a)}var ua=new Int32Array(2);new Float32Array(ua.buffer);new Float64Array(ua.buffer);new Uint16Array((new Uint8Array([1,0])).buffer);function va(a,b){this.low=a|0;this.high=b|0}
va.prototype.equals=function(a){return this.low==a.low&&this.high==a.high};var wa=new va(0,0);function xa(){this.g=new ya(new Uint8Array(1024));this.B=1024;this.Ja=1;this.ca=null;this.Jb=0;this.Ia=!1;this.Eb=0;this.Ka=[];this.Ib=0;this.qa=!1}g=xa.prototype;g.clear=function(){this.g.clear();this.B=this.g.m.length;this.Ja=1;this.ca=null;this.Jb=0;this.Ia=!1;this.Eb=0;this.Ka=[];this.Ib=0;this.qa=!1};function za(a){return a.g.T().subarray(a.g.position(),a.g.position()+a.offset())}
function Aa(a,b,c){b>a.Ja&&(a.Ja=b);for(var d=~(a.g.m.length-a.B+c)+1&b-1;a.B<d+b+c;){var e=a.g.m.length,f=a,h=a.g,k=h.m.length;if(k&3221225472)throw Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");var n=k<<1,p=new ya(new Uint8Array(n));p.setPosition(n-k);p.T().set(h.T(),n-k);f.g=p;a.B+=a.g.m.length-e}Ba(a,d)}function Ba(a,b){for(var c=0;c<b;c++)a.g.va(--a.B,0)}g.va=function(a){this.g.va(--this.B,a)};g.Kb=function(a){this.g.Kb(this.B-=2,a)};g.Z=function(a){this.g.Z(this.B-=4,a)};
g.da=function(a){this.g.da(this.B-=8,a)};function Ca(a,b){Aa(a,2,0);a.Kb(b)}function Da(a,b){Aa(a,4,0);a.Z(b)}function Ea(a,b,c,d){if(a.qa||c!=d)Aa(a,1,0),a.va(c),a.slot(b)}function Fa(a,b,c){if(a.qa||b!=c)Ca(a,b),a.slot(0)}function Ga(a,b,c,d){if(a.qa||c!=d)Da(a,c),a.slot(b)}function Ha(a,b,c,d){if(a.qa||!c.equals(d))Aa(a,8,0),a.da(c),a.slot(b)}function q(a,b,c){if(a.qa||0!=c)Ia(a,c),a.slot(b)}function Ja(a){if(a.Ia)throw Error("FlatBuffers: object serialization must not be nested.");}
g.slot=function(a){this.ca[a]=this.offset()};g.offset=function(){return this.g.m.length-this.B};function Ia(a,b){Aa(a,4,0);a.Z(a.offset()-b+4)}function r(a,b){Ja(a);null==a.ca&&(a.ca=[]);a.Jb=b;for(var c=0;c<b;c++)a.ca[c]=0;a.Ia=!0;a.Eb=a.offset()}
function t(a){if(null==a.ca||!a.Ia)throw Error("FlatBuffers: endObject called without startObject");Da(a,0);for(var b=a.offset(),c=a.Jb-1;0<=c&&0==a.ca[c];c--);for(var d=c+1;0<=c;c--)Ca(a,0!=a.ca[c]?b-a.ca[c]:0);Ca(a,b-a.Eb);d=2*(d+2);Ca(a,d);var e=0,f=a.B;c=0;a:for(;c<a.Ka.length;c++){var h=a.g.m.length-a.Ka[c];if(d==Ka(a.g,h)){for(var k=2;k<d;k+=2)if(Ka(a.g,f+k)!=Ka(a.g,h+k))continue a;e=a.Ka[c];break}}e?(a.B=a.g.m.length-b,a.g.Z(a.B,e-b)):(a.Ka.push(a.offset()),a.g.Z(a.g.m.length-b,a.offset()-
b));a.Ia=!1;return b}g.finish=function(a,b,c){c=c?4:0;if(b){Aa(this,this.Ja,8+c);if(4!=b.length)throw Error("FlatBuffers: file identifier must be length 4");for(var d=3;0<=d;d--)this.va(b.charCodeAt(d))}Aa(this,this.Ja,4+c);Ia(this,a);c&&Da(this,this.g.m.length-this.B);this.g.setPosition(this.B)};function La(a,b,c,d){Ja(a);a.Ib=c;Aa(a,4,b*c);Aa(a,d,b*c)}function Ma(a){a.Z(a.Ib);return a.offset()}
function Na(a,b){if(b instanceof Uint8Array)var c=b;else{c=[];for(var d=0;d<b.length;){var e=b.charCodeAt(d++);if(!(55296>e||56320<=e)){var f=b.charCodeAt(d++);e=(e<<10)+f+-56613888}128>e?c.push(e):(2048>e?c.push(e>>6&31|192):(65536>e?c.push(e>>12&15|224):c.push(e>>18&7|240,e>>12&63|128),c.push(e>>6&63|128)),c.push(e&63|128))}}Aa(a,1,0);a.va(0);La(a,1,c.length,1);a.g.setPosition(a.B-=c.length);d=0;b=a.B;for(e=a.g.T();d<c.length;d++)e[b++]=c[d];return Ma(a)}
g.W=function(a,b){return 0==a&&0==b?wa:new va(a,b)};function ya(a){this.m=a;this.Fb=0}g=ya.prototype;g.clear=function(){this.Fb=0};g.T=function(){return this.m};g.position=function(){return this.Fb};g.setPosition=function(a){this.Fb=a};function Oa(a,b){return a.m[b]}function Ka(a,b){return(a.m[b]|a.m[b+1]<<8)<<16>>16}g.v=function(a){return this.m[a]|this.m[a+1]<<8|this.m[a+2]<<16|this.m[a+3]<<24};function Pa(a,b){return new va(a.v(b),a.v(b+4))}g.va=function(a,b){this.m[a]=b};
g.Kb=function(a,b){this.m[a]=b;this.m[a+1]=b>>8};g.Z=function(a,b){this.m[a]=b;this.m[a+1]=b>>8;this.m[a+2]=b>>16;this.m[a+3]=b>>24};g.da=function(a,b){this.Z(a,b.low);this.Z(a+4,b.high)};function v(a,b,c){b-=a.v(b);return c<Ka(a,b)?Ka(a,b+c):0}function Qa(a,b,c){b.h=c+a.v(c);b.g=a;return b}
function Ra(a,b,c){b+=a.v(b);var d=a.v(b),e="",f=0;b+=4;if(1===c)return a.m.subarray(b,b+d);for(;f<d;){c=Oa(a,b+f++);if(!(192>c)){var h=Oa(a,b+f++);if(224>c)c=(c&31)<<6|h&63;else{var k=Oa(a,b+f++);if(240>c)c=(c&15)<<12|(h&63)<<6|k&63;else{var n=Oa(a,b+f++);c=(c&7)<<18|(h&63)<<12|(k&63)<<6|n&63}}}65536>c?e+=String.fromCharCode(c):(c-=65536,e+=String.fromCharCode((c>>10)+55296,(c&1023)+56320))}return e}function Sa(a,b){return b+a.v(b)}function Ta(a,b){return b+a.v(b)+4}
function Ua(a,b){return a.v(b+a.v(b))}g.W=function(a,b){return 0==a&&0==b?wa:new va(a,b)};const Va=new TextDecoder("utf-8"),Wa=a=>Va.decode(a),Xa=new TextEncoder;const w=Object.freeze({done:!0,value:void 0});class Ya{constructor(a){this.Aa=a}get schema(){return this.Aa.schema}get ha(){return this.Aa.batches||[]}get dictionaries(){return this.Aa.dictionaries||[]}}function Za(a){return a.Lb||(a.Lb=a.toDOMStream())}function $a(a,b,c){return $a(a.Tb||(a.Tb=a.toNodeStream()),b,c)}class ab{tee(){return Za(this).tee()}pipeTo(a,b){return Za(this).pipeTo(a,b)}pipeThrough(a,b){return Za(this).pipeThrough(a,b)}}
class bb extends ab{constructor(){super();this.l=[];this.ua=[];this.lb=new Promise(a=>this.L=a)}get closed(){return this.lb}cancel(a){const b=this;return l(function*(){yield b.return(a)})}write(a){if(!this.L)throw Error("AsyncQueue is closed");0>=this.ua.length?this.l.push(a):this.ua.shift().resolve({done:!1,value:a})}abort(a){this.L&&(0>=this.ua.length?this.nb={error:a}:this.ua.shift().reject({done:!0,value:a}))}close(){if(this.L){const a=this.ua;for(;0<a.length;)a.shift().resolve(w);this.L();this.L=
void 0}}[Symbol.asyncIterator](){return this}toDOMStream(a){return cb(this.L||this.nb?this:this.l,a)}toNodeStream(){return db()}throw(a){const b=this;return l(function*(){yield b.abort(a);return w})}return(){const a=this;return l(function*(){yield a.close();return w})}read(a){const b=this;return l(function*(){return(yield b.next(a,"read")).value})}peek(a){const b=this;return l(function*(){return(yield b.next(a,"peek")).value})}next(){return 0<this.l.length?Promise.resolve({done:!1,value:this.l.shift()}):
this.nb?Promise.reject({done:!0,value:this.nb.error}):this.L?new Promise((a,b)=>{this.ua.push({resolve:a,reject:b})}):Promise.resolve(w)}};const [eb,fb]=(()=>{function a(){throw b();}const b=()=>{throw Error("BigInt is not available in this environment");};a.asIntN=()=>{throw b();};a.asUintN=()=>{throw b();};return"undefined"!==typeof BigInt?[BigInt,!0]:[a,!1]})(),[gb]=(()=>{const a=()=>{throw Error("BigInt64Array is not available in this environment");};class b{static get BYTES_PER_ELEMENT(){return 8}static of(){throw a();}static from(){throw a();}constructor(){throw a();}}return"undefined"!==typeof BigInt64Array?[BigInt64Array,!0]:
[b,!1]})(),[hb]=(()=>{const a=()=>{throw Error("BigUint64Array is not available in this environment");};class b{static get BYTES_PER_ELEMENT(){return 8}static of(){throw a();}static from(){throw a();}constructor(){throw a();}}return"undefined"!==typeof BigUint64Array?[BigUint64Array,!0]:[b,!1]})(),x=a=>"function"===typeof a,y=a=>null!=a&&Object(a)===a,ib=a=>y(a)&&x(a[Symbol.iterator]),jb=a=>y(a)&&x(a[Symbol.asyncIterator]),kb=a=>y(a)&&x(a.cancel)&&x(a.getReader)&&!(a instanceof ab),lb=a=>y(a)&&x(a.read)&&
x(a.pipe)&&"boolean"===typeof a.readable&&!(a instanceof ab);const mb="undefined"!==typeof SharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;function nb(a){const b=a[0]?[a[0]]:[];let c,d,e,f;for(let h,k,n=0,p=0,u=a.length;++n<u;)h=b[p],k=a[n],!h||!k||h.buffer!==k.buffer||k.byteOffset<h.byteOffset?k&&(b[++p]=k):({byteOffset:c,byteLength:e}=h,{byteOffset:d,byteLength:f}=k,c+e<d||d+f<c?k&&(b[++p]=k):b[p]=new Uint8Array(h.buffer,c,d-c+f));return b}
function ob(a,b,c,d){c=void 0===c?0:c;d=void 0===d?b.byteLength:d;const e=a.byteLength,f=new Uint8Array(a.buffer,a.byteOffset,e);b=new Uint8Array(b.buffer,b.byteOffset,Math.min(d,e));f.set(b,c);return a}
function pb(a,b){a=nb(a);const c=a.reduce((n,p)=>n+p.byteLength,0);let d,e,f=0,h=-1;const k=Math.min(b||Infinity,c);for(let n=a.length;++h<n;){b=a[h];d=b.subarray(0,Math.min(b.length,k-f));if(k<=f+d.length){d.length<b.length?a[h]=b.subarray(d.length):d.length===b.length&&h++;e?ob(e,d,f):e=d;break}ob(e||(e=new Uint8Array(k)),d,f);f+=d.length}return[e||new Uint8Array(0),a.slice(h),c-(e?e.byteLength:0)]}
function z(a,b){b=y(b)&&"done"in b&&"value"in b?b.value:b;if(b instanceof a)return a===Uint8Array?new a(b.buffer,b.byteOffset,b.byteLength):b;if(!b)return new a(0);"string"===typeof b&&(b=Xa.encode(b));return b instanceof ArrayBuffer||b instanceof mb?new a(b):b instanceof ya?z(a,b.T()):ArrayBuffer.isView(b)?0>=b.byteLength?new a(0):new a(b.buffer,b.byteOffset,b.byteLength/a.BYTES_PER_ELEMENT):a.from(b)}const qb=a=>{a.next();return a};
function*rb(a,b){function*c(d){yield d}b="string"===typeof b?c(b):ArrayBuffer.isView(b)?c(b):b instanceof ArrayBuffer?c(b):b instanceof mb?c(b):ib(b)?b:c(b);yield*qb(function*(d){let e=null;do e=d.next(yield z(a,e));while(!e.done)}(b[Symbol.iterator]()));return new a}
function tb(a,b){return new oa(function*(){function c(f){return new oa(function*(){yield new m(1,qb(function*(h){let k=null;do{let n;k=h.next(yield null==(n=k)?void 0:n.value)}while(!k.done)}(f[Symbol.iterator]())))}())}function d(f){return new oa(function*(){yield new m(0,yield new m(2,f))}())}if(y(b)&&x(b.then))return yield new m(1,tb(a,yield new m(2,b)));const e="string"===typeof b?d(b):ArrayBuffer.isView(b)?d(b):b instanceof ArrayBuffer?d(b):b instanceof mb?d(b):ib(b)?c(b):jb(b)?b:d(b);yield new m(1,
qb(function(f){return new oa(function*(){let h=null;do h=yield new m(2,f.next(yield new m(0,z(a,h))));while(!h.done)}())}(e[Symbol.asyncIterator]())));return new a}())}function ub(a,b,c){if(0!==a){c=c.slice(0,b+1);for(let d=-1;++d<=b;)c[d]+=a}return c}function vb(a,b){let c=0;const d=a.length;if(d!==b.length)return!1;if(0<d){do if(a[c]!==b[c])return!1;while(++c<d)}return!0}var A={};A.compareArrayLike=vb;A.joinUint8Arrays=pb;A.memcpy=ob;A.rebaseValueOffsets=ub;A.toArrayBufferView=z;
A.toArrayBufferViewAsyncIterator=tb;A.toArrayBufferViewIterator=rb;A.toBigInt64Array=a=>z(gb,a);A.toBigUint64Array=a=>z(hb,a);A.toFloat32Array=a=>z(Float32Array,a);A.toFloat32ArrayAsyncIterator=a=>tb(Float32Array,a);A.toFloat32ArrayIterator=a=>rb(Float32Array,a);A.toFloat64Array=a=>z(Float64Array,a);A.toFloat64ArrayAsyncIterator=a=>tb(Float64Array,a);A.toFloat64ArrayIterator=a=>rb(Float64Array,a);A.toInt16Array=a=>z(Int16Array,a);A.toInt16ArrayAsyncIterator=a=>tb(Int16Array,a);
A.toInt16ArrayIterator=a=>rb(Int16Array,a);A.toInt32Array=a=>z(Int32Array,a);A.toInt32ArrayAsyncIterator=a=>tb(Int32Array,a);A.toInt32ArrayIterator=a=>rb(Int32Array,a);A.toInt8Array=a=>z(Int8Array,a);A.toInt8ArrayAsyncIterator=a=>tb(Int8Array,a);A.toInt8ArrayIterator=a=>rb(Int8Array,a);A.toUint16Array=a=>z(Uint16Array,a);A.toUint16ArrayAsyncIterator=a=>tb(Uint16Array,a);A.toUint16ArrayIterator=a=>rb(Uint16Array,a);A.toUint32Array=a=>z(Uint32Array,a);
A.toUint32ArrayAsyncIterator=a=>tb(Uint32Array,a);A.toUint32ArrayIterator=a=>rb(Uint32Array,a);A.toUint8Array=a=>z(Uint8Array,a);A.toUint8ArrayAsyncIterator=a=>tb(Uint8Array,a);A.toUint8ArrayIterator=a=>rb(Uint8Array,a);A.toUint8ClampedArray=a=>z(Uint8ClampedArray,a);A.toUint8ClampedArrayAsyncIterator=a=>tb(Uint8ClampedArray,a);A.toUint8ClampedArrayIterator=a=>rb(Uint8ClampedArray,a);function cb(){throw Error('"toDOMStream" not available in this environment');}function db(){throw Error('"toNodeStream" not available in this environment');}const wb=a=>{a.next();return a};
function*xb(a){let b,c=!1,d=[],e,f,h,k=0;({aa:f,size:h}=yield null);a=rb(Uint8Array,a)[Symbol.iterator]();try{do if({done:b,value:e}=isNaN(h-k)?a.next(void 0):a.next(h-k),!b&&0<e.byteLength&&(d.push(e),k+=e.byteLength),b||h<=k){do{if("peek"===f)var n=pb(d,h)[0];else[e,d,k]=pb(d,h),n=e;({aa:f,size:h}=yield n)}while(h<k)}while(!b)}catch(p){(c=!0,"function"===typeof a.throw)&&a.throw(p)}finally{!1===c&&"function"===typeof a.return&&a.return(null)}return null}
function yb(a){return new oa(function*(){let b,c=!1,d=[],e,f,h,k=0;({aa:f,size:h}=yield new m(0,null));const n=tb(Uint8Array,a)[Symbol.asyncIterator]();try{do if({done:b,value:e}=isNaN(h-k)?yield new m(2,n.next(void 0)):yield new m(2,n.next(h-k)),!b&&0<e.byteLength&&(d.push(e),k+=e.byteLength),b||h<=k){do{if("peek"===f)var p=pb(d,h)[0];else[e,d,k]=pb(d,h),p=e;({aa:f,size:h}=yield new m(0,p))}while(h<k)}while(!b)}catch(u){(c=!0,"function"===typeof n.throw)&&(yield new m(2,n.throw(u)))}finally{!1===
c&&"function"===typeof n.return&&(yield new m(2,n.return(new Uint8Array(0))))}return null}())}
function zb(a){return new oa(function*(){let b=!1,c=!1,d=[],e,f,h,k=0;({aa:f,size:h}=yield new m(0,null));const n=new Ab(a);try{do if({done:b,value:e}=isNaN(h-k)?yield new m(2,n.read(void 0)):yield new m(2,n.read(h-k)),!b&&0<e.byteLength&&(d.push(z(Uint8Array,e)),k+=e.byteLength),b||h<=k){do{if("peek"===f)var p=pb(d,h)[0];else[e,d,k]=pb(d,h),p=e;({aa:f,size:h}=yield new m(0,p))}while(h<k)}while(!b)}catch(u){c=!0,yield new m(2,n.cancel(u))}finally{!1===c?yield new m(2,n.cancel()):a.locked&&n.releaseLock()}return null}())}
function Bb(a){a.pa&&a.releaseLock();a.oa||(a.oa=a.source.getReader({mode:"byob"}),a.oa.closed.catch(()=>{}));return a.Y=a.oa}function Cb(a){a.oa&&a.releaseLock();a.pa||(a.pa=a.source.getReader(),a.pa.closed.catch(()=>{}));return a.Y=a.pa}function Db(a,b){return l(function*(){return yield Eb(Bb(a),new ArrayBuffer(b),0,b)})}
class Ab{constructor(a){this.source=a;this.pa=this.oa=null;try{this.bc=!!(this.Y=Bb(this))}catch(b){this.bc=!(this.Y=Cb(this))}}get closed(){return this.Y?this.Y.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.Y&&this.Y.releaseLock();this.Y=this.oa=this.pa=null}cancel(a){const b=this;return l(function*(){const c=b.Y,d=b.source;c&&(yield c.cancel(a).catch(()=>{}));d&&d.locked&&b.releaseLock()})}read(a){const b=this;return l(function*(){if(0===a)return{done:null==b.Y,value:new Uint8Array(0)};
const c=b.bc&&"number"===typeof a?yield Db(b,a):yield Cb(b).read();!c.done&&(c.value=z(Uint8Array,c));return c})}}function Eb(a,b,c,d){return l(function*(){if(c>=d)return{done:!1,value:new Uint8Array(b,0,d)};const {done:e,value:f}=yield a.read(new Uint8Array(b,c,d-c));return(c+=f.byteLength)<d&&!e?yield Eb(a,f.buffer,c,d):{done:e,value:new Uint8Array(f.buffer,0,c)}})}const Fb=(a,b)=>{const c=e=>d([b,e]);let d;return[b,c,new Promise(e=>(d=e)&&a.once(b,c))]};
function Gb(a){return new oa(function*(){function b(sb,Lb){u=p=null;return new Promise((Uj,Vj)=>{for(const Mb of sb){const [Wj,Xj]=Mb;a.off(Wj,Xj)}try{const Mb=a.destroy;Mb&&Mb.call(a,Lb);Lb=void 0}catch(Mb){Lb=Mb||Lb}finally{null!=Lb?Vj(Lb):Uj()}})}const c=[];let d="error",e=!1,f=null,h,k,n=0,p=[],u;({aa:h,size:k}=yield new m(0,null));if(a.isTTY)return yield new m(0,new Uint8Array(0)),null;try{c[0]=Fb(a,"end");c[1]=Fb(a,"error");do{c[2]=Fb(a,"readable");[d,f]=yield new m(2,Promise.race(c.map(sb=>
sb[2])));if("error"===d)break;(e="end"===d)||(isFinite(k-n)?(u=z(Uint8Array,a.read(k-n)),u.byteLength<k-n&&(u=z(Uint8Array,a.read(void 0)))):u=z(Uint8Array,a.read(void 0)),0<u.byteLength&&(p.push(u),n+=u.byteLength));if(e||k<=n){do{if("peek"===h)var Z=pb(p,k)[0];else[u,p,n]=pb(p,k),Z=u;({aa:h,size:k}=yield new m(0,Z))}while(k<n)}}while(!e)}finally{yield new m(2,b(c,"error"===d?f:null))}return null}())};class B{}B.prototype.data=null;var Hb,Ib=Hb||(Hb={});Ib[Ib.V1=0]="V1";Ib[Ib.V2=1]="V2";Ib[Ib.V3=2]="V3";Ib[Ib.V4=3]="V4";Ib[Ib.V5=4]="V5";var Jb,Kb=Jb||(Jb={});Kb[Kb.UNUSED=0]="UNUSED";Kb[Kb.DICTIONARY_REPLACEMENT=1]="DICTIONARY_REPLACEMENT";Kb[Kb.COMPRESSED_BODY=2]="COMPRESSED_BODY";var Nb,Ob=Nb||(Nb={});Ob[Ob.Sparse=0]="Sparse";Ob[Ob.Dense=1]="Dense";var Pb,Qb=Pb||(Pb={});Qb[Qb.HALF=0]="HALF";Qb[Qb.SINGLE=1]="SINGLE";Qb[Qb.DOUBLE=2]="DOUBLE";var Rb,Sb=Rb||(Rb={});Sb[Sb.DAY=0]="DAY";Sb[Sb.MILLISECOND=1]="MILLISECOND";
var C,Tb=C||(C={});Tb[Tb.SECOND=0]="SECOND";Tb[Tb.MILLISECOND=1]="MILLISECOND";Tb[Tb.MICROSECOND=2]="MICROSECOND";Tb[Tb.NANOSECOND=3]="NANOSECOND";var Ub,Vb=Ub||(Ub={});Vb[Vb.YEAR_MONTH=0]="YEAR_MONTH";Vb[Vb.DAY_TIME=1]="DAY_TIME";var D,E=D||(D={});E[E.NONE=0]="NONE";E[E.Null=1]="Null";E[E.Int=2]="Int";E[E.FloatingPoint=3]="FloatingPoint";E[E.Binary=4]="Binary";E[E.Utf8=5]="Utf8";E[E.Bool=6]="Bool";E[E.Decimal=7]="Decimal";E[E.Date=8]="Date";E[E.Time=9]="Time";E[E.Timestamp=10]="Timestamp";
E[E.Interval=11]="Interval";E[E.List=12]="List";E[E.Struct_=13]="Struct_";E[E.Union=14]="Union";E[E.FixedSizeBinary=15]="FixedSizeBinary";E[E.FixedSizeList=16]="FixedSizeList";E[E.Map=17]="Map";E[E.Duration=18]="Duration";E[E.LargeBinary=19]="LargeBinary";E[E.LargeUtf8=20]="LargeUtf8";E[E.LargeList=21]="LargeList";var Wb,Xb=Wb||(Wb={});Xb[Xb.DenseArray=0]="DenseArray";var Yb,Zb=Yb||(Yb={});Zb[Zb.Little=0]="Little";Zb[Zb.Big=1]="Big";
class $b{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}listSize(){const a=v(this.g,this.h,4);return a?this.g.v(this.h+a):0}}class ac{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}keysSorted(){const a=v(this.g,this.h,4);return a?!!(this.g.m[this.h+a]<<24>>24):!1}}
class bc{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}mode(){const a=v(this.g,this.h,4);return a?Ka(this.g,this.h+a):Nb.Sparse}typeIds(a){const b=v(this.g,this.h,6);return b?this.g.v(Ta(this.g,this.h+b)+4*a):0}}class cc{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}bitWidth(){const a=v(this.g,this.h,4);return a?this.g.v(this.h+a):0}isSigned(){const a=v(this.g,this.h,6);return a?!!(this.g.m[this.h+a]<<24>>24):!1}}
class dc{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}precision(){const a=v(this.g,this.h,4);return a?Ka(this.g,this.h+a):Pb.HALF}}class ec{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}byteWidth(){const a=v(this.g,this.h,4);return a?this.g.v(this.h+a):0}}
class fc{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}precision(){const a=v(this.g,this.h,4);return a?this.g.v(this.h+a):0}scale(){const a=v(this.g,this.h,6);return a?this.g.v(this.h+a):0}bitWidth(){const a=v(this.g,this.h,8);return a?this.g.v(this.h+a):128}}class gc{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}unit(){const a=v(this.g,this.h,4);return a?Ka(this.g,this.h+a):Rb.MILLISECOND}}
class hc{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}unit(){const a=v(this.g,this.h,4);return a?Ka(this.g,this.h+a):C.MILLISECOND}bitWidth(){const a=v(this.g,this.h,6);return a?this.g.v(this.h+a):32}}class ic{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}unit(){const a=v(this.g,this.h,4);return a?Ka(this.g,this.h+a):C.SECOND}timezone(a){const b=v(this.g,this.h,6);return b?Ra(this.g,this.h+b,a):null}}
class jc{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}unit(){const a=v(this.g,this.h,4);return a?Ka(this.g,this.h+a):Ub.YEAR_MONTH}}class kc{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}key(a){const b=v(this.g,this.h,4);return b?Ra(this.g,this.h+b,a):null}value(a){const b=v(this.g,this.h,6);return b?Ra(this.g,this.h+b,a):null}}function lc(a){const b=v(a.g,a.h,6);return b?(new cc).i(Sa(a.g,a.h+b),a.g):null}
class mc{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}id(){const a=v(this.g,this.h,4);return a?Pa(this.g,this.h+a):this.g.W(0,0)}isOrdered(){const a=v(this.g,this.h,8);return a?!!(this.g.m[this.h+a]<<24>>24):!1}}function nc(a,b){La(a,4,b.length,4);for(let c=b.length-1;0<=c;c--)Ia(a,b[c]);return Ma(a)}function oc(a,b){La(a,4,b.length,4);for(let c=b.length-1;0<=c;c--)Ia(a,b[c]);return Ma(a)}function pc(a){const b=v(a.g,a.h,14);return b?Ua(a.g,a.h+b):0}
class qc{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}name(a){const b=v(this.g,this.h,4);return b?Ra(this.g,this.h+b,a):null}nullable(){const a=v(this.g,this.h,6);return a?!!(this.g.m[this.h+a]<<24>>24):!1}type(a){const b=v(this.g,this.h,10);return b?Qa(this.g,a,this.h+b):null}dictionary(a){const b=v(this.g,this.h,12);return b?(a||new mc).i(Sa(this.g,this.h+b),this.g):null}children(a,b){const c=v(this.g,this.h,14);return c?(b||new qc).i(Sa(this.g,Ta(this.g,this.h+c)+4*a),
this.g):null}$a(a){const b=v(this.g,this.h,16);return b?(new kc).i(Sa(this.g,Ta(this.g,this.h+b)+4*a),this.g):null}ab(){const a=v(this.g,this.h,16);return a?Ua(this.g,this.h+a):0}}class rc{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}offset(){return Pa(this.g,this.h)}length(){return Pa(this.g,this.h+8)}}function sc(a,b){La(a,4,b.length,4);for(let c=b.length-1;0<=c;c--)Ia(a,b[c]);return Ma(a)}
function tc(a,b){La(a,4,b.length,4);for(let c=b.length-1;0<=c;c--)Ia(a,b[c]);return Ma(a)}function uc(a){const b=v(a.g,a.h,6);return b?Ua(a.g,a.h+b):0}
class vc{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}fields(a,b){const c=v(this.g,this.h,6);return c?(b||new qc).i(Sa(this.g,Ta(this.g,this.h+c)+4*a),this.g):null}$a(a){const b=v(this.g,this.h,8);return b?(new kc).i(Sa(this.g,Ta(this.g,this.h+b)+4*a),this.g):null}ab(){const a=v(this.g,this.h,8);return a?Ua(this.g,this.h+a):0}features(a){const b=v(this.g,this.h,10);return b?Pa(this.g,Ta(this.g,this.h+b)+8*a):this.g.W(0,0)}};var wc,xc=wc||(wc={});xc[xc.LZ4_FRAME=0]="LZ4_FRAME";xc[xc.ZSTD=1]="ZSTD";var yc,zc=yc||(yc={});zc[zc.BUFFER=0]="BUFFER";var F,Ac=F||(F={});Ac[Ac.NONE=0]="NONE";Ac[Ac.Schema=1]="Schema";Ac[Ac.DictionaryBatch=2]="DictionaryBatch";Ac[Ac.RecordBatch=3]="RecordBatch";Ac[Ac.Tensor=4]="Tensor";Ac[Ac.SparseTensor=5]="SparseTensor";class Bc{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}length(){return Pa(this.g,this.h)}nullCount(){return Pa(this.g,this.h+8)}}
function Cc(a,b){Ha(a,0,b,a.W(0,0))}function Dc(a){const b=v(a.g,a.h,6);return b?Ua(a.g,a.h+b):0}function Ec(a){const b=v(a.g,a.h,8);return b?Ua(a.g,a.h+b):0}
class Fc{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}length(){const a=v(this.g,this.h,4);return a?Pa(this.g,this.h+a):this.g.W(0,0)}N(a,b){const c=v(this.g,this.h,6);return c?(b||new Bc).i(Ta(this.g,this.h+c)+16*a,this.g):null}buffers(a,b){const c=v(this.g,this.h,8);return c?(b||new rc).i(Ta(this.g,this.h+c)+16*a,this.g):null}}
class Gc{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}id(){const a=v(this.g,this.h,4);return a?Pa(this.g,this.h+a):this.g.W(0,0)}data(a){const b=v(this.g,this.h,6);return b?(a||new Fc).i(Sa(this.g,this.h+b),this.g):null}cb(){const a=v(this.g,this.h,8);return a?!!(this.g.m[this.h+a]<<24>>24):!1}}
class Hc{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}version(){const a=v(this.g,this.h,4);return a?Ka(this.g,this.h+a):Hb.V1}headerType(){const a=v(this.g,this.h,6);return a?this.g.m[this.h+a]:F.NONE}header(a){const b=v(this.g,this.h,8);return b?Qa(this.g,a,this.h+b):null}bodyLength(){const a=v(this.g,this.h,10);return a?Pa(this.g,this.h+a):this.g.W(0,0)}$a(a){const b=v(this.g,this.h,12);return b?(new kc).i(Sa(this.g,Ta(this.g,this.h+b)+4*a),this.g):null}ab(){const a=v(this.g,
this.h,12);return a?Ua(this.g,this.h+a):0}};var G,H=G||(G={});H[H.NONE=0]="NONE";H[H.Null=1]="Null";H[H.Int=2]="Int";H[H.Float=3]="Float";H[H.Binary=4]="Binary";H[H.Utf8=5]="Utf8";H[H.Bool=6]="Bool";H[H.Decimal=7]="Decimal";H[H.Date=8]="Date";H[H.Time=9]="Time";H[H.Timestamp=10]="Timestamp";H[H.Interval=11]="Interval";H[H.List=12]="List";H[H.Struct=13]="Struct";H[H.Union=14]="Union";H[H.FixedSizeBinary=15]="FixedSizeBinary";H[H.FixedSizeList=16]="FixedSizeList";H[H.Map=17]="Map";H[H.Dictionary=-1]="Dictionary";H[H.Int8=-2]="Int8";
H[H.Int16=-3]="Int16";H[H.Int32=-4]="Int32";H[H.Int64=-5]="Int64";H[H.Uint8=-6]="Uint8";H[H.Uint16=-7]="Uint16";H[H.Uint32=-8]="Uint32";H[H.Uint64=-9]="Uint64";H[H.Float16=-10]="Float16";H[H.Float32=-11]="Float32";H[H.Float64=-12]="Float64";H[H.DateDay=-13]="DateDay";H[H.DateMillisecond=-14]="DateMillisecond";H[H.TimestampSecond=-15]="TimestampSecond";H[H.TimestampMillisecond=-16]="TimestampMillisecond";H[H.TimestampMicrosecond=-17]="TimestampMicrosecond";H[H.TimestampNanosecond=-18]="TimestampNanosecond";
H[H.TimeSecond=-19]="TimeSecond";H[H.TimeMillisecond=-20]="TimeMillisecond";H[H.TimeMicrosecond=-21]="TimeMicrosecond";H[H.TimeNanosecond=-22]="TimeNanosecond";H[H.DenseUnion=-23]="DenseUnion";H[H.SparseUnion=-24]="SparseUnion";H[H.IntervalDayTime=-25]="IntervalDayTime";H[H.IntervalYearMonth=-26]="IntervalYearMonth";var I,Ic=I||(I={});Ic[Ic.OFFSET=0]="OFFSET";Ic[Ic.DATA=1]="DATA";Ic[Ic.VALIDITY=2]="VALIDITY";Ic[Ic.TYPE=3]="TYPE";function Jc(a,b,c,d){return 0!==(c&1<<d)}function Kc(a,b,c,d){return(c&1<<d)>>d}function Lc(a,b,c){return c?!!(a[b>>3]|=1<<b%8)||!0:!(a[b>>3]&=~(1<<b%8))&&!1}function Mc(a,b,c){const d=c.byteLength+7&-8;if(0<a||c.byteLength<d){const e=new Uint8Array(d);e.set(0===a%8?c.subarray(a>>3):Nc(new Oc(c,a,b,null,Jc)).subarray(0,d));return e}return c}
function Nc(a){const b=[];let c=0,d=0,e=0;for(const f of a)f&&(e|=1<<d),8===++d&&(b[c++]=e,e=d=0);if(0===c||0<d)b[c++]=e;a=new Uint8Array(b.length+7&-8);a.set(b);return a}
class Oc{constructor(a,b,c,d,e){this.T=a;this.length=c;this.context=d;this.get=e;this.xb=b%8;this.Yb=b>>3;this.Xb=a[this.Yb++];this.index=0}next(){return this.index<this.length?(8===this.xb&&(this.xb=0,this.Xb=this.T[this.Yb++]),{value:this.get(this.context,this.index++,this.Xb,this.xb++)}):{done:!0,value:null}}[Symbol.iterator](){return this}}
function Pc(a,b,c){if(0>=c-b)return 0;if(8>c-b){var d=0;for(var e of new Oc(a,b,c-b,a,Kc))d+=e;return d}d=c>>3<<3;e=b+(0===b%8?0:8-b%8);return Pc(a,b,e)+Pc(a,d,c)+Qc(a,e>>3,d-e>>3)}function Qc(a,b,c){let d=0;b|=0;const e=new DataView(a.buffer,a.byteOffset,a.byteLength);for(a=void 0===c?a.byteLength:b+c;4<=a-b;)d+=Rc(e.getUint32(b)),b+=4;for(;2<=a-b;)d+=Rc(e.getUint16(b)),b+=2;for(;1<=a-b;)d+=Rc(e.getUint8(b)),b+=1;return d}
function Rc(a){a|=0;a-=a>>>1&1431655765;a=(a&858993459)+(a>>>2&858993459);return 16843009*(a+(a>>>4)&252645135)>>>24}var Sc={};Sc.BitIterator=Oc;Sc.getBit=Kc;Sc.getBool=Jc;Sc.packBools=Nc;Sc.popcnt_array=Qc;Sc.popcnt_bit_range=Pc;Sc.popcnt_uint32=Rc;Sc.setBool=Lc;Sc.truncateBitmap=Mc;class J{static isNull(a){return(null==a?void 0:a.typeId)===G.Null}static isInt(a){return(null==a?void 0:a.typeId)===G.Int}static isFloat(a){return(null==a?void 0:a.typeId)===G.Float}static isBinary(a){return(null==a?void 0:a.typeId)===G.Binary}static isUtf8(a){return(null==a?void 0:a.typeId)===G.Utf8}static isBool(a){return(null==a?void 0:a.typeId)===G.Bool}static isDecimal(a){return(null==a?void 0:a.typeId)===G.Decimal}static isDate(a){return(null==a?void 0:a.typeId)===G.Date}static isTime(a){return(null==
a?void 0:a.typeId)===G.Time}static isTimestamp(a){return(null==a?void 0:a.typeId)===G.Timestamp}static isInterval(a){return(null==a?void 0:a.typeId)===G.Interval}static isList(a){return(null==a?void 0:a.typeId)===G.List}static isStruct(a){return(null==a?void 0:a.typeId)===G.Struct}static isUnion(a){return(null==a?void 0:a.typeId)===G.Union}static isFixedSizeBinary(a){return(null==a?void 0:a.typeId)===G.FixedSizeBinary}static isFixedSizeList(a){return(null==a?void 0:a.typeId)===G.FixedSizeList}static isMap(a){return(null==
a?void 0:a.typeId)===G.Map}static isDictionary(a){return(null==a?void 0:a.typeId)===G.Dictionary}get typeId(){return G.NONE}}var Tc=Symbol.toStringTag,Uc,Vc=J.prototype;Vc.children=null;Vc.ArrayType=Array;Uc=Vc[Symbol.toStringTag]="DataType";J[Tc]=Uc;class Wc extends J{toString(){return"Null"}get typeId(){return G.Null}}Wc[Symbol.toStringTag]=Wc.prototype[Symbol.toStringTag]="Null";
class Xc extends J{constructor(a,b){super();this.isSigned=a;this.bitWidth=b}get typeId(){return G.Int}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?Int32Array:Uint32Array}throw Error(`Unrecognized ${this[Symbol.toStringTag]} type`);}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}
var Yc=Symbol.toStringTag,Zc,$c=Xc.prototype;$c.isSigned=null;$c.bitWidth=null;Zc=$c[Symbol.toStringTag]="Int";Xc[Yc]=Zc;class ad extends Xc{constructor(){super(!0,8)}}class bd extends Xc{constructor(){super(!0,16)}}class cd extends Xc{constructor(){super(!0,32)}}class dd extends Xc{constructor(){super(!0,64)}}class ed extends Xc{constructor(){super(!1,8)}}class fd extends Xc{constructor(){super(!1,16)}}class gd extends Xc{constructor(){super(!1,32)}}
class hd extends Xc{constructor(){super(!1,64)}}Object.defineProperty(ad.prototype,"ArrayType",{value:Int8Array});Object.defineProperty(bd.prototype,"ArrayType",{value:Int16Array});Object.defineProperty(cd.prototype,"ArrayType",{value:Int32Array});Object.defineProperty(dd.prototype,"ArrayType",{value:Int32Array});Object.defineProperty(ed.prototype,"ArrayType",{value:Uint8Array});Object.defineProperty(fd.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(gd.prototype,"ArrayType",{value:Uint32Array});
Object.defineProperty(hd.prototype,"ArrayType",{value:Uint32Array});class id extends J{constructor(a){super();this.precision=a}get typeId(){return G.Float}get ArrayType(){switch(this.precision){case Pb.HALF:return Uint16Array;case Pb.SINGLE:return Float32Array;case Pb.DOUBLE:return Float64Array}throw Error(`Unrecognized ${this[Symbol.toStringTag]} type`);}toString(){return`Float${this.precision<<5||16}`}}var jd=Symbol.toStringTag,kd,ld=id.prototype;ld.precision=null;kd=ld[Symbol.toStringTag]="Float";
id[jd]=kd;class md extends id{constructor(){super(Pb.HALF)}}class nd extends id{constructor(){super(Pb.SINGLE)}}class od extends id{constructor(){super(Pb.DOUBLE)}}Object.defineProperty(md.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(nd.prototype,"ArrayType",{value:Float32Array});Object.defineProperty(od.prototype,"ArrayType",{value:Float64Array});class pd extends J{constructor(){super()}get typeId(){return G.Binary}toString(){return"Binary"}}var qd=Symbol.toStringTag,rd,sd=pd.prototype;
sd.ArrayType=Uint8Array;rd=sd[Symbol.toStringTag]="Binary";pd[qd]=rd;class td extends J{constructor(){super()}get typeId(){return G.Utf8}toString(){return"Utf8"}}var ud=Symbol.toStringTag,vd,wd=td.prototype;wd.ArrayType=Uint8Array;vd=wd[Symbol.toStringTag]="Utf8";td[ud]=vd;class xd extends J{constructor(){super()}get typeId(){return G.Bool}toString(){return"Bool"}}var yd=Symbol.toStringTag,zd,Ad=xd.prototype;Ad.ArrayType=Uint8Array;zd=Ad[Symbol.toStringTag]="Bool";xd[yd]=zd;
class Bd extends J{constructor(a,b){super();this.scale=a;this.precision=b}get typeId(){return G.Decimal}toString(){return`Decimal[${this.precision}e${0<this.scale?"+":""}${this.scale}]`}}var Cd=Symbol.toStringTag,Dd,Ed=Bd.prototype;Ed.scale=null;Ed.precision=null;Ed.ArrayType=Uint32Array;Dd=Ed[Symbol.toStringTag]="Decimal";Bd[Cd]=Dd;class Fd extends J{constructor(a){super();this.unit=a}get typeId(){return G.Date}toString(){return`Date${32*(this.unit+1)}<${Rb[this.unit]}>`}}
var Gd=Symbol.toStringTag,Hd,Id=Fd.prototype;Id.unit=null;Id.ArrayType=Int32Array;Hd=Id[Symbol.toStringTag]="Date";Fd[Gd]=Hd;class Jd extends Fd{constructor(){super(Rb.DAY)}}class Kd extends Fd{constructor(){super(Rb.MILLISECOND)}}class Ld extends J{constructor(a,b){super();this.unit=a;this.bitWidth=b}get typeId(){return G.Time}toString(){return`Time${this.bitWidth}<${C[this.unit]}>`}}var Md=Symbol.toStringTag,Nd,Od=Ld.prototype;Od.unit=null;Od.bitWidth=null;Od.ArrayType=Int32Array;
Nd=Od[Symbol.toStringTag]="Time";Ld[Md]=Nd;class Pd extends Ld{constructor(){super(C.SECOND,32)}}class Qd extends Ld{constructor(){super(C.MILLISECOND,32)}}class Rd extends Ld{constructor(){super(C.MICROSECOND,64)}}class Sd extends Ld{constructor(){super(C.NANOSECOND,64)}}class Td extends J{constructor(a,b){super();this.unit=a;this.timezone=b}get typeId(){return G.Timestamp}toString(){return`Timestamp<${C[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}}var Ud=Symbol.toStringTag,Vd,Wd=Td.prototype;
Wd.unit=null;Wd.timezone=null;Wd.ArrayType=Int32Array;Vd=Wd[Symbol.toStringTag]="Timestamp";Td[Ud]=Vd;class Xd extends Td{constructor(a){super(C.SECOND,a)}}class Yd extends Td{constructor(a){super(C.MILLISECOND,a)}}class Zd extends Td{constructor(a){super(C.MICROSECOND,a)}}class $d extends Td{constructor(a){super(C.NANOSECOND,a)}}class ae extends J{constructor(a){super();this.unit=a}get typeId(){return G.Interval}toString(){return`Interval<${Ub[this.unit]}>`}}var be=Symbol.toStringTag,ce,de=ae.prototype;
de.unit=null;de.ArrayType=Int32Array;ce=de[Symbol.toStringTag]="Interval";ae[be]=ce;class ee extends ae{constructor(){super(Ub.DAY_TIME)}}class fe extends ae{constructor(){super(Ub.YEAR_MONTH)}}class ge extends J{constructor(a){super();this.children=[a]}get typeId(){return G.List}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}}var he=Symbol.toStringTag,ie,je=ge.prototype;
je.children=null;ie=je[Symbol.toStringTag]="List";ge[he]=ie;class ke extends J{constructor(a){super();this.children=a}get typeId(){return G.Struct}toString(){return`Struct<{${this.children.map(a=>`${a.name}:${a.type}`).join(", ")}}>`}}var le=Symbol.toStringTag,me,ne=ke.prototype;ne.children=null;me=ne[Symbol.toStringTag]="Struct";ke[le]=me;
class oe extends J{constructor(a,b,c){super();this.mode=a;this.children=c;this.typeIds=b=Int32Array.from(b);this.typeIdToChildIndex=b.reduce((d,e,f)=>(d[e]=f)&&d||d,Object.create(null))}get typeId(){return G.Union}toString(){return`${this[Symbol.toStringTag]}<${this.children.map(a=>`${a.type}`).join(" | ")}>`}}var pe=Symbol.toStringTag,qe,re=oe.prototype;re.mode=null;re.typeIds=null;re.children=null;re.typeIdToChildIndex=null;re.ArrayType=Int8Array;qe=re[Symbol.toStringTag]="Union";oe[pe]=qe;
class se extends oe{constructor(a,b){super(Nb.Dense,a,b)}}class te extends oe{constructor(a,b){super(Nb.Sparse,a,b)}}class ue extends J{constructor(a){super();this.byteWidth=a}get typeId(){return G.FixedSizeBinary}toString(){return`FixedSizeBinary[${this.byteWidth}]`}}var ve=Symbol.toStringTag,we,xe=ue.prototype;xe.byteWidth=null;xe.ArrayType=Uint8Array;we=xe[Symbol.toStringTag]="FixedSizeBinary";ue[ve]=we;
class ye extends J{constructor(a,b){super();this.listSize=a;this.children=[b]}get typeId(){return G.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}var ze=Symbol.toStringTag,Ae,Be=ye.prototype;Be.children=null;Be.listSize=null;Ae=Be[Symbol.toStringTag]="FixedSizeList";ye[ze]=Ae;
class Ce extends J{constructor(a,b){b=void 0===b?!1:b;super();this.children=[a];this.keysSorted=b}get typeId(){return G.Map}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}toString(){return`Map<{${this.children[0].type.children.map(a=>`${a.name}:${a.type}`).join(", ")}}>`}}var De=Symbol.toStringTag,Ee,Fe=Ce.prototype;Fe.children=null;Fe.keysSorted=null;Ee=Fe[Symbol.toStringTag]="Map_";Ce[De]=Ee;const Ge=(a=>()=>++a)(-1);
class He extends J{constructor(a,b,c,d){super();this.indices=b;this.dictionary=a;this.isOrdered=d||!1;this.id=null==c?Ge():"number"===typeof c?c:c.low}get typeId(){return G.Dictionary}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}}var Ie=Symbol.toStringTag,Je,Ke=He.prototype;Ke.id=null;Ke.indices=null;Ke.isOrdered=null;Ke.dictionary=null;
Je=Ke[Symbol.toStringTag]="Dictionary";He[Ie]=Je;function Le(a){switch(a.typeId){case G.Decimal:return 4;case G.Timestamp:return 2;case G.Date:return 1+a.unit;case G.Interval:return 1+a.unit;case G.Int:return 1+ +(32<a.bitWidth);case G.Time:return 1+ +(32<a.bitWidth);case G.FixedSizeList:return a.listSize;case G.FixedSizeBinary:return a.byteWidth;default:return 1}};function Me(a,b,c){return a.map(d=>d.slice(b,c))}function Ne(a,b){if(a.typeId===G.Null)return a.clone(a.type,0,b,0);const c=a.length,d=a.nullCount,e=(new Uint8Array((b+63&-64)>>3)).fill(255,0,c>>3);e[c>>3]=(1<<c-(c&-8))-1;0<d&&e.set(Mc(a.offset,c,a.nullBitmap),0);const f=a.buffers;f[I.VALIDITY]=e;return a.clone(a.type,0,b,d+(b-c),f)}
class K{constructor(a,b,c,d,e,f,h){this.type=a;this.dictionary=h;this.offset=Math.floor(Math.max(b||0,0));this.length=Math.floor(Math.max(c||0,0));this.ga=Math.floor(Math.max(d||0,-1));this.childData=(f||[]).map(n=>n instanceof K?n:n.data);let k;e instanceof K?(this.stride=e.stride,this.values=e.values,this.typeIds=e.typeIds,this.nullBitmap=e.nullBitmap,this.valueOffsets=e.valueOffsets):(this.stride=Le(a),e&&((k=e[0])&&(this.valueOffsets=k),(k=e[1])&&(this.values=k),(k=e[2])&&(this.nullBitmap=k),
(k=e[3])&&(this.typeIds=k)))}get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get byteLength(){let a=0;const b=this.valueOffsets,c=this.values,d=this.nullBitmap,e=this.typeIds;b&&(a+=b.byteLength);c&&(a+=c.byteLength);d&&(a+=d.byteLength);e&&(a+=e.byteLength);return this.childData.reduce((f,h)=>f+h.byteLength,a)}get nullCount(){let a=this.ga,b;-1>=a&&(b=this.nullBitmap)&&(this.ga=a=this.length-
Pc(b,this.offset,this.offset+this.length));return a}clone(a,b=this.offset,c=this.length,d=this.ga,e=this,f=this.childData){return new K(a,b,c,d,e,f,this.dictionary)}slice(a,b){const c=this.stride,d=this.typeId,e=this.childData,f=+(0===this.ga)-1,h=16===d?c:1;let k;const n=this.buffers;(k=n[I.TYPE])&&(n[I.TYPE]=k.subarray(a,a+b));(k=n[I.OFFSET])&&(n[I.OFFSET]=k.subarray(a,a+b+1))||(k=n[I.DATA])&&(n[I.DATA]=6===d?k:k.subarray(c*a,c*(a+b)));return this.clone(this.type,this.offset+a,b,f,n,!e.length||
this.valueOffsets?e:Me(e,h*a,h*b))}static new(a,b,c,d,e,f,h){e instanceof K?e=e.buffers:e||(e=[]);switch(a.typeId){case G.Null:return K.Null(a,b,c);case G.Int:return K.Int(a,b,c,d||0,e[I.VALIDITY],e[I.DATA]||[]);case G.Dictionary:return K.Dictionary(a,b,c,d||0,e[I.VALIDITY],e[I.DATA]||[],h);case G.Float:return K.Float(a,b,c,d||0,e[I.VALIDITY],e[I.DATA]||[]);case G.Bool:return K.Bool(a,b,c,d||0,e[I.VALIDITY],e[I.DATA]||[]);case G.Decimal:return K.Decimal(a,b,c,d||0,e[I.VALIDITY],e[I.DATA]||[]);case G.Date:return K.Date(a,
b,c,d||0,e[I.VALIDITY],e[I.DATA]||[]);case G.Time:return K.Time(a,b,c,d||0,e[I.VALIDITY],e[I.DATA]||[]);case G.Timestamp:return K.Timestamp(a,b,c,d||0,e[I.VALIDITY],e[I.DATA]||[]);case G.Interval:return K.Interval(a,b,c,d||0,e[I.VALIDITY],e[I.DATA]||[]);case G.FixedSizeBinary:return K.FixedSizeBinary(a,b,c,d||0,e[I.VALIDITY],e[I.DATA]||[]);case G.Binary:return K.Binary(a,b,c,d||0,e[I.VALIDITY],e[I.OFFSET]||[],e[I.DATA]||[]);case G.Utf8:return K.Utf8(a,b,c,d||0,e[I.VALIDITY],e[I.OFFSET]||[],e[I.DATA]||
[]);case G.List:return K.List(a,b,c,d||0,e[I.VALIDITY],e[I.OFFSET]||[],(f||[])[0]);case G.FixedSizeList:return K.FixedSizeList(a,b,c,d||0,e[I.VALIDITY],(f||[])[0]);case G.Struct:return K.Struct(a,b,c,d||0,e[I.VALIDITY],f||[]);case G.Map:return K.Map(a,b,c,d||0,e[I.VALIDITY],e[I.OFFSET]||[],(f||[])[0]);case G.Union:return K.Union(a,b,c,d||0,e[I.VALIDITY],e[I.TYPE]||[],e[I.OFFSET]||f,f)}throw Error(`Unrecognized typeId ${a.typeId}`);}static Null(a,b,c){return new K(a,b,c,0)}static Int(a,b,c,d,e,f){return new K(a,
b,c,d,[void 0,z(a.ArrayType,f),z(Uint8Array,e)])}static Dictionary(a,b,c,d,e,f,h){return new K(a,b,c,d,[void 0,z(a.indices.ArrayType,f),z(Uint8Array,e)],[],h)}static Float(a,b,c,d,e,f){return new K(a,b,c,d,[void 0,z(a.ArrayType,f),z(Uint8Array,e)])}static Bool(a,b,c,d,e,f){return new K(a,b,c,d,[void 0,z(a.ArrayType,f),z(Uint8Array,e)])}static Decimal(a,b,c,d,e,f){return new K(a,b,c,d,[void 0,z(a.ArrayType,f),z(Uint8Array,e)])}static Date(a,b,c,d,e,f){return new K(a,b,c,d,[void 0,z(a.ArrayType,f),
z(Uint8Array,e)])}static Time(a,b,c,d,e,f){return new K(a,b,c,d,[void 0,z(a.ArrayType,f),z(Uint8Array,e)])}static Timestamp(a,b,c,d,e,f){return new K(a,b,c,d,[void 0,z(a.ArrayType,f),z(Uint8Array,e)])}static Interval(a,b,c,d,e,f){return new K(a,b,c,d,[void 0,z(a.ArrayType,f),z(Uint8Array,e)])}static FixedSizeBinary(a,b,c,d,e,f){return new K(a,b,c,d,[void 0,z(a.ArrayType,f),z(Uint8Array,e)])}static Binary(a,b,c,d,e,f,h){return new K(a,b,c,d,[z(Int32Array,f),z(Uint8Array,h),z(Uint8Array,e)])}static Utf8(a,
b,c,d,e,f,h){return new K(a,b,c,d,[z(Int32Array,f),z(Uint8Array,h),z(Uint8Array,e)])}static List(a,b,c,d,e,f,h){return new K(a,b,c,d,[z(Int32Array,f),void 0,z(Uint8Array,e)],h?[h]:[])}static FixedSizeList(a,b,c,d,e,f){return new K(a,b,c,d,[void 0,void 0,z(Uint8Array,e)],f?[f]:[])}static Struct(a,b,c,d,e,f){return new K(a,b,c,d,[void 0,void 0,z(Uint8Array,e)],f)}static Map(a,b,c,d,e,f,h){return new K(a,b,c,d,[z(Int32Array,f),void 0,z(Uint8Array,e)],h?[h]:[])}static Union(a,b,c,d,e,f,h,k){e=[void 0,
void 0,z(Uint8Array,e),z(a.ArrayType,f)];if(a.mode===Nb.Sparse)return new K(a,b,c,d,e,h);e[I.OFFSET]=z(Int32Array,h);return new K(a,b,c,d,e,k)}}K.prototype.childData=Object.freeze([]);function Oe(a){if(null===a)return"null";if(void 0===a)return"undefined";switch(typeof a){case "number":return`${a}`;case "bigint":return`${a}`;case "string":return`"${a}"`}return"function"===typeof a[Symbol.toPrimitive]?a[Symbol.toPrimitive]("string"):ArrayBuffer.isView(a)?`[${a}]`:JSON.stringify(a)};function Pe(a){if(!a||0>=a.length)return function(){return!0};let b="";const c=a.filter(d=>d===d);0<c.length&&(b=`
    switch (x) {${c.map(d=>`
        case ${"bigint"!==typeof d?Oe(d):fb?`${Oe(d)}n`:`"${Oe(d)}"`}:`).join("")}
            return false;
    }`);a.length!==c.length&&(b=`if (x !== x) return false;\n${b}`);return new Function("x",`${b}\nreturn true;`)};const Qe=(a,b)=>(a*b+63&-64||64)/b,Re=(a,b=0)=>a.length>=b?a.subarray(0,b):ob(new a.constructor(b),a,0);function Se(a,b){if(0<b){a.length+=b;b=a.length*a.stride;const c=a.buffer.length;b>=c&&a.Ea(0===c?Qe(1*b,a.BYTES_PER_ELEMENT):Qe(2*b,a.BYTES_PER_ELEMENT))}return a}
class Te{constructor(a,b=1){this.buffer=a;this.stride=b;this.BYTES_PER_ELEMENT=a.BYTES_PER_ELEMENT;this.ArrayType=a.constructor;this.Ea(this.length=a.length/b|0)}get byteLength(){return this.length*this.stride*this.BYTES_PER_ELEMENT|0}get reservedLength(){return this.buffer.length/this.stride}get reservedByteLength(){return this.buffer.byteLength}set(){return this}append(a){return this.set(this.length,a)}flush(a=this.length){a=Qe(a*this.stride,this.BYTES_PER_ELEMENT);a=Re(this.buffer,a);this.clear();
return a}clear(){this.length=0;this.Ea(0);return this}Ea(a){return this.buffer=ob(new this.ArrayType(a),this.buffer)}}Te.prototype.offset=0;class Ue extends Te{get(a){return this.buffer[a]}set(a,b){Se(this,a-this.length+1);this.buffer[a*this.stride]=b;return this}}
class Ve extends Ue{constructor(){super(new Uint8Array(0),.125);this.eb=0}get Bc(){return this.length-this.eb}get(a){return this.buffer[a>>3]>>a%8&1}set(a,b){const {buffer:c}=Se(this,a-this.length+1),d=a>>3;a%=8;const e=c[d]>>a&1;b?0===e&&(c[d]|=1<<a,++this.eb):1===e&&(c[d]&=~(1<<a),--this.eb);return this}clear(){this.eb=0;return super.clear()}}
class We extends Ue{constructor(){super(new Int32Array(1),1)}append(a){return this.set(this.length-1,a)}set(a,b){const c=this.length-1,d=Se(this,a-c+1).buffer;c<a++&&d.fill(d[c],c,a);d[a]=d[a-1]+b;return this}flush(a=this.length-1){a>this.length&&this.set(a-1,0);return super.flush(a+1)}}
class Xe extends Te{get ec(){return this.hc||(this.hc=this.buffer instanceof Int32Array?gb:hb)}set(a,b){Se(this,a-this.length+1);switch(typeof b){case "bigint":this.zb[a]=b;break;case "number":this.buffer[a*this.stride]=b;break;default:this.buffer.set(b,a*this.stride)}return this}Ea(a){a=super.Ea(a);const b=a.byteLength/(this.BYTES_PER_ELEMENT*this.stride);fb&&(this.zb=new this.ec(a.buffer,a.byteOffset,b));return a}};class L{constructor(a){var {type:b,nullValues:c}=a;this.length=0;this.finished=!1;this.type=b;this.children=[];this.nullValues=c;this.stride=Le(b);this.G=new Ve;c&&0<c.length&&(this.Rb=Pe(c))}static new(){}static throughNode(){throw Error('"throughNode" not available in this environment');}static throughDOM(){throw Error('"throughDOM" not available in this environment');}static throughIterable(a){return Ye(a)}static throughAsyncIterable(a){return Ze(a)}toVector(){return B.new(this.flush())}get ArrayType(){return this.type.ArrayType}get nullCount(){return this.G.Bc}get numChildren(){return this.children.length}get byteLength(){let a=
0;this.C&&(a+=this.C.byteLength);this.l&&(a+=this.l.byteLength);this.G&&(a+=this.G.byteLength);this.V&&(a+=this.V.byteLength);return this.children.reduce((b,c)=>b+c.byteLength,a)}get reservedLength(){return this.G.reservedLength}get reservedByteLength(){let a=0;this.C&&(a+=this.C.reservedByteLength);this.l&&(a+=this.l.reservedByteLength);this.G&&(a+=this.G.reservedByteLength);this.V&&(a+=this.V.reservedByteLength);return this.children.reduce((b,c)=>b+c.reservedByteLength,a)}get valueOffsets(){return this.C?
this.C.buffer:null}get values(){return this.l?this.l.buffer:null}get nullBitmap(){return this.G?this.G.buffer:null}get typeIds(){return this.V?this.V.buffer:null}append(a){return this.set(this.length,a)}isValid(a){return this.Rb(a)}set(a,b){this.setValid(a,this.isValid(b))&&this.setValue(a,b);return this}setValue(a,b){this.Ta(this,a,b)}setValid(a,b){this.length=this.G.set(a,+b).length;return b}addChild(){throw Error(`Cannot append children to non-nested type "${this.type}"`);}getChildAt(a){return this.children[a]||
null}flush(){var a=[];const b=this.l,c=this.C,d=this.V,e=this.length,f=this.nullCount;d?(a[I.TYPE]=d.flush(e),c&&(a[I.OFFSET]=c.flush(e))):c?(b&&(a[I.DATA]=b.flush(c.get(c.length-1))),a[I.OFFSET]=c.flush(e)):b&&(a[I.DATA]=b.flush(e));0<f&&(a[I.VALIDITY]=this.G.flush(e));a=K.new(this.type,0,e,f,a,this.children.map(h=>h.flush()));this.clear();return a}finish(){this.finished=!0;this.children.forEach(a=>a.finish());return this}clear(){this.length=0;this.C&&this.C.clear();this.l&&this.l.clear();this.G&&
this.G.clear();this.V&&this.V.clear();this.children.forEach(a=>a.clear());return this}}g=L.prototype;g.length=1;g.stride=1;g.children=null;g.finished=!1;g.nullValues=null;g.Rb=()=>!0;class $e extends L{constructor(a){super(a);this.l=new Ue(new this.ArrayType(0),this.stride)}setValue(a,b){const c=this.l;Se(c,a-c.length+1);return super.setValue(a,b)}}function af(a){const b=a.F,c=a.M;a.M=0;a.F=void 0;b&&0<b.size&&a.la(b,c)}
class bf extends L{constructor(a){super(a);this.M=0;this.C=new We}setValue(a,b){const c=this.F||(this.F=new Map),d=c.get(a);d&&(this.M-=d.length);this.M+=b.length;c.set(a,b)}setValid(a,b){return super.setValid(a,b)?!0:((this.F||(this.F=new Map)).set(a,void 0),!1)}clear(){this.M=0;this.F=void 0;return super.clear()}flush(){af(this);return super.flush()}finish(){af(this);return super.finish()}}
function Ye(a){const {["queueingStrategy"]:b="count"}=a,{["highWaterMark"]:c="bytes"!==b?1E3:Math.pow(2,14)}=a,d="bytes"!==b?"length":"byteLength";return function*(e){let f=0;const h=L.new(a);for(const k of e)h.append(k)[d]>=c&&++f&&(yield h.toVector());if(0<h.finish().length||0===f)yield h.toVector()}}
function Ze(a){const {["queueingStrategy"]:b="count"}=a,{["highWaterMark"]:c="bytes"!==b?1E3:Math.pow(2,14)}=a,d="bytes"!==b?"length":"byteLength";return function(e){return new oa(function*(){let f=0;const h=L.new(a);for(const k=ia(e);;){const n=yield new m(2,k.next());if(n.done)break;h.append(n.value)[d]>=c&&++f&&(yield new m(0,h.toVector()))}if(0<h.finish().length||0===f)yield new m(0,h.toVector())}())}};class cf extends L{constructor(a){super(a);this.l=new Ve}setValue(a,b){this.l.set(a,+b)}};class df extends L{setValue(){}setValid(a,b){this.length=Math.max(a+1,this.length);return b}};class ef extends $e{}class ff extends ef{}class gf extends ef{};class hf extends $e{};class jf extends L{constructor({type:a,nullValues:b,dictionaryHashFunction:c}){super({type:new He(a.dictionary,a.indices,a.id,a.isOrdered)});this.G=null;this.Qa=0;this.Sb=Object.create(null);this.indices=L.new({type:this.type.indices,nullValues:b});this.dictionary=L.new({type:this.type.dictionary,nullValues:null});"function"===typeof c&&(this.valueToKey=c)}get values(){return this.indices.values}get nullCount(){return this.indices.nullCount}get nullBitmap(){return this.indices.nullBitmap}get byteLength(){return this.indices.byteLength+
this.dictionary.byteLength}get reservedLength(){return this.indices.reservedLength+this.dictionary.reservedLength}get reservedByteLength(){return this.indices.reservedByteLength+this.dictionary.reservedByteLength}isValid(a){return this.indices.isValid(a)}setValid(a,b){const c=this.indices;b=c.setValid(a,b);this.length=c.length;return b}setValue(a,b){const c=this.Sb,d=this.valueToKey(b);let e=c[d];void 0===e&&(c[d]=e=this.Qa+this.dictionary.append(b).length-1);return this.indices.setValue(a,e)}flush(){var a=
this.type;const b=this.lc,c=this.dictionary.toVector();a=this.indices.flush().clone(a);a.dictionary=b?b.concat(c):c;this.finished||(this.Qa+=c.length);this.lc=a.dictionary;this.clear();return a}finish(){this.indices.finish();this.dictionary.finish();this.Qa=0;this.Sb=Object.create(null);return super.finish()}clear(){this.indices.clear();this.dictionary.clear();return super.clear()}valueToKey(a){return"string"===typeof a?a:`${a}`}};class kf extends $e{};const lf=new Float64Array(1),mf=new Uint32Array(lf.buffer);function nf(a){const b=(a&31744)>>10,c=(a&1023)/1024;a=Math.pow(-1,(a&32768)>>15);switch(b){case 31:return a*(c?NaN:1/0);case 0:return a*(c?6.103515625E-5*c:0)}return a*Math.pow(2,b-15)*(1+c)}
function of(a){if(a!==a)return 32256;lf[0]=a;a=(mf[1]&2147483648)>>16&65535;let b=mf[1]&2146435072,c=0;1089470464<=b?0<mf[0]?b=31744:(b=(b&2080374784)>>16,c=(mf[1]&1048575)>>10):1056964608>=b?(c=1048576+(mf[1]&1048575),c=1048576+(c<<(b>>20)-998)>>21,b=0):(b=b-1056964608>>10,c=(mf[1]&1048575)+512>>10);return a|b|c&65535}var pf={};pf.float64ToUint16=of;pf.uint16ToFloat64=nf;class qf extends $e{}class rf extends qf{setValue(a,b){this.l.set(a,of(b))}}class sf extends qf{setValue(a,b){this.l.set(a,b)}}class tf extends qf{setValue(a,b){this.l.set(a,b)}};const uf=Symbol.for("isArrowBigNum");function vf(a,...b){return 0===b.length?Object.setPrototypeOf(z(this.TypedArray,a),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(a,...b),this.constructor.prototype)}vf.prototype[uf]=!0;vf.prototype.toJSON=function(){return`"${wf(this)}"`};vf.prototype.valueOf=function(){return xf(this)};vf.prototype.toString=function(){return wf(this)};
vf.prototype[Symbol.toPrimitive]=function(a){switch(void 0===a?"default":a){case "number":return xf(this);case "default":return yf(this)}return wf(this)};function zf(...a){return vf.apply(this,a)}function Af(...a){return vf.apply(this,a)}function Bf(...a){return vf.apply(this,a)}Object.setPrototypeOf(zf.prototype,Object.create(Int32Array.prototype));Object.setPrototypeOf(Af.prototype,Object.create(Uint32Array.prototype));Object.setPrototypeOf(Bf.prototype,Object.create(Uint32Array.prototype));
Object.assign(zf.prototype,vf.prototype,{constructor:zf,signed:!0,TypedArray:Int32Array,BigIntArray:gb});Object.assign(Af.prototype,vf.prototype,{constructor:Af,signed:!1,TypedArray:Uint32Array,BigIntArray:hb});Object.assign(Bf.prototype,vf.prototype,{constructor:Bf,signed:!0,TypedArray:Uint32Array,BigIntArray:hb});
function xf(a){const {buffer:b,byteOffset:c,length:d,signed:e}=a;a=new Int32Array(b,c,d);let f=0,h=0;const k=a.length;let n,p;for(;h<k;)p=a[h++],n=a[h++],e||(n>>>=0),f+=(p>>>0)+n*Math.pow(h,32);return f}let wf,yf;fb?(yf=a=>8===a.byteLength?(new a.BigIntArray(a.buffer,a.byteOffset,1))[0]:Cf(a),wf=a=>8===a.byteLength?`${(new a.BigIntArray(a.buffer,a.byteOffset,1))[0]}`:Cf(a)):yf=wf=Cf;
function Cf(a){let b="";const c=new Uint32Array(2);a=new Uint16Array(a.buffer,a.byteOffset,a.byteLength/2);const d=new Uint32Array((a=(new Uint16Array(a)).reverse()).buffer);let e;const f=a.length-1;do{for(c[0]=a[e=0];e<f;)a[e++]=c[1]=c[0]/10,c[0]=(c[0]-10*c[1]<<16)+a[e];a[e]=c[1]=c[0]/10;c[0]-=10*c[1];b=`${c[0]}${b}`}while(d[0]||d[1]||d[2]||d[3]);return b?b:"0"}
class Df{static new(a,b){switch(b){case !0:return new zf(a);case !1:return new Af(a)}switch(a.constructor){case Int8Array:case Int16Array:case Int32Array:case gb:return new zf(a)}return 16===a.byteLength?new Bf(a):new Af(a)}constructor(a,b){return Df.new(a,b)}}var Ef={};Ef.BN=Df;Ef.bignumToBigInt=yf;Ef.bignumToString=wf;Ef.isArrowBigNumSymbol=uf;class Ff extends $e{setValue(a,b){this.l.set(a,b)}}class Gf extends Ff{}class Hf extends Ff{}class If extends Ff{}class Jf extends Ff{constructor(a){a.nullValues&&(a.nullValues=a.nullValues.map(Kf));super(a);this.l=new Xe(new Int32Array(0),2)}get values64(){return this.l.zb}isValid(a){return super.isValid(Kf(a))}}class Lf extends Ff{}class Mf extends Ff{}class Nf extends Ff{}
class Of extends Ff{constructor(a){a.nullValues&&(a.nullValues=a.nullValues.map(Kf));super(a);this.l=new Xe(new Uint32Array(0),2)}get values64(){return this.l.zb}isValid(a){return super.isValid(Kf(a))}}const Kf=(a=>b=>{ArrayBuffer.isView(b)&&(a.buffer=b.buffer,a.byteOffset=b.byteOffset,a.byteLength=b.byteLength,b=yf(a),a.buffer=null);return b})({BigIntArray:gb});class Pf extends $e{}class Qf extends Pf{}class Rf extends Pf{}class Sf extends Pf{}class Tf extends Pf{};class Uf extends $e{}class Vf extends Uf{}class Wf extends Uf{}class Xf extends Uf{}class Yf extends Uf{};class Zf extends $e{}class $f extends Zf{}class ag extends Zf{};class bg extends bf{constructor(a){super(a);this.l=new Te(new Uint8Array(0))}get byteLength(){let a=this.M+4*this.length;this.C&&(a+=this.C.byteLength);this.l&&(a+=this.l.byteLength);this.G&&(a+=this.G.byteLength);return a}setValue(a,b){return super.setValue(a,z(Uint8Array,b))}la(a,b){const c=this.C;b=Se(this.l,b).buffer;let d=0,e=0,f;for([d,f]of a)void 0===f?c.set(d,0):(a=f.length,b.set(f,e),c.set(d,a),e+=a)}};class cg extends bf{constructor(a){super(a);this.l=new Te(new Uint8Array(0))}get byteLength(){let a=this.M+4*this.length;this.C&&(a+=this.C.byteLength);this.l&&(a+=this.l.byteLength);this.G&&(a+=this.G.byteLength);return a}setValue(a,b){return super.setValue(a,Xa.encode(b))}la(){}}cg.prototype.la=bg.prototype.la;class dg{get length(){return this.l.length}get(a){return this.l[a]}clear(){this.l=null;return this}bind(a){if(a instanceof B)return a;this.l=a;return this}};class M{constructor(a=[],b,c){this.fields=a||[];this.metadata=b||new Map;c||(c=eg(a));this.dictionaries=c}get [Symbol.toStringTag](){return"Schema"}toString(){return`Schema<{ ${this.fields.map((a,b)=>`${b}: ${a}`).join(", ")} }>`}select(...a){const b=a.reduce((c,d)=>(c[d]=!0,c),Object.create(null));return new M(this.fields.filter(c=>b[c.name]),this.metadata)}selectAt(...a){return new M(a.map(b=>this.fields[b]).filter(Boolean),this.metadata)}assign(...a){var b=a[0]instanceof M?a[0]:Array.isArray(a[0])?
new M(a[0]):new M(a);const c=[...this.fields];a=fg(fg(new Map,this.metadata),b.metadata);b=b.fields.filter(e=>{const f=c.findIndex(h=>h.name===e.name);return~f?(c[f]=e.clone({metadata:fg(fg(new Map,c[f].metadata),e.metadata)}))&&!1:!0});const d=eg(b,new Map);return new M([...c,...b],a,new Map([...this.dictionaries,...d]))}}
class N{constructor(a,b,c=!1,d){this.name=a;this.type=b;this.nullable=c;this.metadata=d||new Map}static new(...a){let [b,c,d,e]=a;a[0]&&"object"===typeof a[0]&&({name:b}=a[0],void 0===c&&(c=a[0].type),void 0===d&&(d=a[0].nullable),void 0===e&&(e=a[0].metadata));return new N(`${b}`,c,d,e)}get typeId(){return this.type.typeId}get [Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...a){let [b,c,d,e]=a;a[0]&&"object"===typeof a[0]?{name:b=this.name,type:c=this.type,
nullable:d=this.nullable,metadata:e=this.metadata}=a[0]:[b=this.name,c=this.type,d=this.nullable,e=this.metadata]=a;return N.new(b,c,d,e)}}function fg(a,b){return new Map([...(a||new Map),...(b||new Map)])}
function eg(a,b=new Map){for(let c=-1,d=a.length;++c<d;){const e=a[c].type;if(J.isDictionary(e))if(!b.has(e.id))b.set(e.id,e.dictionary);else if(b.get(e.id)!==e.dictionary)throw Error("Cannot create Schema containing two different dictionaries with the same Id");e.children&&0<e.children.length&&eg(e.children,b)}return b}M.prototype.fields=null;M.prototype.metadata=null;M.prototype.dictionaries=null;N.prototype.type=null;N.prototype.name=null;N.prototype.nullable=null;N.prototype.metadata=null;class gg extends bf{constructor(a){super(a);this.Fa=new dg;this.C=new We}addChild(a,b="0"){if(0<this.numChildren)throw Error("ListBuilder can only have one child.");this.children[this.numChildren]=a;this.type=new ge(new N(b,a.type,!0));return this.numChildren-1}clear(){this.Fa.clear();return super.clear()}la(a){const b=this.Fa,c=this.C,d=this.Ta;let e=0,f;for([e,f]of a)void 0===f?c.set(e,0):(c.set(e,f.length),d(this,e,b.bind(f)))}};class hg extends L{constructor(){super(...arguments);this.Fa=new dg}setValue(a,b){super.setValue(a,this.Fa.bind(b))}addChild(a,b="0"){if(0<this.numChildren)throw Error("FixedSizeListBuilder can only have one child.");const c=this.children.push(a);this.type=new ye(this.type.listSize,new N(b,a.type,!0));return c}clear(){this.Fa.clear();return super.clear()}};class ig extends bf{set(a,b){return super.set(a,b)}setValue(a,b){b=b instanceof Map?b:new Map(Object.entries(b));const c=this.F||(this.F=new Map),d=c.get(a);d&&(this.M-=d.size);this.M+=b.size;c.set(a,b)}addChild(a,b=`${this.numChildren}`){if(0<this.numChildren)throw Error("ListBuilder can only have one child.");this.children[this.numChildren]=a;this.type=new Ce(new N(b,a.type,!0),this.type.keysSorted);return this.numChildren-1}la(a){const b=this.C,c=this.Ta;a.forEach((d,e)=>{void 0===d?b.set(e,0):
(b.set(e,d.size),c(this,e,d))})}};class jg extends L{addChild(a,b=`${this.numChildren}`){const c=this.children.push(a);this.type=new ke([...this.type.children,new N(b,a.type,!0)]);return c}};class kg extends L{constructor(a){super(a);this.V=new Ue(new Int8Array(0),1);"function"===typeof a.valueToChildTypeId&&(this.Ub=a.valueToChildTypeId)}get typeIdToChildIndex(){return this.type.typeIdToChildIndex}append(a,b){return this.set(this.length,a,b)}set(a,b,c){void 0===c&&(c=this.Ub(this,b,a));this.setValid(a,this.isValid(b))&&this.setValue(a,b,c);return this}setValue(a,b,c){this.V.set(a,c);super.setValue(a,b)}addChild(a,b=`${this.children.length}`){const c=this.children.push(a),{type:{children:d,
mode:e,typeIds:f}}=this;a=[...d,new N(b,a.type)];this.type=new oe(e,[...f,c],a);return c}Ub(){throw Error("Cannot map UnionBuilder value to child typeId. Pass the `childTypeId` as the second argument to unionBuilder.append(), or supply a `valueToChildTypeId` function as part of the UnionBuilder constructor options.");}}class lg extends kg{}
class mg extends kg{constructor(a){super(a);this.C=new Ue(new Int32Array(0))}setValue(a,b,c){this.C.set(a,this.getChildAt(this.type.typeIdToChildIndex[c]).length);return super.setValue(a,b,c)}};class ng{visitMany(a,...b){return a.map((c,d)=>this.visit(c,...b.map(e=>e[d])))}visit(...a){return this.getVisitFn(a[0],!1).apply(this,a)}getVisitFn(a,b=!0){return og(this,a,b)}visitNull(){return null}visitBool(){return null}visitInt(){return null}visitFloat(){return null}visitUtf8(){return null}visitBinary(){return null}visitFixedSizeBinary(){return null}visitDate(){return null}visitTimestamp(){return null}visitTime(){return null}visitDecimal(){return null}visitList(){return null}visitStruct(){return null}visitUnion(){return null}visitDictionary(){return null}visitInterval(){return null}visitFixedSizeList(){return null}visitMap(){return null}}
function og(a,b,c=!0){let d=null,e=G.NONE;b instanceof K?e=pg(b.type):b instanceof B?e=pg(b.type):b instanceof J?e=pg(b):"number"!==typeof(e=b)&&(e=G[b]);switch(e){case G.Null:d=a.visitNull;break;case G.Bool:d=a.visitBool;break;case G.Int:d=a.visitInt;break;case G.Int8:d=a.visitInt8||a.visitInt;break;case G.Int16:d=a.visitInt16||a.visitInt;break;case G.Int32:d=a.visitInt32||a.visitInt;break;case G.Int64:d=a.visitInt64||a.visitInt;break;case G.Uint8:d=a.visitUint8||a.visitInt;break;case G.Uint16:d=
a.visitUint16||a.visitInt;break;case G.Uint32:d=a.visitUint32||a.visitInt;break;case G.Uint64:d=a.visitUint64||a.visitInt;break;case G.Float:d=a.visitFloat;break;case G.Float16:d=a.visitFloat16||a.visitFloat;break;case G.Float32:d=a.visitFloat32||a.visitFloat;break;case G.Float64:d=a.visitFloat64||a.visitFloat;break;case G.Utf8:d=a.visitUtf8;break;case G.Binary:d=a.visitBinary;break;case G.FixedSizeBinary:d=a.visitFixedSizeBinary;break;case G.Date:d=a.visitDate;break;case G.DateDay:d=a.visitDateDay||
a.visitDate;break;case G.DateMillisecond:d=a.visitDateMillisecond||a.visitDate;break;case G.Timestamp:d=a.visitTimestamp;break;case G.TimestampSecond:d=a.visitTimestampSecond||a.visitTimestamp;break;case G.TimestampMillisecond:d=a.visitTimestampMillisecond||a.visitTimestamp;break;case G.TimestampMicrosecond:d=a.visitTimestampMicrosecond||a.visitTimestamp;break;case G.TimestampNanosecond:d=a.visitTimestampNanosecond||a.visitTimestamp;break;case G.Time:d=a.visitTime;break;case G.TimeSecond:d=a.visitTimeSecond||
a.visitTime;break;case G.TimeMillisecond:d=a.visitTimeMillisecond||a.visitTime;break;case G.TimeMicrosecond:d=a.visitTimeMicrosecond||a.visitTime;break;case G.TimeNanosecond:d=a.visitTimeNanosecond||a.visitTime;break;case G.Decimal:d=a.visitDecimal;break;case G.List:d=a.visitList;break;case G.Struct:d=a.visitStruct;break;case G.Union:d=a.visitUnion;break;case G.DenseUnion:d=a.visitDenseUnion||a.visitUnion;break;case G.SparseUnion:d=a.visitSparseUnion||a.visitUnion;break;case G.Dictionary:d=a.visitDictionary;
break;case G.Interval:d=a.visitInterval;break;case G.IntervalDayTime:d=a.visitIntervalDayTime||a.visitInterval;break;case G.IntervalYearMonth:d=a.visitIntervalYearMonth||a.visitInterval;break;case G.FixedSizeList:d=a.visitFixedSizeList;break;case G.Map:d=a.visitMap}if("function"===typeof d)return d;if(!c)return()=>null;throw Error(`Unrecognized type '${G[e]}'`);}
function pg(a){switch(a.typeId){case G.Null:return G.Null;case G.Int:const b=a.isSigned;switch(a.bitWidth){case 8:return b?G.Int8:G.Uint8;case 16:return b?G.Int16:G.Uint16;case 32:return b?G.Int32:G.Uint32;case 64:return b?G.Int64:G.Uint64}return G.Int;case G.Float:switch(a.precision){case Pb.HALF:return G.Float16;case Pb.SINGLE:return G.Float32;case Pb.DOUBLE:return G.Float64}return G.Float;case G.Binary:return G.Binary;case G.Utf8:return G.Utf8;case G.Bool:return G.Bool;case G.Decimal:return G.Decimal;
case G.Time:switch(a.unit){case C.SECOND:return G.TimeSecond;case C.MILLISECOND:return G.TimeMillisecond;case C.MICROSECOND:return G.TimeMicrosecond;case C.NANOSECOND:return G.TimeNanosecond}return G.Time;case G.Timestamp:switch(a.unit){case C.SECOND:return G.TimestampSecond;case C.MILLISECOND:return G.TimestampMillisecond;case C.MICROSECOND:return G.TimestampMicrosecond;case C.NANOSECOND:return G.TimestampNanosecond}return G.Timestamp;case G.Date:switch(a.unit){case Rb.DAY:return G.DateDay;case Rb.MILLISECOND:return G.DateMillisecond}return G.Date;
case G.Interval:switch(a.unit){case Ub.DAY_TIME:return G.IntervalDayTime;case Ub.YEAR_MONTH:return G.IntervalYearMonth}return G.Interval;case G.Map:return G.Map;case G.List:return G.List;case G.Struct:return G.Struct;case G.Union:switch(a.mode){case Nb.Dense:return G.DenseUnion;case Nb.Sparse:return G.SparseUnion}return G.Union;case G.FixedSizeBinary:return G.FixedSizeBinary;case G.FixedSizeList:return G.FixedSizeList;case G.Dictionary:return G.Dictionary}throw Error(`Unrecognized type '${G[a.typeId]}'`);
}g=ng.prototype;g.visitInt8=null;g.visitInt16=null;g.visitInt32=null;g.visitInt64=null;g.visitUint8=null;g.visitUint16=null;g.visitUint32=null;g.visitUint64=null;g.visitFloat16=null;g.visitFloat32=null;g.visitFloat64=null;g.visitDateDay=null;g.visitDateMillisecond=null;g.visitTimestampSecond=null;g.visitTimestampMillisecond=null;g.visitTimestampMicrosecond=null;g.visitTimestampNanosecond=null;g.visitTimeSecond=null;g.visitTimeMillisecond=null;g.visitTimeMicrosecond=null;g.visitTimeNanosecond=null;
g.visitDenseUnion=null;g.visitSparseUnion=null;g.visitIntervalDayTime=null;g.visitIntervalYearMonth=null;class qg extends ng{}
const rg=(a,b,c,d)=>{const {[c]:e,[c+1]:f}=b;null!=e&&null!=f&&a.set(d.subarray(0,f-e),e)},sg=(a,b,c)=>{({values:a}=a);a[b]=c.valueOf()/864E5|0},tg=(a,b,c)=>{({values:a}=a);b*=2;c=c.valueOf();a[b]=c%4294967296|0;a[b+1]=c/4294967296|0},ug=(a,b,c)=>{var {stride:d,values:e}=a;e[d*b]=c},vg=(a,b,c)=>{var {stride:d,values:e}=a;e[d*b]=of(c)},wg=(a,b,c)=>{switch(typeof c){case "bigint":a.values64[b]=c;break;case "number":a.values[b*a.stride]=c;break;default:const d=a.stride;c=z(a.ArrayType,c);a.values.set(c.subarray(0,
d),d*b)}},xg=(a,b,c)=>{({values:a}=a);b*=2;c/=1E3;a[b]=c%4294967296|0;a[b+1]=c/4294967296|0},yg=(a,b,c)=>{({values:a}=a);b*=2;a[b]=c%4294967296|0;a[b+1]=c/4294967296|0},zg=(a,b,c)=>{({values:a}=a);b*=2;a[b]=1E3*c%4294967296|0;a[b+1]=1E3*c/4294967296|0},Ag=(a,b,c)=>{({values:a}=a);b*=2;a[b]=1E6*c%4294967296|0;a[b+1]=1E6*c/4294967296|0},Bg=(a,b,c)=>{var {values:d,stride:e}=a;d[e*b]=c},Cg=(a,b,c)=>{var {values:d,stride:e}=a;d[e*b]=c},Dg=(a,b,c)=>{({values:a}=a);a.set(c.subarray(0,2),2*b)},Eg=(a,b,c)=>
{({values:a}=a);a.set(c.subarray(0,2),2*b)};let Fg;const Gg=(a,b)=>(c,d,e)=>null==(Fg=c)?void 0:Fg.set(a,b[e]);let Hg;const Ig=(a,b)=>(c,d,e)=>null==(Hg=c)?void 0:Hg.set(a,b.get(e));let Jg;const Kg=(a,b)=>(c,d)=>null==(Jg=c)?void 0:Jg.set(a,b.get(d.name));let Lg;
const Mg=(a,b)=>(c,d)=>null==(Lg=c)?void 0:Lg.set(a,b[d.name]),Ng=(a,b,c)=>{const d=a.getChildAt(a.typeIdToChildIndex[a.typeIds[b]]);d&&d.set(a.valueOffsets[b],c)},Og=(a,b,c)=>{(a=a.getChildAt(a.typeIdToChildIndex[a.typeIds[b]]))&&a.set(b,c)},Pg=(a,b,c)=>{({values:a}=a);a.set(c.subarray(0,2),2*b)},Qg=(a,b,c)=>{({values:a}=a);a[b]=12*c[0]+c[1]%12};g=qg.prototype;g.visitBool=(a,b,c)=>{var {offset:d,values:e}=a;a=d+b;c?e[a>>3]|=1<<a%8:e[a>>3]&=~(1<<a%8)};
g.visitInt=(a,b,c)=>{64>a.type.bitWidth?ug(a,b,c):wg(a,b,c)};g.visitInt8=ug;g.visitInt16=ug;g.visitInt32=ug;g.visitInt64=wg;g.visitUint8=ug;g.visitUint16=ug;g.visitUint32=ug;g.visitUint64=wg;g.visitFloat=(a,b,c)=>{a.type.precision!==Pb.HALF?ug(a,b,c):vg(a,b,c)};g.visitFloat16=vg;g.visitFloat32=ug;g.visitFloat64=ug;g.visitUtf8=(a,b,c)=>{var {values:d,valueOffsets:e}=a;rg(d,e,b,Xa.encode(c))};g.visitBinary=(a,b,c)=>{var {values:d,valueOffsets:e}=a;return rg(d,e,b,c)};
g.visitFixedSizeBinary=(a,b,c)=>{var {stride:d,values:e}=a;e.set(c.subarray(0,d),d*b)};g.visitDate=(a,b,c)=>{a.type.unit===Rb.DAY?sg(a,b,c):tg(a,b,c)};g.visitDateDay=sg;g.visitDateMillisecond=tg;g.visitTimestamp=(a,b,c)=>{switch(a.type.unit){case C.SECOND:return xg(a,b,c);case C.MILLISECOND:return yg(a,b,c);case C.MICROSECOND:return zg(a,b,c);case C.NANOSECOND:return Ag(a,b,c)}};g.visitTimestampSecond=xg;g.visitTimestampMillisecond=yg;g.visitTimestampMicrosecond=zg;g.visitTimestampNanosecond=Ag;
g.visitTime=(a,b,c)=>{switch(a.type.unit){case C.SECOND:return Bg(a,b,c);case C.MILLISECOND:return Cg(a,b,c);case C.MICROSECOND:return Dg(a,b,c);case C.NANOSECOND:return Eg(a,b,c)}};g.visitTimeSecond=Bg;g.visitTimeMillisecond=Cg;g.visitTimeMicrosecond=Dg;g.visitTimeNanosecond=Eg;g.visitDecimal=(a,b,c)=>{({values:a}=a);a.set(c.subarray(0,4),4*b)};g.visitList=(a,b,c)=>{const d=a.getChildAt(0);a=a.valueOffsets;for(let e=-1,f=a[b],h=a[b+1];f<h;)d.set(f++,c.get(++e))};
g.visitStruct=(a,b,c)=>{const d=c instanceof Map?Kg(b,c):c instanceof B?Ig(b,c):Array.isArray(c)?Gg(b,c):Mg(b,c);a.type.children.forEach((e,f)=>d(a.getChildAt(f),e,f))};g.visitUnion=(a,b,c)=>{a.type.mode===Nb.Dense?Ng(a,b,c):Og(a,b,c)};g.visitDenseUnion=Ng;g.visitSparseUnion=Og;g.visitDictionary=(a,b,c)=>{b=a.getKey(b);null!==b&&a.setValue(b,c)};g.visitInterval=(a,b,c)=>{a.type.unit===Ub.DAY_TIME?Pg(a,b,c):Qg(a,b,c)};g.visitIntervalDayTime=Pg;g.visitIntervalYearMonth=Qg;
g.visitFixedSizeList=(a,b,c)=>{const d=a.getChildAt(0);a=a.stride;for(let e=-1,f=b*a;++e<a;)d.set(f+e,c.get(e))};g.visitMap=(a,b,c)=>{const d=a.getChildAt(0);a=a.valueOffsets;c=c instanceof Map?[...c]:Object.entries(c);for(let e=-1,f=a[b],h=a[b+1];f<h;)d.set(f++,c[++e])};const Rg=new qg;class Sg extends ng{visitNull(){return df}visitBool(){return cf}visitInt(){return Ff}visitInt8(){return Gf}visitInt16(){return Hf}visitInt32(){return If}visitInt64(){return Jf}visitUint8(){return Lf}visitUint16(){return Mf}visitUint32(){return Nf}visitUint64(){return Of}visitFloat(){return qf}visitFloat16(){return rf}visitFloat32(){return sf}visitFloat64(){return tf}visitUtf8(){return cg}visitBinary(){return bg}visitFixedSizeBinary(){return kf}visitDate(){return ef}visitDateDay(){return ff}visitDateMillisecond(){return gf}visitTimestamp(){return Uf}visitTimestampSecond(){return Vf}visitTimestampMillisecond(){return Wf}visitTimestampMicrosecond(){return Xf}visitTimestampNanosecond(){return Yf}visitTime(){return Pf}visitTimeSecond(){return Qf}visitTimeMillisecond(){return Rf}visitTimeMicrosecond(){return Sf}visitTimeNanosecond(){return Tf}visitDecimal(){return hf}visitList(){return gg}visitStruct(){return jg}visitUnion(){return kg}visitDenseUnion(){return mg}visitSparseUnion(){return lg}visitDictionary(){return jf}visitInterval(){return Zf}visitIntervalDayTime(){return $f}visitIntervalYearMonth(){return ag}visitFixedSizeList(){return hg}visitMap(){return ig}}
const Tg=new Sg;L.new=Ug;function Ug(a){const b=a.type,c=new (Tg.getVisitFn(b)())(a);if(b.children&&0<b.children.length){const d=a.children||[],e={nullValues:a.nullValues},f=Array.isArray(d)?(h,k)=>d[k]||e:h=>{({name:h}=h);return d[h]||e};b.children.forEach((h,k)=>{const n=h.type;h=f(h,k);c.children.push(Ug(Object.assign({},h,{type:n})))})}return c}Object.keys(G).map(a=>G[a]).filter(a=>"number"===typeof a&&a!==G.NONE).forEach(a=>{Tg.visit(a).prototype.Ta=Rg.getVisitFn(a)});cg.prototype.Ta=Rg.visitBinary;function Vg(a,b){a.finish(b)}
class Wg{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}version(){const a=v(this.g,this.h,4);return a?Ka(this.g,this.h+a):Hb.V1}schema(a){const b=v(this.g,this.h,6);return b?(a||new vc).i(Sa(this.g,this.h+b),this.g):null}dictionaries(a,b){const c=v(this.g,this.h,8);return c?(b||new Xg).i(Ta(this.g,this.h+c)+24*a,this.g):null}Hb(a){const b=v(this.g,this.h,10);return b?(new Xg).i(Ta(this.g,this.h+b)+24*a,this.g):null}$a(a){const b=v(this.g,this.h,12);return b?(new kc).i(Sa(this.g,
Ta(this.g,this.h+b)+4*a),this.g):null}ab(){const a=v(this.g,this.h,12);return a?Ua(this.g,this.h+a):0}}class Xg{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}offset(){return Pa(this.g,this.h)}Cb(){return this.g.v(this.h+8)}bodyLength(){return Pa(this.g,this.h+16)}};function*Yg(a){for(let b,c=-1,d=a.numDictionaries;++c<d;)if(b=a.bb(c))yield b}
class Zg{constructor(a,b=Hb.V4,c,d){this.schema=a;this.version=b;c&&(this.ea=c);d&&(this.Ob=d)}static decode(a){a=new ya(z(Uint8Array,a));a=(new Wg).i(a.v(a.position())+a.position(),a);const b=M.decode(a.schema());return new $g(b,a)}static encode(a){const b=new xa,c=M.encode(b,a.schema);La(b,24,a.numRecordBatches,8);[...a.Hb()].slice().reverse().forEach(e=>ah.encode(b,e));const d=Ma(b);La(b,24,a.numDictionaries,8);[...Yg(a)].slice().reverse().forEach(e=>ah.encode(b,e));a=Ma(b);r(b,5);q(b,1,c);Fa(b,
Hb.V4,Hb.V1);q(b,3,d);q(b,2,a);Vg(b,t(b));return za(b)}get numRecordBatches(){return this.ea.length}get numDictionaries(){return this.Ob.length}*Hb(){for(let a,b=-1,c=this.numRecordBatches;++b<c;)if(a=this.ra(b))yield a}ra(a){return 0<=a&&a<this.numRecordBatches&&this.ea[a]||null}bb(a){return 0<=a&&a<this.numDictionaries&&this.Ob[a]||null}}
class $g extends Zg{constructor(a,b){super(a,b.version());this.j=b}get numRecordBatches(){var a=this.j;const b=v(a.g,a.h,10);return b?Ua(a.g,a.h+b):0}get numDictionaries(){var a=this.j;const b=v(a.g,a.h,8);return b?Ua(a.g,a.h+b):0}ra(a){return 0<=a&&a<this.numRecordBatches&&(a=this.j.Hb(a))?ah.decode(a):null}bb(a){return 0<=a&&a<this.numDictionaries&&(a=this.j.dictionaries(a))?ah.decode(a):null}}
class ah{constructor(a,b,c){this.Cb=a;this.offset="number"===typeof c?c:c.low;this.bodyLength="number"===typeof b?b:b.low}static decode(a){return new ah(a.Cb(),a.bodyLength(),a.offset())}static encode(a,b){var c=new va(b.offset,0),d=b.Cb;b=new va(b.bodyLength,0);Aa(a,8,24);a.da(b);Ba(a,4);a.Z(d);a.da(c);return a.offset()}};class bh extends bb{write(a){if(0<(a=z(Uint8Array,a)).byteLength)return super.write(a)}toString(a){return(void 0===a?0:a)?Va.decode(this.toUint8Array(!0)):this.toUint8Array(!1).then(Wa)}toUint8Array(a){return(void 0===a?0:a)?pb(this.l)[0]:(()=>{const b=this;return l(function*(){const c=[];let d=0;for(const f=ia(b);;){var e=yield f.next();if(e.done)break;e=e.value;c.push(e);d+=e.byteLength}return pb(c,d)[0]})})()}}
class ch{constructor(a){a&&(this.source=new dh(wb(xb(a))))}[Symbol.iterator](){return this}next(a){return this.source.next(a)}throw(a){return this.source.throw(a)}return(a){return this.source.return(a)}peek(a){return this.source.peek(a)}read(a){return this.source.read(a)}}
class eh{constructor(a){a instanceof eh?this.source=a.source:a instanceof bh?this.source=new fh(wb(yb(a))):lb(a)?this.source=new fh(wb(Gb(a))):kb(a)?this.source=new fh(wb(zb(a))):y(a)&&kb(a.body)?this.source=new fh(wb(zb(a.body))):ib(a)?this.source=new fh(wb(xb(a))):y(a)&&x(a.then)?this.source=new fh(wb(yb(a))):jb(a)&&(this.source=new fh(wb(yb(a))))}[Symbol.asyncIterator](){return this}next(a){return this.source.next(a)}throw(a){return this.source.throw(a)}return(a){return this.source.return(a)}get closed(){return this.source.closed}cancel(a){return this.source.cancel(a)}peek(a){return this.source.peek(a)}read(a){return this.source.read(a)}}
class dh{constructor(a){this.source=a}cancel(a){this.return(a)}peek(a){return this.next(a,"peek").value}read(a){return this.next(a,"read").value}next(a,b){return this.source.next({aa:void 0===b?"read":b,size:a})}throw(a){return Object.create(this.source.throw&&this.source.throw(a)||w)}return(a){return Object.create(this.source.return&&this.source.return(a)||w)}}
class fh{constructor(a){this.source=a;this.lb=new Promise(b=>this.L=b)}cancel(a){const b=this;return l(function*(){yield b.return(a)})}get closed(){return this.lb}read(a){const b=this;return l(function*(){return(yield b.next(a,"read")).value})}peek(a){const b=this;return l(function*(){return(yield b.next(a,"peek")).value})}next(a,b){b=void 0===b?"read":b;const c=this;return l(function*(){return yield c.source.next({aa:b,size:a})})}throw(a){const b=this;return l(function*(){const c=b.source.throw&&
(yield b.source.throw(a))||w;b.L&&b.L();b.L=void 0;return Object.create(c)})}return(a){const b=this;return l(function*(){const c=b.source.return&&(yield b.source.return(a))||w;b.L&&b.L();b.L=void 0;return Object.create(c)})}};class gh extends ch{constructor(a){super();this.position=0;this.buffer=z(Uint8Array,a);this.size=this.buffer.byteLength}v(a){const {buffer:b,byteOffset:c}=this.sa(a,4);return(new DataView(b,c)).getInt32(0,!0)}seek(a){this.position=Math.min(a,this.size);return a<this.size}read(a){const b=this.buffer,c=this.size,d=this.position;return b&&d<c?("number"!==typeof a&&(a=Infinity),this.position=Math.min(c,d+Math.min(c-d,a)),b.subarray(d,this.position)):null}sa(a,b){const c=this.buffer,d=Math.min(this.size,
a+b);return c?c.subarray(a,d):new Uint8Array(b)}close(){this.buffer&&(this.buffer=null)}throw(a){this.close();return{done:!0,value:a}}return(a){this.close();return{done:!0,value:a}}}
class hh extends eh{constructor(a,b){super();this.position=0;this.J=a;"number"===typeof b?this.size=b:this.F=(()=>{const c=this;return l(function*(){c.size=(yield a.stat()).size;delete c.F})})()}v(a){const b=this;return l(function*(){const {buffer:c,byteOffset:d}=yield b.sa(a,4);return(new DataView(c,d)).getInt32(0,!0)})}seek(a){const b=this;return l(function*(){b.F&&(yield b.F);b.position=Math.min(a,b.size);return a<b.size})}read(a){const b=this;return l(function*(){b.F&&(yield b.F);const c=b.J;
var d=b.size,e=b.position;if(c&&e<d){"number"!==typeof a&&(a=Infinity);let f=0,h=0;d=Math.min(d,e+Math.min(d-e,a));const k=new Uint8Array(Math.max(0,(b.position=d)-e));for(;(e+=h)<d&&(f+=h)<k.byteLength;)({Dc:h}=yield c.read(k,f,k.byteLength-f,e));return k}return null})}sa(a,b){const c=this;return l(function*(){c.F&&(yield c.F);const d=c.J;var e=c.size;return d&&a+b<e?(e=new Uint8Array(Math.min(e,a+b)-a),(yield d.read(e,0,b,a)).buffer):new Uint8Array(b)})}close(){const a=this;return l(function*(){const b=
a.J;a.J=null;b&&(yield b.close())})}throw(a){const b=this;return l(function*(){yield b.close();return{done:!0,value:a}})}return(a){const b=this;return l(function*(){yield b.close();return{done:!0,value:a}})}};function ih(a){0>a&&(a=4294967295+a+1);return`0x${a.toString(16)}`}const jh=[1,10,100,1E3,1E4,1E5,1E6,1E7,1E8];
function kh(a,b){const c=new Uint32Array([a.buffer[1]>>>16,a.buffer[1]&65535,a.buffer[0]>>>16,a.buffer[0]&65535]);b=new Uint32Array([b.buffer[1]>>>16,b.buffer[1]&65535,b.buffer[0]>>>16,b.buffer[0]&65535]);let d=c[3]*b[3];a.buffer[0]=d&65535;let e=d>>>16;d=c[2]*b[3];e+=d;d=c[3]*b[2]>>>0;e+=d;a.buffer[0]+=e<<16;a.buffer[1]=e>>>0<d?65536:0;a.buffer[1]+=e>>>16;a.buffer[1]+=c[1]*b[3]+c[2]*b[2]+c[3]*b[1];a.buffer[1]+=c[0]*b[3]+c[1]*b[2]+c[2]*b[1]+c[3]*b[0]<<16}
function lh(a,b){const c=a.buffer[0]+b.buffer[0]>>>0;a.buffer[1]+=b.buffer[1];c<a.buffer[0]>>>0&&++a.buffer[1];a.buffer[0]=c}class mh{constructor(a){this.buffer=a}high(){return this.buffer[1]}low(){return this.buffer[0]}lessThan(a){return this.buffer[1]<a.buffer[1]||this.buffer[1]===a.buffer[1]&&this.buffer[0]<a.buffer[0]}equals(a){return this.buffer[1]===a.buffer[1]&&this.buffer[0]==a.buffer[0]}greaterThan(a){return a.lessThan(this)}hex(){return`${ih(this.buffer[1])} ${ih(this.buffer[0])}`}}
class O extends mh{times(a){kh(this,a);return this}plus(a){lh(this,a);return this}static from(a,b=new Uint32Array(2)){return O.fromString("string"===typeof a?a:a.toString(),b)}static fromNumber(a,b=new Uint32Array(2)){return O.fromString(a.toString(),b)}static fromString(a,b=new Uint32Array(2)){const c=a.length;b=new O(b);for(let d=0;d<c;){const e=8<c-d?8:c-d,f=new O(new Uint32Array([parseInt(a.substr(d,e),10),0])),h=new O(new Uint32Array([jh[e],0]));b.times(h);b.plus(f);d+=e}return b}static convertArray(a){const b=
new Uint32Array(2*a.length);for(let c=-1,d=a.length;++c<d;)O.from(a[c],new Uint32Array(b.buffer,b.byteOffset+8*c,2));return b}static multiply(a,b){return(new O(new Uint32Array(a.buffer))).times(b)}static add(a,b){return(new O(new Uint32Array(a.buffer))).plus(b)}}
class nh extends mh{negate(){this.buffer[0]=~this.buffer[0]+1;this.buffer[1]=~this.buffer[1];0==this.buffer[0]&&++this.buffer[1];return this}times(a){kh(this,a);return this}plus(a){lh(this,a);return this}lessThan(a){const b=this.buffer[1]<<0,c=a.buffer[1]<<0;return b<c||b===c&&this.buffer[0]<a.buffer[0]}static from(a,b=new Uint32Array(2)){return nh.fromString("string"===typeof a?a:a.toString(),b)}static fromNumber(a,b=new Uint32Array(2)){return nh.fromString(a.toString(),b)}static fromString(a,b=
new Uint32Array(2)){const c=a.startsWith("-"),d=a.length;b=new nh(b);for(let e=c?1:0;e<d;){const f=8<d-e?8:d-e,h=new nh(new Uint32Array([parseInt(a.substr(e,f),10),0])),k=new nh(new Uint32Array([jh[f],0]));b.times(k);b.plus(h);e+=f}return c?b.negate():b}static convertArray(a){const b=new Uint32Array(2*a.length);for(let c=-1,d=a.length;++c<d;)nh.from(a[c],new Uint32Array(b.buffer,b.byteOffset+8*c,2));return b}static multiply(a,b){return(new nh(new Uint32Array(a.buffer))).times(b)}static add(a,b){return(new nh(new Uint32Array(a.buffer))).plus(b)}}
class oh{constructor(a){this.buffer=a}high(){return new nh(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new nh(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){this.buffer[0]=~this.buffer[0]+1;this.buffer[1]=~this.buffer[1];this.buffer[2]=~this.buffer[2];this.buffer[3]=~this.buffer[3];0==this.buffer[0]&&++this.buffer[1];0==this.buffer[1]&&++this.buffer[2];0==this.buffer[2]&&++this.buffer[3];return this}times(a){const b=new O(new Uint32Array([this.buffer[3],
0])),c=new O(new Uint32Array([this.buffer[2],0])),d=new O(new Uint32Array([this.buffer[1],0])),e=new O(new Uint32Array([this.buffer[0],0])),f=new O(new Uint32Array([a.buffer[3],0])),h=new O(new Uint32Array([a.buffer[2],0])),k=new O(new Uint32Array([a.buffer[1],0]));a=new O(new Uint32Array([a.buffer[0],0]));let n=O.multiply(e,a);this.buffer[0]=n.low();const p=new O(new Uint32Array([n.high(),0]));n=O.multiply(d,a);p.plus(n);n=O.multiply(e,k);p.plus(n);this.buffer[1]=p.low();this.buffer[3]=p.lessThan(n)?
1:0;this.buffer[2]=p.high();(new O(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))).plus(O.multiply(c,a)).plus(O.multiply(d,k)).plus(O.multiply(e,h));this.buffer[3]+=O.multiply(b,a).plus(O.multiply(c,k)).plus(O.multiply(d,h)).plus(O.multiply(e,f)).low();return this}plus(a){const b=new Uint32Array(4);b[3]=this.buffer[3]+a.buffer[3]>>>0;b[2]=this.buffer[2]+a.buffer[2]>>>0;b[1]=this.buffer[1]+a.buffer[1]>>>0;b[0]=this.buffer[0]+a.buffer[0]>>>0;b[0]<this.buffer[0]>>>0&&++b[1];b[1]<this.buffer[1]>>>
0&&++b[2];b[2]<this.buffer[2]>>>0&&++b[3];this.buffer[3]=b[3];this.buffer[2]=b[2];this.buffer[1]=b[1];this.buffer[0]=b[0];return this}hex(){return`${ih(this.buffer[3])} ${ih(this.buffer[2])} ${ih(this.buffer[1])} ${ih(this.buffer[0])}`}static multiply(a,b){return(new oh(new Uint32Array(a.buffer))).times(b)}static add(a,b){return(new oh(new Uint32Array(a.buffer))).plus(b)}static from(a,b=new Uint32Array(4)){return oh.fromString("string"===typeof a?a:a.toString(),b)}static fromNumber(a,b=new Uint32Array(4)){return oh.fromString(a.toString(),
b)}static fromString(a,b=new Uint32Array(4)){const c=a.startsWith("-"),d=a.length;b=new oh(b);for(let e=c?1:0;e<d;){const f=8<d-e?8:d-e,h=new oh(new Uint32Array([parseInt(a.substr(e,f),10),0,0,0])),k=new oh(new Uint32Array([jh[f],0,0,0]));b.times(k);b.plus(h);e+=f}return c?b.negate():b}static convertArray(a){const b=new Uint32Array(4*a.length);for(let c=-1,d=a.length;++c<d;)oh.from(a[c],new Uint32Array(b.buffer,b.byteOffset+16*c,4));return b}}var ph={};ph.BaseInt64=mh;ph.Int128=oh;ph.Int64=nh;
ph.Uint64=O;function P(a){return a.N[++a.Ac]}function qh(a){return a.buffers[++a.vc]}
class rh extends ng{constructor(a,b,c,d){super();this.vc=this.Ac=-1;this.T=a;this.N=b;this.buffers=c;this.dictionaries=d}visit(a){return super.visit(a instanceof N?a.type:a)}visitNull(a,{length:b}=P(this)){return K.Null(a,0,b)}visitBool(a,{length:b,nullCount:c}=P(this)){return K.Bool(a,0,b,c,this.D(a,c),this.I(a))}visitInt(a,{length:b,nullCount:c}=P(this)){return K.Int(a,0,b,c,this.D(a,c),this.I(a))}visitFloat(a,{length:b,nullCount:c}=P(this)){return K.Float(a,0,b,c,this.D(a,c),this.I(a))}visitUtf8(a,
{length:b,nullCount:c}=P(this)){return K.Utf8(a,0,b,c,this.D(a,c),this.ta(a),this.I(a))}visitBinary(a,{length:b,nullCount:c}=P(this)){return K.Binary(a,0,b,c,this.D(a,c),this.ta(a),this.I(a))}visitFixedSizeBinary(a,{length:b,nullCount:c}=P(this)){return K.FixedSizeBinary(a,0,b,c,this.D(a,c),this.I(a))}visitDate(a,{length:b,nullCount:c}=P(this)){return K.Date(a,0,b,c,this.D(a,c),this.I(a))}visitTimestamp(a,{length:b,nullCount:c}=P(this)){return K.Timestamp(a,0,b,c,this.D(a,c),this.I(a))}visitTime(a,
{length:b,nullCount:c}=P(this)){return K.Time(a,0,b,c,this.D(a,c),this.I(a))}visitDecimal(a,{length:b,nullCount:c}=P(this)){return K.Decimal(a,0,b,c,this.D(a,c),this.I(a))}visitList(a,{length:b,nullCount:c}=P(this)){return K.List(a,0,b,c,this.D(a,c),this.ta(a),this.visit(a.children[0]))}visitStruct(a,{length:b,nullCount:c}=P(this)){return K.Struct(a,0,b,c,this.D(a,c),this.visitMany(a.children))}visitUnion(a){return a.mode===Nb.Sparse?this.visitSparseUnion(a):this.visitDenseUnion(a)}visitDenseUnion(a,
{length:b,nullCount:c}=P(this)){return K.Union(a,0,b,c,this.D(a,c),this.Gb(a),this.ta(a),this.visitMany(a.children))}visitSparseUnion(a,{length:b,nullCount:c}=P(this)){return K.Union(a,0,b,c,this.D(a,c),this.Gb(a),this.visitMany(a.children))}visitDictionary(a,{length:b,nullCount:c}=P(this)){return K.Dictionary(a,0,b,c,this.D(a,c),this.I(a.indices),this.dictionaries.get(a.id))}visitInterval(a,{length:b,nullCount:c}=P(this)){return K.Interval(a,0,b,c,this.D(a,c),this.I(a))}visitFixedSizeList(a,{length:b,
nullCount:c}=P(this)){return K.FixedSizeList(a,0,b,c,this.D(a,c),this.visit(a.children[0]))}visitMap(a,{length:b,nullCount:c}=P(this)){return K.Map(a,0,b,c,this.D(a,c),this.ta(a),this.visit(a.children[0]))}D(a,b){var c=qh(this);return 0<b&&this.I(a,c)||new Uint8Array(0)}ta(a){return this.I(a,void 0)}Gb(a){return this.I(a,void 0)}I(a,{length:b,offset:c}=qh(this)){return this.T.subarray(c,c+b)}}
class sh extends rh{constructor(a,b,c,d){super(new Uint8Array(0),b,c,d);this.sources=a}D(a,b){({offset:a}=qh(this));return 0>=b?new Uint8Array(0):Nc(this.sources[a])}ta(){var {offset:a}=qh(this);return z(Uint8Array,z(Int32Array,this.sources[a]))}Gb(a){var {offset:b}=qh(this);return z(Uint8Array,z(a.ArrayType,this.sources[b]))}I(a,{offset:b}=qh(this)){const c=this.sources;return J.isTimestamp(a)||(J.isInt(a)||J.isTime(a))&&64===a.bitWidth||J.isDate(a)&&a.unit===Rb.MILLISECOND?z(Uint8Array,nh.convertArray(c[b])):
J.isDecimal(a)?z(Uint8Array,oh.convertArray(c[b])):J.isBinary(a)||J.isFixedSizeBinary(a)?th(c[b]):J.isBool(a)?Nc(c[b]):J.isUtf8(a)?Xa.encode(c[b].join("")):z(Uint8Array,z(a.ArrayType,c[b].map(d=>+d)))}}function th(a){a=a.join("");const b=new Uint8Array(a.length/2);for(let c=0;c<a.length;c+=2)b[c>>1]=parseInt(a.substr(c,2),16);return b};const uh=Symbol.for("parent"),vh=Symbol.for("rowIndex"),wh=Symbol.for("keyToIdx"),xh=Symbol.for("idxToVal"),yh=Symbol.for("nodejs.util.inspect.custom");
class zh{constructor(a,b){this[uh]=a;this.size=b}entries(){return this[Symbol.iterator]()}has(a){return void 0!==this.get(a)}get(a){let b=void 0;if(null!=a){const c=this[wh]||(this[wh]=new Map);let d=c.get(a);void 0!==d?(a=this[xh]||(this[xh]=Array(this.size)),void 0!==(b=a[d])||(a[d]=b=this.getValue(d))):-1<(d=this.Bb(a))&&(c.set(a,d),a=this[xh]||(this[xh]=Array(this.size)),void 0!==(b=a[d])||(a[d]=b=this.getValue(d)))}return b}set(a,b){if(null!=a){const c=this[wh]||(this[wh]=new Map);let d=c.get(a);
void 0===d&&c.set(a,d=this.Bb(a));-1<d&&((this[xh]||(this[xh]=Array(this.size)))[d]=this.setValue(d,b))}return this}clear(){throw Error(`Clearing ${this[Symbol.toStringTag]} not supported.`);}delete(){throw Error(`Deleting ${this[Symbol.toStringTag]} values not supported.`);}*[Symbol.iterator](){const a=this.keys(),b=this.values(),c=this[wh]||(this[wh]=new Map),d=this[xh]||(this[xh]=Array(this.size));for(let e,f,h=0,k,n;!(k=a.next()).done&&!(n=b.next()).done;++h)e=k.value,f=n.value,d[h]=f,c.has(e)||
c.set(e,h),yield[e,f]}forEach(a,b){const c=this.keys(),d=this.values(),e=void 0===b?a:(k,n,p)=>a.call(b,k,n,p),f=this[wh]||(this[wh]=new Map),h=this[xh]||(this[xh]=Array(this.size));for(let k,n,p=0,u,Z;!(u=c.next()).done&&!(Z=d.next()).done;++p)k=u.value,n=Z.value,h[p]=n,f.has(k)||f.set(k,p),e(n,k,this)}toArray(){return[...this.values()]}toJSON(){const a={};this.forEach((b,c)=>a[c]=b);return a}[yh](){return this.toString()}toString(){const a=[];this.forEach((b,c)=>{c=Oe(c);b=Oe(b);a.push(`${c}: ${b}`)});
return`{ ${a.join(", ")} }`}}var Ah=Symbol.toStringTag,Bh,Ch=zh.prototype;Object.defineProperties(Ch,{size:{writable:!0,enumerable:!1,configurable:!1,value:0},[uh]:{writable:!0,enumerable:!1,configurable:!1,value:null},[vh]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});Bh=Ch[Symbol.toStringTag]="Row";zh[Ah]=Bh;
class Dh extends zh{constructor(a){super(a,a.length);return Eh(this)}keys(){return this[uh].getChildAt(0)[Symbol.iterator]()}values(){return this[uh].getChildAt(1)[Symbol.iterator]()}getKey(a){return this[uh].getChildAt(0).get(a)}Bb(a){return this[uh].getChildAt(0).indexOf(a)}getValue(a){return this[uh].getChildAt(1).get(a)}setValue(a,b){this[uh].getChildAt(1).set(a,b)}}
class Fh extends zh{constructor(a){super(a,a.type.children.length);return Gh(this)}*keys(){for(const a of this[uh].type.children)yield a.name}*values(){for(const a of this[uh].type.children)yield this[a.name]}getKey(a){return this[uh].type.children[a].name}Bb(a){return this[uh].type.children.findIndex(b=>b.name===a)}getValue(a){return this[uh].getChildAt(a).get(this[vh])}setValue(a,b){return this[uh].getChildAt(a).set(this[vh],b)}}Object.setPrototypeOf(zh.prototype,Map.prototype);
const Gh=(()=>{const a={enumerable:!0,configurable:!1,get:null,set:null};return b=>{let c=-1;const d=b[wh]||(b[wh]=new Map),e=h=>function(){return this.get(h)},f=h=>function(k){return this.set(h,k)};for(const h of b.keys())d.set(h,++c),a.get=e(h),a.set=f(h),Object.prototype.hasOwnProperty.call(b,h)||(a.enumerable=!0,Object.defineProperty(b,h,a)),Object.prototype.hasOwnProperty.call(b,c)||(a.enumerable=!1,Object.defineProperty(b,c,a));a.get=a.set=null;return b}})(),Eh=(()=>{if("undefined"===typeof Proxy)return Gh;
const a=zh.prototype.has,b=zh.prototype.get,c=zh.prototype.set,d=zh.prototype.getKey,e={isExtensible(){return!1},deleteProperty(){return!1},preventExtensions(){return!0},ownKeys(f){return[...f.keys()].map(h=>`${h}`)},has(f,h){switch(h){case "getKey":case "getIndex":case "getValue":case "setValue":case "toArray":case "toJSON":case "inspect":case "constructor":case "isPrototypeOf":case "propertyIsEnumerable":case "toString":case "toLocaleString":case "valueOf":case "size":case "has":case "get":case "set":case "clear":case "delete":case "keys":case "values":case "entries":case "forEach":case "__proto__":case "__defineGetter__":case "__defineSetter__":case "hasOwnProperty":case "__lookupGetter__":case "__lookupSetter__":case Symbol.iterator:case Symbol.toStringTag:case uh:case vh:case xh:case wh:case yh:return!0}"number"!==
typeof h||f.has(h)||(h=f.getKey(h));return f.has(h)},get(f,h,k){switch(h){case "getKey":case "getIndex":case "getValue":case "setValue":case "toArray":case "toJSON":case "inspect":case "constructor":case "isPrototypeOf":case "propertyIsEnumerable":case "toString":case "toLocaleString":case "valueOf":case "size":case "has":case "get":case "set":case "clear":case "delete":case "keys":case "values":case "entries":case "forEach":case "__proto__":case "__defineGetter__":case "__defineSetter__":case "hasOwnProperty":case "__lookupGetter__":case "__lookupSetter__":case Symbol.iterator:case Symbol.toStringTag:case uh:case vh:case xh:case wh:case yh:return Reflect.get(f,
h,k)}"number"!==typeof h||a.call(k,h)||(h=d.call(k,h));return b.call(k,h)},set(f,h,k,n){switch(h){case uh:case vh:case xh:case wh:return Reflect.set(f,h,k,n);case "getKey":case "getIndex":case "getValue":case "setValue":case "toArray":case "toJSON":case "inspect":case "constructor":case "isPrototypeOf":case "propertyIsEnumerable":case "toString":case "toLocaleString":case "valueOf":case "size":case "has":case "get":case "set":case "clear":case "delete":case "keys":case "values":case "entries":case "forEach":case "__proto__":case "__defineGetter__":case "__defineSetter__":case "hasOwnProperty":case "__lookupGetter__":case "__lookupSetter__":case Symbol.iterator:case Symbol.toStringTag:return!1}"number"!==
typeof h||a.call(n,h)||(h=d.call(n,h));return a.call(n,h)?!!c.call(n,h,k):!1}};return f=>new Proxy(f,e)})();let Hh;function Ih(a,b,c,d){const {length:e=0}=a;b="number"!==typeof b?0:b;c="number"!==typeof c?e:c;0>b&&(b=(b%e+e)%e);0>c&&(c=(c%e+e)%e);c<b&&(Hh=b,b=c,c=Hh);c>e&&(c=e);return d?d(a,b,c):[b,c]}const Jh=fb?eb(0):0,Kh=a=>a!==a;
function Lh(a){const b=typeof a;if("object"!==b||null===a)return a!==a?Kh:"bigint"!==b?c=>c===a:c=>Jh+c===a;if(a instanceof Date){const c=a.valueOf();return d=>d instanceof Date?d.valueOf()===c:!1}return ArrayBuffer.isView(a)?c=>c?vb(a,c):!1:a instanceof Map?Mh(a):Array.isArray(a)?Nh(a):a instanceof B?Oh(a):Ph(a)}function Nh(a){const b=[];for(let c=-1,d=a.length;++c<d;)b[c]=Lh(a[c]);return Qh(b)}function Mh(a){let b=-1;const c=[];a.forEach(d=>c[++b]=Lh(d));return Qh(c)}
function Oh(a){const b=[];for(let c=-1,d=a.length;++c<d;)b[c]=Lh(a.get(c));return Qh(b)}function Ph(a){const b=Object.keys(a);if(0===b.length)return()=>!1;const c=[];for(let d=-1,e=b.length;++d<e;)c[d]=Lh(a[b[d]]);return Qh(c,b)}
function Qh(a,b){return c=>{if(!c||"object"!==typeof c)return!1;switch(c.constructor){case Array:a:{var d=a.length;if(c.length!==d)c=!1;else{for(var e=-1;++e<d;)if(!a[e](c[e])){c=!1;break a}c=!0}}return c;case Map:case Dh:case Fh:return Rh(a,c,c.keys());case Object:case void 0:return Rh(a,c,b||Object.keys(c))}if(c instanceof B)a:if(d=a.length,c.length!==d)c=!1;else{for(e=-1;++e<d;)if(!a[e](c.get(e))){c=!1;break a}c=!0}else c=!1;return c}}
function Rh(a,b,c){c=c[Symbol.iterator]();const d=b instanceof Map?b.keys():Object.keys(b)[Symbol.iterator]();b=b instanceof Map?b.values():Object.values(b)[Symbol.iterator]();let e=0;const f=a.length;let h=b.next(),k=c.next(),n=d.next();for(;e<f&&!k.done&&!n.done&&!h.done&&k.value===n.value&&a[e](h.value);++e,k=c.next(),n=d.next(),h=b.next());if(e===f&&k.done&&n.done&&h.done)return!0;c.return&&c.return();d.return&&d.return();b.return&&b.return();return!1}
var Sh={clampIndex:function(a,b,c){const d=a.length;b=-1<b?b:d+b%d;return c?c(a,b):b}};Sh.clampRange=Ih;Sh.createElementComparator=Lh;const Th=Array.isArray;function Uh(a){return ArrayBuffer.isView(a)&&"BYTES_PER_ELEMENT"in a}function Vh(a){switch(a){case Int8Array:return ad;case Int16Array:return bd;case Int32Array:return cd;case BigInt64Array:return dd;case Uint8Array:return ed;case Uint16Array:return fd;case Uint32Array:return gd;case BigUint64Array:return hd;case Float32Array:return nd;case Float64Array:return od;default:return null}}
const Xh=a=>{const [b,c]=Wh(a,[[],[]]);return c.map((d,e)=>{if(d instanceof Q)var f=Q.new(d.field.clone(b[e]),d);else if(d instanceof B)f=Q.new(b[e],d);else if(Uh(d)){f=Q;var h=f.new;e=b[e];var k=Vh(d.constructor);if(!k)throw new TypeError("Unrecognized Array input");k=new k;d=K.new(k,0,d.length,0,[void 0,d]);d=B.new(d);f=h.call(f,e,d)}else f=Q.new(b[e],[]);return f})};
function Yh(a,b,c,d){let e,f=-1;const h=b.length;for(;++f<h;)Th(e=b[f])?d=Yh(a,e,c,d).length:e instanceof a&&(c[d++]=e);return c}function Zh(a,b,c,d){let e,f=-1;const h=b.length;for(;++f<h;)Th(e=b[f])?d=Zh(a,e,c,d).length:e instanceof $h?d=Zh(a,e.chunks,c,d).length:e instanceof a&&(c[d++]=e);return c}
function ai(a,b,c,d){let e,f=-1;const h=b.length;for(;++f<h;)Th(e=b[f])?d=ai(a,e,c,d).length:e instanceof a?d=Yh(B,e.schema.fields.map((k,n)=>e.getChildAt(n)),c,d).length:e instanceof B&&(c[d++]=e);return c}function bi(a,b,c,d){let e,f=-1;const h=b.length;for(;++f<h;)Th(e=b[f])?d=bi(a,e,c,d).length:e instanceof a?d=Yh(Q,e.schema.fields.map((k,n)=>Q.new(k,e.getChildAt(n))),c,d).length:e instanceof Q&&(c[d++]=e);return c}const ci=(a,b,c)=>{var [d,e]=b;return a[0][c]=d,a[1][c]=e,a};
function Wh(a,b){let c;var d;switch(d=a.length){case 0:return b;case 1:c=b[0];if(!a[0])return b;if(Th(a[0]))return Wh(a[0],b);a[0]instanceof K||a[0]instanceof B||Uh(a[0])||a[0]instanceof J||([c,a]=Object.entries(a[0]).reduce(ci,b));break;default:Th(c=a[d-1])?a=Th(a[0])?a[0]:a.slice(0,d-1):(a=Th(a[0])?a[0]:a,c=[])}let e=d=-1,f=-1;const h=a.length;let k,n;const [p,u]=b;for(;++f<h;)if(n=a[f],n instanceof Q&&(u[++e]=n))p[++d]=n.field.clone(c[f],n.type,!0);else if({[f]:k=f}=c,n instanceof J&&(u[++e]=n))p[++d]=
N.new(k,n,!0);else{let Z;(null==(Z=n)?0:Z.type)&&(u[++e]=n)&&(n instanceof K&&(u[e]=n=B.new(n)),p[++d]=N.new(k,n.type,!0))}return b};class di{constructor(a){this.chunks=a;this.Ya=0;this.Zb=this.chunks[this.Ya][Symbol.iterator]()}next(){for(;this.Ya<this.chunks.length;){const a=this.Zb.next();if(!a.done)return a;++this.Ya<this.chunks.length&&(this.Zb=this.chunks[this.Ya][Symbol.iterator]())}return{done:!0,value:null}}[Symbol.iterator](){return this}}
class $h extends B{constructor(a,b=[],c=ei(b)){super();this.ga=-1;this.U=a;this.o=b;this.kb=c;this.Ba=c[c.length-1];this.pb=(this.U.children||[]).length}static flatten(...a){return Zh(B,a,[],0)}static concat(...a){a=$h.flatten(...a);return new $h(a[0].type,a)}get type(){return this.U}get length(){return this.Ba}get chunks(){return this.o}get typeId(){return this.U.typeId}get VectorName(){return`Chunked<${this.U}>`}get data(){return this.o[0]?this.o[0].data:null}get ArrayType(){return this.U.ArrayType}get numChildren(){return this.pb}get stride(){return this.o[0]?
this.o[0].stride:1}get byteLength(){return this.o.reduce((a,b)=>a+b.byteLength,0)}get nullCount(){let a=this.ga;0>a&&(this.ga=a=this.o.reduce((b,{nullCount:c})=>b+c,0));return a}get indices(){if(J.isDictionary(this.U)){if(!this.Qb){const a=this.o;this.Qb=1===a.length?a[0].indices:$h.concat(...a.map(b=>b.indices))}return this.Qb}return null}get dictionary(){return J.isDictionary(this.U)?this.o[this.o.length-1].data.dictionary:null}[Symbol.iterator](){return new di(this.o)}clone(a=this.o){return new $h(this.U,
a)}concat(...a){return this.clone($h.flatten(this,...a))}slice(a,b){return Ih(this,a,b,this.tb)}getChildAt(a){if(0>a||a>=this.pb)return null;const b=this.S||(this.S=[]);var c;let d;if(c=b[a])return c;if(c=(this.U.children||[])[a])if(d=this.o.map(e=>e.getChildAt(a)).filter(e=>null!=e),0<d.length)return b[a]=new $h(c.type,d);return null}search(a,b){const c=this.kb;let d=c.length-1;if(0>a||a>=c[d])return null;if(1>=d)return b?b(this,0,a):[0,a];let e=0,f=0,h;do{if(e+1===d)return b?b(this,e,a-f):[e,a-
f];h=e+(d-e)/2|0;a>=c[h]?e=h:d=h}while(a<c[d]&&a>=(f=c[e]));return null}isValid(a){return!!this.search(a,this.isValidInternal)}get(a){return this.search(a,this.getInternal)}set(a,b){this.search(a,({chunks:c},d,e)=>c[d].set(e,b))}indexOf(a,b){return b&&"number"===typeof b?this.search(b,(c,d,e)=>this.indexOfInternal(c,d,e,a)):this.indexOfInternal(this,0,Math.max(0,b||0),a)}toArray(){var a=this.chunks;const b=a.length;var c=this.U.ArrayType;if(0>=b)return new c(0);if(1>=b)return a[0].toArray();let d=
0;const e=Array(b);for(let f=-1;++f<b;)d+=(e[f]=a[f].toArray()).length;c!==e[0].constructor&&(c=e[0].constructor);a=new c(d);c=c===Array?fi:gi;for(let f=-1,h=0;++f<b;)h=c(e[f],a,h);return a}getInternal({o:a},b,c){return a[b].get(c)}isValidInternal({o:a},b,c){return a[b].isValid(c)}indexOfInternal({o:a},b,c,d){--b;const e=a.length;var f=c;for(c=0;++b<e;){if(~(f=a[b].indexOf(d,f)))return c+f;f=0;c+=a[b].length}return-1}tb(a,b,c){const d=[],e=a.chunks,f=a.kb;for(let h=-1,k=e.length;++h<k;){const n=e[h],
p=n.length,u=f[h];if(u>=c)break;b>=u+p||(u>=b&&u+p<=c?d.push(n):d.push(n.slice(Math.max(0,b-u),Math.min(c-u,p))))}return a.clone(d)}}function ei(a){const b=new Uint32Array((a||[]).length+1);let c=b[0]=0;const d=b.length;for(let e=0;++e<d;)b[e]=c+=a[e-1].length;return b}const gi=(a,b,c)=>{b.set(a,c);return c+a.length},fi=(a,b,c)=>{for(let d=-1,e=a.length;++d<e;)b[c++]=a[d];return c};class Q extends $h{constructor(a,b=[],c){b=$h.flatten(...b);super(a.type,b,c);this.za=a;if(1===b.length&&!(this instanceof hi))return new hi(a,b[0],this.kb)}static new(...a){let [b,c,...d]=a;"string"===typeof b||b instanceof N||(c=b,b="");a=$h.flatten(Array.isArray(c)?[...c,...d]:c instanceof B?[c,...d]:[B.new(c,...d)]);"string"===typeof b?b=new N(b,a[0].data.type,!0):!b.nullable&&a.some(({nullCount:e})=>0<e)&&(b=b.clone({nullable:!0}));return new Q(b,a)}get field(){return this.za}get name(){return this.za.name}get nullable(){return this.za.nullable}get metadata(){return this.za.metadata}clone(a=
this.o){return new Q(this.za,a)}getChildAt(a){if(0>a||a>=this.numChildren)return null;const b=this.S||(this.S=[]);var c;let d;if(c=b[a])return c;if(c=(this.type.children||[])[a])if(d=this.o.map(e=>e.getChildAt(a)).filter(e=>null!=e),0<d.length)return b[a]=new Q(c,d);return null}}
class hi extends Q{constructor(a,b,c){super(a,[b],c);this.Pa=b}search(a,b){return b?b(this,0,a):[0,a]}isValid(a){return this.Pa.isValid(a)}get(a){return this.Pa.get(a)}set(a,b){this.Pa.set(a,b)}indexOf(a,b){return this.Pa.indexOf(a,b)}};class ii extends ng{visit(a,b){return null==a||null==b?void 0:super.visit(a,b)}visitNull(a,b){r(b,0);return t(b)}visitInt(a,b){r(b,2);Ga(b,0,a.bitWidth,0);Ea(b,1,+a.isSigned,0);return t(b)}visitFloat(a,b){r(b,1);Fa(b,a.precision,Pb.HALF);return t(b)}visitBinary(a,b){r(b,0);return t(b)}visitBool(a,b){r(b,0);return t(b)}visitUtf8(a,b){r(b,0);return t(b)}visitDecimal(a,b){r(b,3);Ga(b,1,a.scale,0);Ga(b,0,a.precision,0);return t(b)}visitDate(a,b){r(b,1);Fa(b,a.unit,Rb.MILLISECOND);return t(b)}visitTime(a,
b){r(b,2);Fa(b,a.unit,C.MILLISECOND);Ga(b,1,a.bitWidth,32);return t(b)}visitTimestamp(a,b){const c=a.timezone&&Na(b,a.timezone)||void 0;r(b,2);Fa(b,a.unit,C.SECOND);void 0!==c&&q(b,1,c);return t(b)}visitInterval(a,b){r(b,1);Fa(b,a.unit,Ub.YEAR_MONTH);return t(b)}visitList(a,b){r(b,0);return t(b)}visitStruct(a,b){r(b,0);return t(b)}visitUnion(a,b){La(b,4,a.typeIds.length,4);var c=a.typeIds;La(b,4,c.length,4);for(let d=c.length-1;0<=d;d--)Da(b,c[d]);c=Ma(b);r(b,2);Fa(b,a.mode,Nb.Sparse);q(b,1,c);return t(b)}visitDictionary(a,
b){const c=this.visit(a.indices,b);r(b,4);Ha(b,0,new va(a.id,0),b.W(0,0));Ea(b,2,+a.isOrdered,0);void 0!==c&&q(b,1,c);return t(b)}visitFixedSizeBinary(a,b){r(b,1);Ga(b,0,a.byteWidth,0);return t(b)}visitFixedSizeList(a,b){r(b,1);Ga(b,0,a.listSize,0);return t(b)}visitMap(a,b){r(b,1);Ea(b,0,+a.keysSorted,0);return t(b)}}const ji=new ii;function ki(a){return new li(a.count,mi(a.columns),ni(a.columns))}function oi(a,b){return(a.fields||[]).filter(Boolean).map(c=>N.fromJSON(c,b))}function pi(a,b){return(a.children||[]).filter(Boolean).map(c=>N.fromJSON(c,b))}function mi(a){return(a||[]).reduce((b,c)=>[...b,new qi(c.count,ri(c.VALIDITY)),...mi(c.children)],[])}
function ni(a,b=[]){for(let c=-1,d=(a||[]).length;++c<d;){const e=a[c];e.VALIDITY&&b.push(new si(b.length,e.VALIDITY.length));e.TYPE&&b.push(new si(b.length,e.TYPE.length));e.OFFSET&&b.push(new si(b.length,e.OFFSET.length));e.DATA&&b.push(new si(b.length,e.DATA.length));b=ni(e.children,b)}return b}function ri(a){return(a||[]).reduce((b,c)=>b+ +(0===c),0)}function ti(a){return new Xc(a.isSigned,a.bitWidth)}
function ui(a,b){const c=a.type.name;switch(c){case "NONE":return new Wc;case "null":return new Wc;case "binary":return new pd;case "utf8":return new td;case "bool":return new xd;case "list":return new ge((b||[])[0]);case "struct":return new ke(b||[]);case "struct_":return new ke(b||[])}switch(c){case "int":return b=a.type,new Xc(b.isSigned,b.bitWidth);case "floatingpoint":return new id(Pb[a.type.precision]);case "decimal":return b=a.type,new Bd(b.scale,b.precision);case "date":return new Fd(Rb[a.type.unit]);
case "time":return b=a.type,new Ld(C[b.unit],b.bitWidth);case "timestamp":return b=a.type,new Td(C[b.unit],b.timezone);case "interval":return new ae(Ub[a.type.unit]);case "union":return a=a.type,new oe(Nb[a.mode],a.typeIds||[],b||[]);case "fixedsizebinary":return new ue(a.type.byteWidth);case "fixedsizelist":return new ye(a.type.listSize,(b||[])[0]);case "map":return new Ce((b||[])[0],a.type.keysSorted)}throw Error(`Unrecognized type: "${c}"`);};class vi{constructor(a,b,c,d){this.rc=b;this.nc=c;this.body=new Uint8Array(0);d&&(this.mb=()=>d);this.ic="number"===typeof a?a:a.low}static fromJSON(a,b){const c=new vi(0,Hb.V4,b);c.mb=wi(a,b);return c}static decode(a){a=new ya(z(Uint8Array,a));a=(new Hc).i(a.v(a.position())+a.position(),a);var b=a.bodyLength();const c=a.version(),d=a.headerType();b=new vi(b,c,d);b.mb=xi(a,d);return b}static encode(a){const b=new xa;let c=-1;a.isSchema()?c=M.encode(b,a.header()):a.isRecordBatch()?c=li.encode(b,a.header()):
a.isDictionaryBatch()&&(c=yi.encode(b,a.header()));r(b,5);Fa(b,Hb.V4,Hb.V1);q(b,2,c);Ea(b,1,a.headerType,F.NONE);Ha(b,3,new va(a.bodyLength,0),b.W(0,0));a=t(b);b.finish(a);return za(b)}static from(a,b=0){if(a instanceof M)return new vi(0,Hb.V4,F.Schema,a);if(a instanceof li)return new vi(b,Hb.V4,F.RecordBatch,a);if(a instanceof yi)return new vi(b,Hb.V4,F.DictionaryBatch,a);throw Error(`Unrecognized Message header: ${a}`);}get type(){return this.headerType}get version(){return this.rc}get headerType(){return this.nc}get bodyLength(){return this.ic}header(){return this.mb()}isSchema(){return this.headerType===
F.Schema}isRecordBatch(){return this.headerType===F.RecordBatch}isDictionaryBatch(){return this.headerType===F.DictionaryBatch}}class li{constructor(a,b,c){this.ob=b;this.jb=c;this.Ba="number"===typeof a?a:a.low}get N(){return this.ob}get length(){return this.Ba}get buffers(){return this.jb}}
class yi{constructor(a,b,c=!1){this.kc=a;this.pc=c;this.oc="number"===typeof b?b:b.low}get id(){return this.oc}get data(){return this.kc}get cb(){return this.pc}get length(){return this.data.length}get N(){return this.data.N}get buffers(){return this.data.buffers}}class si{constructor(a,b){this.offset="number"===typeof a?a:a.low;this.length="number"===typeof b?b:b.low}}class qi{constructor(a,b){this.length="number"===typeof a?a:a.low;this.nullCount="number"===typeof b?b:b.low}}
function wi(a,b){return()=>{switch(b){case F.Schema:return M.fromJSON(a);case F.RecordBatch:return li.fromJSON(a);case F.DictionaryBatch:return yi.fromJSON(a)}throw Error(`Unrecognized Message type: { name: ${F[b]}, type: ${b} }`);}}
function xi(a,b){return()=>{switch(b){case F.Schema:return M.decode(a.header(new vc));case F.RecordBatch:return li.decode(a.header(new Fc),a.version());case F.DictionaryBatch:return yi.decode(a.header(new Gc),a.version())}throw Error(`Unrecognized Message type: { name: ${F[b]}, type: ${b} }`);}}N.encode=zi;N.decode=Ai;
N.fromJSON=function(a,b){var c;let d,e;b&&(e=a.dictionary)?(b.has(c=e.id)?(d=(d=e.indexType)?ti(d):new cd,c=new He(b.get(c),d,c,e.isOrdered)):(d=(d=e.indexType)?ti(d):new cd,b.set(c,b=ui(a,pi(a,b))),c=new He(b,d,c,e.isOrdered)),a=new N(a.name,c,a.nullable,new Map(Object.entries(a.customMetadata||{})))):(b=ui(a,pi(a,b)),a=new N(a.name,b,a.nullable,new Map(Object.entries(a.customMetadata||{}))));return a||null};M.encode=Bi;M.decode=Ci;
M.fromJSON=function(a,b=new Map){return new M(oi(a,b),new Map(Object.entries(a.customMetadata||{})),b)};li.encode=Di;li.decode=Ei;li.fromJSON=ki;yi.encode=Fi;yi.decode=Gi;yi.fromJSON=function(a){return new yi(ki(a.data),a.id,a.isDelta)};qi.encode=Hi;qi.decode=Ii;si.encode=Ji;si.decode=Ki;function Ci(a,b=new Map){const c=[];for(let d,e=-1,f=-1,h=uc(a);++e<h;)if(d=a.fields(e))c[++f]=N.decode(d,b);return new M(c,Li(a),b)}
function Ei(a,b=Hb.V4){var c=a.length();const d=[];for(let f,h=-1,k=-1,n=Dc(a);++h<n;)if(f=a.N(h))d[++k]=qi.decode(f);const e=[];for(let f,h=-1,k=-1,n=Ec(a);++h<n;)if(f=a.buffers(h))b<Hb.V4&&(f.h+=8*(h+1)),e[++k]=si.decode(f);return new li(c,d,e)}function Gi(a,b=Hb.V4){return new yi(li.decode(a.data(),b),a.id(),a.cb())}function Ki(a){return new si(a.offset(),a.length())}function Ii(a){return new qi(a.length(),a.nullCount())}
function Mi(a,b){const c=[];for(let d,e=-1,f=-1,h=pc(a);++e<h;)if(d=a.children(e))c[++f]=N.decode(d,b);return c}function Ai(a,b){var c;let d,e;b&&(e=a.dictionary())?(b.has(c=e.id().low)?(d=(d=lc(e))?Ni(d):new cd,c=new He(b.get(c),d,c,e.isOrdered())):(d=(d=lc(e))?Ni(d):new cd,b.set(c,b=Oi(a,Mi(a,b))),c=new He(b,d,c,e.isOrdered())),a=new N(a.name(),c,a.nullable(),Li(a))):(b=Oi(a,Mi(a,b)),a=new N(a.name(),b,a.nullable(),Li(a)));return a||null}
function Li(a){const b=new Map;if(a)for(let c,d,e=-1,f=a.ab()|0;++e<f;)(c=a.$a(e))&&null!=(d=c.key())&&b.set(d,c.value());return b}function Ni(a){return new Xc(a.isSigned(),a.bitWidth())}
function Oi(a,b){var c=(c=v(a.g,a.h,8))?a.g.m[a.h+c]:D.NONE;switch(c){case D.NONE:return new Wc;case D.Null:return new Wc;case D.Binary:return new pd;case D.Utf8:return new td;case D.Bool:return new xd;case D.List:return new ge((b||[])[0]);case D.Struct_:return new ke(b||[])}switch(c){case D.Int:return b=a.type(new cc),new Xc(b.isSigned(),b.bitWidth());case D.FloatingPoint:return b=a.type(new dc),new id(b.precision());case D.Decimal:return b=a.type(new fc),new Bd(b.scale(),b.precision());case D.Date:return b=
a.type(new gc),new Fd(b.unit());case D.Time:return b=a.type(new hc),new Ld(b.unit(),b.bitWidth());case D.Timestamp:return b=a.type(new ic),new Td(b.unit(),b.timezone());case D.Interval:return b=a.type(new jc),new ae(b.unit());case D.Union:c=a.type(new bc);a=c.mode();const d=v(c.g,c.h,6);c=d?new Int32Array(c.g.T().buffer,c.g.T().byteOffset+Ta(c.g,c.h+d),Ua(c.g,c.h+d)):null;return new oe(a,c||[],b||[]);case D.FixedSizeBinary:return b=a.type(new ec),new ue(b.byteWidth());case D.FixedSizeList:return a=
a.type(new $b),new ye(a.listSize(),(b||[])[0]);case D.Map:return a=a.type(new ac),new Ce((b||[])[0],a.keysSorted())}throw Error(`Unrecognized type: "${D[c]}" (${c})`);}function Bi(a,b){var c=b.fields.map(d=>N.encode(a,d));La(a,4,c.length,4);c=sc(a,c);b=b.metadata&&0<b.metadata.size?tc(a,[...b.metadata].map(([d,e])=>{d=Na(a,`${d}`);e=Na(a,`${e}`);r(a,2);q(a,0,d);q(a,1,e);return t(a)})):-1;r(a,4);q(a,1,c);Fa(a,Pi?Yb.fc:Yb.Cc,Yb.fc);-1!==b&&q(a,2,b);return t(a)}
function zi(a,b){let c=-1,d=-1,e=-1;var f=b.type;let h=b.typeId;J.isDictionary(f)?(h=f.dictionary.typeId,e=ji.visit(f,a),d=ji.visit(f.dictionary,a)):d=ji.visit(f,a);f=(f.children||[]).map(n=>N.encode(a,n));f=nc(a,f);const k=b.metadata&&0<b.metadata.size?oc(a,[...b.metadata].map(([n,p])=>{n=Na(a,`${n}`);p=Na(a,`${p}`);r(a,2);q(a,0,n);q(a,1,p);return t(a)})):-1;b.name&&(c=Na(a,b.name));r(a,7);q(a,3,d);Ea(a,2,h,D.NONE);q(a,5,f);Ea(a,1,+!!b.nullable,0);-1!==c&&q(a,0,c);-1!==e&&q(a,4,e);-1!==k&&q(a,6,
k);return t(a)}function Di(a,b){var c=b.N||[],d=b.buffers||[];La(a,16,c.length,8);c.slice().reverse().forEach(e=>qi.encode(a,e));c=Ma(a);La(a,16,d.length,8);d.slice().reverse().forEach(e=>si.encode(a,e));d=Ma(a);r(a,4);Cc(a,new va(b.length,0));q(a,1,c);q(a,2,d);return t(a)}function Fi(a,b){const c=li.encode(a,b.data);r(a,3);Ha(a,0,new va(b.id,0),a.W(0,0));Ea(a,2,+b.cb,0);q(a,1,c);return t(a)}
function Hi(a,b){var c=new va(b.length,0);b=new va(b.nullCount,0);Aa(a,8,16);a.da(b);a.da(c);return a.offset()}function Ji(a,b){var c=new va(b.offset,0);b=new va(b.length,0);Aa(a,8,16);a.da(b);a.da(c);return a.offset()}const Qi=new ArrayBuffer(2);(new DataView(Qi)).setInt16(0,256,!0);const Pi=256===(new Int16Array(Qi))[0];const Ri=a=>`Expected ${F[a]} Message in stream, but was null or length 0.`,Si=a=>`Header pointer of flatbuffer-encoded ${F[a]} Message is null or length 0.`,Ti=(a,b)=>`Expected to read ${a} metadata bytes, but only read ${b}.`,Ui=(a,b)=>`Expected to read ${a} bytes for message body, but only read ${b}.`;
class Vi{constructor(a){this.source=a instanceof ch?a:new ch(a)}[Symbol.iterator](){return this}next(){let a;return(a=this.readMetadataLength()).done||-1===a.value&&(a=this.readMetadataLength()).done||(a=this.readMetadata(a.value)).done?w:a}throw(a){return this.source.throw(a)}return(a){return this.source.return(a)}readMessage(a){let b;if((b=this.next()).done)return null;if(null!=a&&b.value.headerType!==a)throw Error(Ri(a));return b.value}readMessageBody(a){if(0>=a)return new Uint8Array(0);const b=
z(Uint8Array,this.source.read(a));if(b.byteLength<a)throw Error(Ui(a,b.byteLength));return 0===b.byteOffset%8&&b.byteOffset+b.byteLength<=b.buffer.byteLength?b:b.slice()}readSchema(a){a=void 0===a?!1:a;const b=F.Schema;let c;const d=null==(c=this.readMessage(b))?void 0:c.header();if(a&&!d)throw Error(Si(b));return d}readMetadataLength(){var a=this.source.read(4);let b;a=(null==(b=a&&new ya(a))?void 0:b.v(0))||0;return{done:0===a,value:a}}readMetadata(a){const b=this.source.read(a);if(!b)return w;
if(b.byteLength<a)throw Error(Ti(a,b.byteLength));return{done:!1,value:vi.decode(b)}}}
class Wi{constructor(a,b){this.source=a instanceof eh?a:y(a)&&x(a.stat)&&"number"===typeof a.fd?new hh(a,b):new eh(a)}[Symbol.asyncIterator](){return this}next(){const a=this;return l(function*(){let b;return(b=yield a.readMetadataLength()).done||-1===b.value&&(b=yield a.readMetadataLength()).done||(b=yield a.readMetadata(b.value)).done?w:b})}throw(a){const b=this;return l(function*(){return yield b.source.throw(a)})}return(a){const b=this;return l(function*(){return yield b.source.return(a)})}readMessage(a){const b=
this;return l(function*(){let c;if((c=yield b.next()).done)return null;if(null!=a&&c.value.headerType!==a)throw Error(Ri(a));return c.value})}readMessageBody(a){const b=this;return l(function*(){if(0>=a)return new Uint8Array(0);const c=z(Uint8Array,yield b.source.read(a));if(c.byteLength<a)throw Error(Ui(a,c.byteLength));return 0===c.byteOffset%8&&c.byteOffset+c.byteLength<=c.buffer.byteLength?c:c.slice()})}readSchema(a){a=void 0===a?!1:a;const b=this;return l(function*(){const c=F.Schema;let d;const e=
null==(d=yield b.readMessage(c))?void 0:d.header();if(a&&!e)throw Error(Si(c));return e})}readMetadataLength(){const a=this;return l(function*(){var b=yield a.source.read(4);let c;b=(null==(c=b&&new ya(b))?void 0:c.v(0))||0;return{done:0===b,value:b}})}readMetadata(a){const b=this;return l(function*(){const c=yield b.source.read(a);if(!c)return w;if(c.byteLength<a)throw Error(Ti(a,c.byteLength));return{done:!1,value:vi.decode(c)}})}}
class Xi extends Vi{constructor(a){super(new Uint8Array(0));this.u=!1;this.Na=[];this.$=this.Mb=0;this.Aa=a instanceof Ya?a:new Ya(a)}next(){var a=this.Aa;if(!this.u)return this.u=!0,{done:!1,value:vi.fromJSON(a.schema,F.Schema)};if(this.$<a.dictionaries.length)return a=a.dictionaries[this.$++],this.Na=a.data.columns,{done:!1,value:vi.fromJSON(a,F.DictionaryBatch)};if(this.Mb<a.ha.length)return a=a.ha[this.Mb++],this.Na=a.columns,{done:!1,value:vi.fromJSON(a,F.RecordBatch)};this.Na=[];return w}readMessageBody(){function a(b){return(b||
[]).reduce((c,d)=>[...c,...(d.VALIDITY&&[d.VALIDITY]||[]),...(d.TYPE&&[d.TYPE]||[]),...(d.OFFSET&&[d.OFFSET]||[]),...(d.DATA&&[d.DATA]||[]),...a(d.children)],[])}return a(this.Na)}readMessage(a){let b;if((b=this.next()).done)return null;if(null!=a&&b.value.headerType!==a)throw Error(Ri(a));return b.value}readSchema(){const a=F.Schema,b=this.readMessage(a),c=null==b?void 0:b.header();if(!b||!c)throw Error(Si(a));return c}}const Yi=new Uint8Array(6);for(let a=0;6>a;a+=1)Yi[a]="ARROW1".charCodeAt(a);
function Zi(a){var b=void 0===b?0:b;for(let c=-1,d=Yi.length;++c<d;)if(Yi[c]!==a[b+c])return!1;return!0}const $i=Yi.length,aj=$i+4,bj=2*$i+4;function cj(a,b,c){return b===c||Array.isArray(b)&&Array.isArray(c)&&b.length===c.length&&b.every((d,e)=>a.compareFields(d,c[e]))}class dj extends ng{compareSchemas(a,b){return a===b||b instanceof a.constructor&&cj(this,a.fields,b.fields)}compareFields(a,b){return a===b||b instanceof a.constructor&&a.name===b.name&&a.nullable===b.nullable&&this.visit(a.type,b.type)}}function ej(a,b){return b instanceof a.constructor}function fj(a,b){return a===b||ej(a,b)}
function gj(a,b){return a===b||ej(a,b)&&a.bitWidth===b.bitWidth&&a.isSigned===b.isSigned}function hj(a,b){return a===b||ej(a,b)&&a.precision===b.precision}function ij(a,b){return a===b||ej(a,b)&&a.unit===b.unit}function jj(a,b){return a===b||ej(a,b)&&a.unit===b.unit&&a.timezone===b.timezone}function kj(a,b){return a===b||ej(a,b)&&a.unit===b.unit&&a.bitWidth===b.bitWidth}
function lj(a,b){return a===b||ej(a,b)&&a.mode===b.mode&&a.typeIds.every((c,d)=>c===b.typeIds[d])&&cj(mj,a.children,b.children)}function nj(a,b){return a===b||ej(a,b)&&a.unit===b.unit}g=dj.prototype;g.visitNull=fj;g.visitBool=fj;g.visitInt=gj;g.visitInt8=gj;g.visitInt16=gj;g.visitInt32=gj;g.visitInt64=gj;g.visitUint8=gj;g.visitUint16=gj;g.visitUint32=gj;g.visitUint64=gj;g.visitFloat=hj;g.visitFloat16=hj;g.visitFloat32=hj;g.visitFloat64=hj;g.visitUtf8=fj;g.visitBinary=fj;
g.visitFixedSizeBinary=function(a,b){return a===b||ej(a,b)&&a.byteWidth===b.byteWidth};g.visitDate=ij;g.visitDateDay=ij;g.visitDateMillisecond=ij;g.visitTimestamp=jj;g.visitTimestampSecond=jj;g.visitTimestampMillisecond=jj;g.visitTimestampMicrosecond=jj;g.visitTimestampNanosecond=jj;g.visitTime=kj;g.visitTimeSecond=kj;g.visitTimeMillisecond=kj;g.visitTimeMicrosecond=kj;g.visitTimeNanosecond=kj;g.visitDecimal=fj;
g.visitList=function(a,b){return a===b||ej(a,b)&&a.children.length===b.children.length&&cj(mj,a.children,b.children)};g.visitStruct=function(a,b){return a===b||ej(a,b)&&a.children.length===b.children.length&&cj(mj,a.children,b.children)};g.visitUnion=lj;g.visitDenseUnion=lj;g.visitSparseUnion=lj;g.visitDictionary=function(a,b){return a===b||ej(a,b)&&a.id===b.id&&a.isOrdered===b.isOrdered&&mj.visit(a.indices,b.indices)&&mj.visit(a.dictionary,b.dictionary)};g.visitInterval=nj;
g.visitIntervalDayTime=nj;g.visitIntervalYearMonth=nj;g.visitFixedSizeList=function(a,b){return a===b||ej(a,b)&&a.listSize===b.listSize&&a.children.length===b.children.length&&cj(mj,a.children,b.children)};g.visitMap=function(a,b){return a===b||ej(a,b)&&a.keysSorted===b.keysSorted&&a.children.length===b.children.length&&cj(mj,a.children,b.children)};const mj=new dj;function oj(a,b){return mj.compareSchemas(a,b)};class pj extends ng{constructor(){super();this.Oa=0;this.ob=[];this.jb=[];this.jc=[]}static Ha(...a){var b=new pj;a=ai(qj,a,[],0);[b=b]=b.visitMany(a);return b}visit(a){if(!J.isDictionary(a.type)){const b=a.data,c=a.length,d=a.nullCount;if(2147483647<c)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");J.isNull(a.type)||rj.call(this,0>=d?new Uint8Array(0):Mc(b.offset,c,b.nullBitmap));this.N.push(new qi(c,d))}return super.visit(a)}visitNull(){return this}visitDictionary(a){return this.visit(a.indices)}get N(){return this.ob}get buffers(){return this.jb}get byteLength(){return this.Oa}get Ab(){return this.jc}}
function rj(a){const b=a.byteLength+7&-8;this.buffers.push(a);this.Ab.push(new si(this.Oa,b));this.Oa+=b;return this}function sj(a){return rj.call(this,a.values.subarray(0,a.length*a.stride))}function tj(a){const b=a.length,c=a.values;a=a.valueOffsets;const d=a[0],e=Math.min(a[b]-d,c.byteLength-d);rj.call(this,ub(-a[0],b,a));rj.call(this,c.subarray(d,d+e));return this}function uj(a){const b=a.length,c=a.valueOffsets;c&&rj.call(this,ub(c[0],b,c));return this.visit(a.getChildAt(0))}
function vj(a){return this.visitMany(a.type.children.map((b,c)=>a.getChildAt(c)).filter(Boolean))[0]}g=pj.prototype;g.visitBool=function(a){let b;return a.nullCount>=a.length?rj.call(this,new Uint8Array(0)):(b=a.values)instanceof Uint8Array?rj.call(this,Mc(a.offset,a.length,b)):rj.call(this,Nc(a))};g.visitInt=sj;g.visitFloat=sj;g.visitUtf8=tj;g.visitBinary=tj;g.visitFixedSizeBinary=sj;g.visitDate=sj;g.visitTimestamp=sj;g.visitTime=sj;g.visitDecimal=sj;g.visitList=uj;g.visitStruct=vj;
g.visitUnion=function(a){const b=a.type,c=a.length;var d=a.typeIds,e=a.valueOffsets;rj.call(this,d);if(b.mode===Nb.Sparse)return vj.call(this,a);if(b.mode===Nb.Dense){if(0>=a.offset)return rj.call(this,e),vj.call(this,a);var f=d.reduce((n,p)=>Math.max(n,p),d[0]);const h=new Int32Array(f+1);f=(new Int32Array(f+1)).fill(-1);const k=new Int32Array(c);e=ub(-e[0],c,e);for(let n,p,u=-1;++u<c;)-1===(p=f[n=d[u]])&&(p=f[n]=e[n]),k[u]=e[u]-p,++h[n];rj.call(this,k);for(let n,p=-1,u=b.children.length;++p<u;)if(n=
a.getChildAt(p))d=b.typeIds[p],this.visit(n.slice(f[d],Math.min(c,h[d])))}return this};g.visitInterval=sj;g.visitFixedSizeList=uj;g.visitMap=uj;class wj extends ng{visit(a){return null==a?void 0:super.visit(a)}visitNull({typeId:a}){return{name:D[a].toLowerCase()}}visitInt({typeId:a,bitWidth:b,isSigned:c}){return{name:D[a].toLowerCase(),bitWidth:b,isSigned:c}}visitFloat({typeId:a,precision:b}){return{name:D[a].toLowerCase(),precision:Pb[b]}}visitBinary({typeId:a}){return{name:D[a].toLowerCase()}}visitBool({typeId:a}){return{name:D[a].toLowerCase()}}visitUtf8({typeId:a}){return{name:D[a].toLowerCase()}}visitDecimal({typeId:a,scale:b,precision:c}){return{name:D[a].toLowerCase(),
scale:b,precision:c}}visitDate({typeId:a,unit:b}){return{name:D[a].toLowerCase(),unit:Rb[b]}}visitTime({typeId:a,unit:b,bitWidth:c}){return{name:D[a].toLowerCase(),unit:C[b],bitWidth:c}}visitTimestamp({typeId:a,timezone:b,unit:c}){return{name:D[a].toLowerCase(),unit:C[c],timezone:b}}visitInterval({typeId:a,unit:b}){return{name:D[a].toLowerCase(),unit:Ub[b]}}visitList({typeId:a}){return{name:D[a].toLowerCase()}}visitStruct({typeId:a}){return{name:D[a].toLowerCase()}}visitUnion({typeId:a,mode:b,typeIds:c}){return{name:D[a].toLowerCase(),
mode:Nb[b],typeIds:[...c]}}visitDictionary(a){return this.visit(a.dictionary)}visitFixedSizeBinary({typeId:a,byteWidth:b}){return{name:D[a].toLowerCase(),byteWidth:b}}visitFixedSizeList({typeId:a,listSize:b}){return{name:D[a].toLowerCase(),listSize:b}}visitMap({typeId:a,keysSorted:b}){return{name:D[a].toLowerCase(),keysSorted:b}}};class xj extends ng{static Ha(...a){var b=new xj,c=b.visitMany;a=bi(qj,a,[],0);return c.call(b,a)}visit(a){const b=a.data,c=a.name,d=a.length,e=b.offset,f=b.nullCount,h=b.nullBitmap;a=J.isDictionary(a.type)?a.type.indices:a.type;const k=Object.assign([],b.buffers,{[I.VALIDITY]:void 0});return Object.assign({},{name:c,count:d,VALIDITY:J.isNull(a)?void 0:0>=f?Array.from({length:d},()=>1):[...(new Oc(h,e,d,null,Kc))]},super.visit(B.new(b.clone(a,e,d,0,k))))}visitNull(){return{}}visitBool(a){var {values:b,
offset:c,length:d}=a;return{DATA:[...(new Oc(b,c,d,null,Jc))]}}visitInt(a){return{DATA:64>a.type.bitWidth?[...a.values]:[...yj(a.values,2)]}}visitFloat(a){return{DATA:[...a.values]}}visitUtf8(a){return{DATA:[...a],OFFSET:[...a.valueOffsets]}}visitBinary(a){return{DATA:[...zj(a)],OFFSET:[...a.valueOffsets]}}visitFixedSizeBinary(a){return{DATA:[...zj(a)]}}visitDate(a){return{DATA:a.type.unit===Rb.DAY?[...a.values]:[...yj(a.values,2)]}}visitTimestamp(a){return{DATA:[...yj(a.values,2)]}}visitTime(a){return{DATA:a.type.unit<
C.MICROSECOND?[...a.values]:[...yj(a.values,2)]}}visitDecimal(a){return{DATA:[...yj(a.values,4)]}}visitList(a){return{OFFSET:[...a.valueOffsets],children:a.type.children.map((b,c)=>this.visit(new Q(b,[a.getChildAt(c)])))}}visitStruct(a){return{children:a.type.children.map((b,c)=>this.visit(new Q(b,[a.getChildAt(c)])))}}visitUnion(a){return{TYPE:[...a.typeIds],OFFSET:a.type.mode===Nb.Dense?[...a.valueOffsets]:void 0,children:a.type.children.map((b,c)=>this.visit(new Q(b,[a.getChildAt(c)])))}}visitInterval(a){return{DATA:[...a.values]}}visitFixedSizeList(a){return{children:a.type.children.map((b,
c)=>this.visit(new Q(b,[a.getChildAt(c)])))}}visitMap(a){return{OFFSET:[...a.valueOffsets],children:a.type.children.map((b,c)=>this.visit(new Q(b,[a.getChildAt(c)])))}}}function*zj(a){for(const b of a)yield b.reduce((c,d)=>`${c}${("0"+(d&255).toString(16)).slice(-2)}`,"").toUpperCase()}function*yj(a,b){for(let c=-1,d=a.length/b;++c<d;)yield`${Df.new(a.subarray((c+0)*b,(c+1)*b),!1)}`};function R(a,b){a.Ga&&(b=z(Uint8Array,b))&&0<b.byteLength&&(a.H.write(b),a.Ca+=b.byteLength);return a}function Aj(a,b){return 0<b?R(a,new Uint8Array(b)):a}function Bj(a,b){let c,d,e;for(let f=-1,h=b.length;++f<h;)(c=b[f])&&0<(d=c.byteLength)&&(R(a,c),0<(e=(d+7&-8)-d)&&Aj(a,e))}
class Cj extends ab{constructor(a){super();this.Ca=0;this.Ga=!1;this.H=new bh;this.u=null;this.ya=[];this.Sa=[];this.ka=new Map;y(a)||(a={autoDestroy:!0,cc:!1});this.La="boolean"===typeof a.autoDestroy?a.autoDestroy:!0;this.vb="boolean"===typeof a.cc?a.cc:!1}static throughNode(){throw Error('"throughNode" not available in this environment');}static throughDOM(){throw Error('"throughDOM" not available in this environment');}toString(a){return this.H.toString(void 0===a?!1:a)}toUint8Array(a){return this.H.toUint8Array(void 0===
a?!1:a)}writeAll(a){return y(a)&&x(a.then)?a.then(b=>this.writeAll(b)):jb(a)?Dj(this,a):Ej(this,a)}get closed(){return this.H.closed}[Symbol.asyncIterator](){return this.H[Symbol.asyncIterator]()}toDOMStream(a){return this.H.toDOMStream(a)}toNodeStream(a){return this.H.toNodeStream(a)}close(){return this.reset().H.close()}abort(a){return this.reset().H.abort(a)}finish(){this.La?this.close():this.reset(this.H,this.u);return this}reset(a,b){a=void 0===a?this.H:a;b=void 0===b?null:b;a===this.H||a instanceof
bh?this.H=a:(this.H=new bh,a&&y(a)&&x(a.abort)&&x(a.getWriter)&&!(a instanceof ab)?this.toDOMStream({type:"bytes"}).pipeTo(a):a&&y(a)&&x(a.end)&&x(a.write)&&"boolean"===typeof a.writable&&!(a instanceof ab)&&$a(this.toNodeStream({Ec:!1}),a));this.Ga&&this.u&&this.Va(this.u);this.Ga=!1;this.ya=[];this.Sa=[];this.ka=new Map;b&&oj(b,this.u)||(null===b?(this.Ca=0,this.u=null):(this.Ga=!0,this.u=b,this.wb(b)));return this}write(a){let b=null;if(this.H){if(null==a||a instanceof S&&!(b=a.schema)||a instanceof
qj&&!(b=a.schema))return this.finish()&&void 0}else throw Error("RecordBatchWriter is closed");if(b&&!oj(b,this.u)){if(this.Ga&&this.La)return this.close();this.reset(this.H,b)}a instanceof qj?a instanceof Fj||this.Wb(a):a instanceof S?this.writeAll(a.chunks):ib(a)&&this.writeAll(a)}Wa(a){const b=vi.encode(a),c=b.byteLength,d=this.vb?4:8,e=c+d+7&-8,f=e-c-d;a.headerType===F.RecordBatch?this.Sa.push(new ah(e,a.bodyLength,this.Ca)):a.headerType===F.DictionaryBatch&&this.ya.push(new ah(e,a.bodyLength,
this.Ca));this.vb||R(this,Int32Array.of(-1));R(this,Int32Array.of(e-d));0<c&&R(this,b);return Aj(this,f)}wb(a){this.Wa(vi.from(a))}Va(){return this.vb?R(this,Int32Array.of(0)):R(this,Int32Array.of(-1,0))}Wb(a){const {byteLength:b,N:c,Ab:d,buffers:e}=pj.Ha(a),f=vi.from(new li(a.length,c,d),b);Bj(this.Ua(a).Wa(f),e)}Vb(a,b,c){c=void 0===c?!1:c;this.ka.set(b,a.length+(this.ka.get(b)||0));const {byteLength:d,N:e,Ab:f,buffers:h}=pj.Ha(a);a=vi.from(new yi(new li(a.length,e,f),b,c),d);Bj(this.Wa(a),h)}Ua(a){for(let b of a.dictionaries){let [c,
d]=b;a=this.ka.get(c)||0;if(0===a||0<(d=d.slice(a)).length){const e="chunks"in d?d.chunks:[d];for(const f of e)this.Vb(f,c,0<a),a+=f.length}}return this}}class Gj extends Cj{static writeAll(a,b){const c=new Gj(b);return y(a)&&x(a.then)?a.then(d=>c.writeAll(d)):jb(a)?Dj(c,a):Ej(c,a)}}
class Hj extends Cj{static writeAll(a){const b=new Hj;return y(a)&&x(a.then)?a.then(c=>b.writeAll(c)):jb(a)?Dj(b,a):Ej(b,a)}constructor(){super();this.La=!0}wb(){Aj(R(this,Yi),2)}Va(a){const b=Zg.encode(new Zg(a,Hb.V4,this.Sa,this.ya));return R(R(R(super.Va(a),b),Int32Array.of(b.byteLength)),Yi)}}
class Ij extends Cj{constructor(){super();this.La=!0;this.ea=[];this.ja=[]}static writeAll(a){return(new Ij).writeAll(a)}Wa(){return this}Va(){return this}wb(a){R(this,`{\n  "schema": ${JSON.stringify({fields:a.fields.map(Jj)},null,2)}`)}Ua(a){0<a.dictionaries.size&&this.ja.push(a);return this}Vb(a,b,c){c=void 0===c?!1:c;this.ka.set(b,a.length+(this.ka.get(b)||0));R(this,0===this.ya.length?"    ":",\n    ");c=void 0===c?!1:c;const d=xj.Ha(new Q(new N(`${b}`,a.type,0<a.nullCount),[a]));a=JSON.stringify({id:b,
isDelta:c,data:{count:a.length,columns:d}},null,2);R(this,`${a}`);this.ya.push(new ah(0,0,0))}Wb(a){this.Ua(a);this.ea.push(a)}close(){if(0<this.ja.length){R(this,',\n  "dictionaries": [\n');for(var a of this.ja)super.Ua(a);R(this,"\n  ]")}if(0<this.ea.length){for(let b=-1,c=this.ea.length;++b<c;)R(this,0===b?',\n  "batches": [\n    ':",\n    "),a=this.ea[b],a=JSON.stringify({count:a.length,columns:xj.Ha(a)},null,2),R(this,`${a}`),this.Sa.push(new ah(0,0,0));R(this,"\n  ]")}this.u&&R(this,"\n}");
this.ja=[];this.ea=[];return super.close()}}function Ej(a,b){let c=b;b instanceof S&&(c=b.chunks,a.reset(void 0,b.schema));for(const d of c)a.write(d);return a.finish()}function Dj(a,b){return l(function*(){for(const c=ia(b);;){const d=yield c.next();if(d.done)break;a.write(d.value)}return a.finish()})}
function Jj(a){var {name:b,type:c,nullable:d}=a;a=new wj;return{name:b,nullable:d,type:a.visit(c),children:(c.children||[]).map(Jj),dictionary:J.isDictionary(c)?{id:c.id,isOrdered:c.isOrdered,indexType:a.visit(c.indices)}:void 0}};const Kj=new Uint8Array(0);function Lj(a,b,c=b.reduce((d,e)=>Math.max(d,e.length),0)){let d,e=-1;const f=b.length,h=[...a.fields],k=[],n=(c+63&-64)>>3;for(;++e<f;)(d=b[e])&&d.length===c?k[e]=d:((a=h[e]).nullable||(h[e]=h[e].clone({nullable:!0})),k[e]=d?Ne(d,c):K.new(a.type,0,c,c,[Kj,Kj,new Uint8Array(n),Kj]));return[new M(h),c,k]}function Mj(a){return Nj(new M(a.map(({field:b})=>b)),a)}function Nj(a,b){return Oj(a,b.map(c=>c instanceof $h?c.chunks.map(d=>d.data):[c.data]))}
function Oj(a,b){const c=[...a.fields],d=[],e={Db:b.reduce((Z,sb)=>Math.max(Z,sb.length),0)};let f=0,h=0,k=-1;const n=b.length;let p,u=[];for(;0<e.Db--;){h=Number.POSITIVE_INFINITY;for(k=-1;++k<n;)u[k]=p=b[k].shift(),h=Math.min(h,p?p.length:h);isFinite(h)&&(u=Pj(c,h,u,b,e),0<h&&(d[f++]=[h,u.slice()]))}return[a=new M(c,a.metadata),d.map(Z=>new qj(a,...Z))]}
function Pj(a,b,c,d,e){let f,h,k=0,n=-1;const p=d.length,u=(b+63&-64)>>3;for(;++n<p;)(f=c[n])&&(k=f.length)>=b?k===b?c[n]=f:(c[n]=f.slice(0,b),f=f.slice(b,k-b),e.Db=Math.max(e.Db,d[n].unshift(f))):((h=a[n]).nullable||(a[n]=h.clone({nullable:!0})),c[n]=f?Ne(f,b):K.new(h.type,0,b,b,[Kj,Kj,new Uint8Array(u),Kj]));return c};class T extends B{constructor(a,b){super();this.S=b;this.numChildren=a.childData.length;this.Nb(this.data=a)}get type(){return this.data.type}get typeId(){return this.data.typeId}get length(){return this.data.length}get offset(){return this.data.offset}get stride(){return this.data.stride}get nullCount(){return this.data.nullCount}get byteLength(){return this.data.byteLength}get VectorName(){return`${G[this.typeId]}Vector`}get ArrayType(){return this.type.ArrayType}get values(){return this.data.values}get typeIds(){return this.data.typeIds}get nullBitmap(){return this.data.nullBitmap}get valueOffsets(){return this.data.valueOffsets}get [Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}clone(a,
b=this.S){return B.new(a,b)}concat(...a){return $h.concat(this,...a)}slice(a,b){return Ih(this,a,b,this.tb)}isValid(a){return 0<this.nullCount?(a=this.offset+a,0!==(this.nullBitmap[a>>3]&1<<a%8)):!0}getChildAt(a){return 0>a||a>=this.numChildren?null:(this.S||(this.S=[]))[a]||(this.S[a]=B.new(this.data.childData[a]))}toJSON(){return[...this]}tb(a,b,c){return a.clone(a.data.slice(b,c-b),null)}Nb(){}}T.prototype[Symbol.isConcatSpreadable]=!0;class Qj extends T{asUtf8(){return B.new(this.data.clone(new td))}};class Rj extends T{static from(a){return Sj(()=>new xd,a)}};class Tj extends T{static from(...a){return 2===a.length?Sj(()=>a[1]===Rb.DAY?new Jd:new Kd,a[0]):Sj(()=>new Kd,a[0])}}class Yj extends Tj{}class Zj extends Tj{};class ak extends T{};class bk extends T{constructor(a){super(a);this.indices=B.new(a.clone(this.type.indices))}static from(...a){if(3===a.length){const [b,c,d]=a,e=new He(b.type,c,null,null);return B.new(K.Dictionary(e,0,d.length,0,null,d,b))}return Sj(()=>a[0].type,a[0])}get dictionary(){return this.data.dictionary}reverseLookup(a){return this.dictionary.indexOf(a)}getKey(a){return this.indices.get(a)}getValue(a){return this.dictionary.get(a)}setKey(a,b){return this.indices.set(a,b)}setValue(a,b){return this.dictionary.set(a,
b)}}bk.prototype.indices=null;class ck extends T{};class dk extends T{};class ek extends T{static from(a){let b=fk(this);if(a instanceof ArrayBuffer||ArrayBuffer.isView(a)){var c=gk(a.constructor)||b;null===b&&(b=c);if(b&&b===c){c=new b;const d=a.byteLength/c.ArrayType.BYTES_PER_ELEMENT;if(b!==md||a.constructor===Uint16Array)return B.new(K.Float(c,0,d,0,null,a))}}if(b)return Sj(()=>new b,a);if(a instanceof DataView||a instanceof ArrayBuffer)throw new TypeError(`Cannot infer float type from instance of ${a.constructor.name}`);throw new TypeError("Unrecognized FloatVector input");
}}class hk extends ek{toFloat32Array(){return new Float32Array(this)}toFloat64Array(){return new Float64Array(this)}}class ik extends ek{}class jk extends ek{}const gk=a=>{switch(a){case Uint16Array:return md;case Float32Array:return nd;case Float64Array:return od;default:return null}},fk=a=>{switch(a){case hk:return md;case ik:return nd;case jk:return od;default:return null}};class kk extends T{}class lk extends kk{}class mk extends kk{};class nk extends T{static from(...a){const [b,c=!1]=a;let d=ok(this,c);if(b instanceof ArrayBuffer||ArrayBuffer.isView(b))if(a=pk(b.constructor,c)||d,null===d&&(d=a),d&&d===a){a=new d;let e=b.byteLength/a.ArrayType.BYTES_PER_ELEMENT;qk(d,b.constructor)&&(e*=.5);return B.new(K.Int(a,0,e,0,null,b))}if(d)return Sj(()=>new d,b);if(b instanceof DataView||b instanceof ArrayBuffer)throw new TypeError(`Cannot infer integer type from instance of ${b.constructor.name}`);throw new TypeError("Unrecognized IntVector input");
}}class rk extends nk{}class sk extends nk{}class tk extends nk{}class uk extends nk{toBigInt64Array(){return z(gb,this.values)}get values64(){return this.ub||(this.ub=this.toBigInt64Array())}}class vk extends nk{}class wk extends nk{}class xk extends nk{}class yk extends nk{toBigUint64Array(){return z(hb,this.values)}get values64(){return this.ub||(this.ub=this.toBigUint64Array())}}
const qk=(a,b)=>(a===dd||a===hd)&&(b===Int32Array||b===Uint32Array),pk=(a,b)=>{switch(a){case Int8Array:return ad;case Int16Array:return bd;case Int32Array:return b?dd:cd;case gb:return dd;case Uint8Array:return ed;case Uint16Array:return fd;case Uint32Array:return b?hd:gd;case hb:return hd;default:return null}},ok=(a,b)=>{switch(a){case rk:return ad;case sk:return bd;case tk:return b?dd:cd;case uk:return dd;case vk:return ed;case wk:return fd;case xk:return b?hd:gd;case yk:return hd;default:return null}};class zk extends T{};class Ak extends T{asList(){return B.new(this.data.clone(new ge(this.type.children[0])))}bind(a){const b=this.getChildAt(0),{[a]:c,[a+1]:d}=this.valueOffsets;return new Dh(b.slice(c,d))}};class Bk extends T{};const Ck=Symbol.for("rowIndex");class Dk extends T{bind(a){var b=this.qc||(this.qc=new Fh(this));b=Object.create(b);b[Ck]=a;return b}};class Ek extends T{}class Fk extends Ek{}class Gk extends Ek{}class Hk extends Ek{}class Ik extends Ek{};class Jk extends T{}class Kk extends Jk{}class Lk extends Jk{}class Mk extends Jk{}class Nk extends Jk{};class Ok extends T{get typeIdToChildIndex(){return this.data.type.typeIdToChildIndex}}class Pk extends Ok{get valueOffsets(){return this.data.valueOffsets}}class Qk extends Ok{};class Rk extends T{static from(a){return Sj(()=>new td,a)}asBinary(){return B.new(this.data.clone(new pd))}};function Sk(a){return function(){return a(this)}}function Tk(a){return function(b){return a(this,b)}}function Uk(a){return function(b,c){return a(this,b,c)}};class Vk extends ng{}
const Wk=(a,b)=>4294967296*a[b+1]+(a[b]>>>0),Xk=(a,b,c)=>{const {[c]:d,[c+1]:e}=b;return null!=d&&null!=e?a.subarray(d,e):null},Yk=({values:a},b)=>new Date(864E5*a[b]),Zk=({values:a},b)=>new Date(Wk(a,2*b)),$k=({stride:a,values:b},c)=>b[a*c],al=({stride:a,values:b},c)=>nf(b[a*c]),bl=({stride:a,values:b,type:c},d)=>Df.new(b.subarray(a*d,a*(d+1)),c.isSigned),cl=({values:a},b)=>1E3*Wk(a,2*b),dl=({values:a},b)=>Wk(a,2*b),el=({values:a},b)=>{b*=2;return a[b+1]/1E3*4294967296+(a[b]>>>0)/1E3},fl=({values:a},
b)=>{b*=2;return a[b+1]/1E6*4294967296+(a[b]>>>0)/1E6},gl=({values:a,stride:b},c)=>a[b*c],hl=({values:a,stride:b},c)=>a[b*c],il=({values:a},b)=>new zf(a.subarray(2*b,2*(b+1))),jl=({values:a},b)=>new zf(a.subarray(2*b,2*(b+1))),kl=(a,b)=>{const c=a.getChildAt(a.typeIdToChildIndex[a.typeIds[b]]);return c?c.get(a.valueOffsets[b]):null},ll=(a,b)=>(a=a.getChildAt(a.typeIdToChildIndex[a.typeIds[b]]))?a.get(b):null,ml=({values:a},b)=>a.subarray(2*b,2*(b+1)),nl=({values:a},b)=>{a=a[b];b=new Int32Array(2);
b[0]=a/12|0;b[1]=a%12|0;return b};g=Vk.prototype;g.visitNull=()=>null;g.visitBool=({offset:a,values:b},c)=>{a+=c;return 0!==(b[a>>3]&1<<a%8)};g.visitInt=(a,b)=>64>a.type.bitWidth?$k(a,b):bl(a,b);g.visitInt8=$k;g.visitInt16=$k;g.visitInt32=$k;g.visitInt64=bl;g.visitUint8=$k;g.visitUint16=$k;g.visitUint32=$k;g.visitUint64=bl;g.visitFloat=(a,b)=>a.type.precision!==Pb.HALF?$k(a,b):al(a,b);g.visitFloat16=al;g.visitFloat32=$k;g.visitFloat64=$k;
g.visitUtf8=({values:a,valueOffsets:b},c)=>{a=Xk(a,b,c);return null!==a?Va.decode(a):null};g.visitBinary=({values:a,valueOffsets:b},c)=>Xk(a,b,c);g.visitFixedSizeBinary=({stride:a,values:b},c)=>b.subarray(a*c,a*(c+1));g.visitDate=(a,b)=>a.type.unit===Rb.DAY?Yk(a,b):Zk(a,b);g.visitDateDay=Yk;g.visitDateMillisecond=Zk;g.visitTimestamp=(a,b)=>{switch(a.type.unit){case C.SECOND:return cl(a,b);case C.MILLISECOND:return dl(a,b);case C.MICROSECOND:return el(a,b);case C.NANOSECOND:return fl(a,b)}};
g.visitTimestampSecond=cl;g.visitTimestampMillisecond=dl;g.visitTimestampMicrosecond=el;g.visitTimestampNanosecond=fl;g.visitTime=(a,b)=>{switch(a.type.unit){case C.SECOND:return gl(a,b);case C.MILLISECOND:return hl(a,b);case C.MICROSECOND:return il(a,b);case C.NANOSECOND:return jl(a,b)}};g.visitTimeSecond=gl;g.visitTimeMillisecond=hl;g.visitTimeMicrosecond=il;g.visitTimeNanosecond=jl;g.visitDecimal=({values:a},b)=>new Bf(a.subarray(4*b,4*(b+1)));
g.visitList=(a,b)=>{const c=a.getChildAt(0),d=a.valueOffsets;a=a.stride;return c.slice(d[b*a],d[b*a+1])};g.visitStruct=(a,b)=>a.bind(b);g.visitUnion=(a,b)=>a.type.mode===Nb.Dense?kl(a,b):ll(a,b);g.visitDenseUnion=kl;g.visitSparseUnion=ll;g.visitDictionary=(a,b)=>a.getValue(a.getKey(b));g.visitInterval=(a,b)=>a.type.unit===Ub.DAY_TIME?ml(a,b):nl(a,b);g.visitIntervalDayTime=ml;g.visitIntervalYearMonth=nl;g.visitFixedSizeList=(a,b)=>{const c=a.getChildAt(0);a=a.stride;return c.slice(b*a,(b+1)*a)};
g.visitMap=(a,b)=>a.bind(b);const ol=new Vk;class pl extends ng{}function U(a,b,c){if(void 0===b)return-1;if(null===b){a:{const e=a.data.nullBitmap;if(e&&!(0>=a.nullCount)){b=0;for(var d of new Oc(e,a.data.offset+(c||0),a.length,e,Jc)){if(!d){a=b;break a}++b}}a=-1}return a}d=Lh(b);for(let e=(c||0)-1,f=a.length;++e<f;)if(d(a.get(e)))return e;return-1}function ql(a,b,c){b=Lh(b);for(let d=(c||0)-1,e=a.length;++d<e;)if(b(a.get(d)))return d;return-1}g=pl.prototype;g.visitNull=function(a,b){return null===b&&0<a.length?0:-1};g.visitBool=U;
g.visitInt=U;g.visitInt8=U;g.visitInt16=U;g.visitInt32=U;g.visitInt64=U;g.visitUint8=U;g.visitUint16=U;g.visitUint32=U;g.visitUint64=U;g.visitFloat=U;g.visitFloat16=U;g.visitFloat32=U;g.visitFloat64=U;g.visitUtf8=U;g.visitBinary=U;g.visitFixedSizeBinary=U;g.visitDate=U;g.visitDateDay=U;g.visitDateMillisecond=U;g.visitTimestamp=U;g.visitTimestampSecond=U;g.visitTimestampMillisecond=U;g.visitTimestampMicrosecond=U;g.visitTimestampNanosecond=U;g.visitTime=U;g.visitTimeSecond=U;
g.visitTimeMillisecond=U;g.visitTimeMicrosecond=U;g.visitTimeNanosecond=U;g.visitDecimal=U;g.visitList=U;g.visitStruct=U;g.visitUnion=U;g.visitDenseUnion=ql;g.visitSparseUnion=ql;g.visitDictionary=U;g.visitInterval=U;g.visitIntervalDayTime=U;g.visitIntervalYearMonth=U;g.visitFixedSizeList=U;g.visitMap=U;const rl=new pl;class sl extends ng{}function tl(a){const b=ol.getVisitFn(a);return new Oc(a.data.nullBitmap,a.data.offset,a.length,a,(c,d,e,f)=>0!==(e&1<<f)?b(c,d):null)}class ul{constructor(a,b){this.ba=a;this.xc=b;this.index=0}next(){return this.index<this.ba.length?{value:this.xc(this.ba,this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}}
function V(a){if(0<a.nullCount)return tl(a);const b=a.type,c=a.typeId,d=a.length;return 1===a.stride&&(c===G.Timestamp||c===G.Int&&64!==b.bitWidth||c===G.Time&&64!==b.bitWidth||c===G.Float&&0<b.precision)?a.data.values.subarray(0,d)[Symbol.iterator]():new ul(a,ol.getVisitFn(a))}g=sl.prototype;g.visitNull=V;g.visitBool=V;g.visitInt=V;g.visitInt8=V;g.visitInt16=V;g.visitInt32=V;g.visitInt64=V;g.visitUint8=V;g.visitUint16=V;g.visitUint32=V;g.visitUint64=V;g.visitFloat=V;g.visitFloat16=V;
g.visitFloat32=V;g.visitFloat64=V;g.visitUtf8=V;g.visitBinary=V;g.visitFixedSizeBinary=V;g.visitDate=V;g.visitDateDay=V;g.visitDateMillisecond=V;g.visitTimestamp=V;g.visitTimestampSecond=V;g.visitTimestampMillisecond=V;g.visitTimestampMicrosecond=V;g.visitTimestampNanosecond=V;g.visitTime=V;g.visitTimeSecond=V;g.visitTimeMillisecond=V;g.visitTimeMicrosecond=V;g.visitTimeNanosecond=V;g.visitDecimal=V;g.visitList=V;g.visitStruct=V;g.visitUnion=V;g.visitDenseUnion=V;g.visitSparseUnion=V;
g.visitDictionary=V;g.visitInterval=V;g.visitIntervalDayTime=V;g.visitIntervalYearMonth=V;g.visitFixedSizeList=V;g.visitMap=V;const vl=new sl;class wl extends ng{}function W(a){const b=a.length,c=a.stride;switch(a.type.typeId){case G.Int:case G.Float:case G.Decimal:case G.Time:case G.Timestamp:return a.data.values.subarray(0,b*c)}return[...vl.visit(a)]}g=wl.prototype;g.visitNull=W;g.visitBool=W;g.visitInt=W;g.visitInt8=W;g.visitInt16=W;g.visitInt32=W;g.visitInt64=W;g.visitUint8=W;g.visitUint16=W;g.visitUint32=W;g.visitUint64=W;g.visitFloat=W;g.visitFloat16=W;g.visitFloat32=W;g.visitFloat64=W;g.visitUtf8=W;g.visitBinary=W;
g.visitFixedSizeBinary=W;g.visitDate=W;g.visitDateDay=W;g.visitDateMillisecond=W;g.visitTimestamp=W;g.visitTimestampSecond=W;g.visitTimestampMillisecond=W;g.visitTimestampMicrosecond=W;g.visitTimestampNanosecond=W;g.visitTime=W;g.visitTimeSecond=W;g.visitTimeMillisecond=W;g.visitTimeMicrosecond=W;g.visitTimeNanosecond=W;g.visitDecimal=W;g.visitList=W;g.visitStruct=W;g.visitUnion=W;g.visitDenseUnion=W;g.visitSparseUnion=W;g.visitDictionary=W;g.visitInterval=W;g.visitIntervalDayTime=W;
g.visitIntervalYearMonth=W;g.visitFixedSizeList=W;g.visitMap=W;const xl=new wl;const yl=(a,b)=>a+b,zl=a=>`Cannot compute the byte width of variable-width column ${a}`;function Al(a,b){return(b||[]).map(c=>a.visit(c.type))}
class Bl extends ng{visitNull(){return 0}visitInt(a){return a.bitWidth/8}visitFloat(a){return a.ArrayType.BYTES_PER_ELEMENT}visitBinary(a){throw Error(zl(a));}visitUtf8(a){throw Error(zl(a));}visitBool(){return.125}visitDecimal(){return 16}visitDate(a){return 4*(a.unit+1)}visitTime(a){return a.bitWidth/8}visitTimestamp(a){return a.unit===C.SECOND?4:8}visitInterval(a){return 4*(a.unit+1)}visitList(a){throw Error(zl(a));}visitStruct(a){return Al(this,a.children).reduce(yl,0)}visitUnion(a){return Al(this,
a.children).reduce(yl,0)}visitFixedSizeBinary(a){return a.byteWidth}visitFixedSizeList(a){return a.listSize*Al(this,a.children).reduce(yl,0)}visitMap(a){return Al(this,a.children).reduce(yl,0)}visitDictionary(a){return this.visit(a.indices)}}const Cl=new Bl;class Dl extends ng{visitNull(){return Bk}visitBool(){return Rj}visitInt(){return nk}visitInt8(){return rk}visitInt16(){return sk}visitInt32(){return tk}visitInt64(){return uk}visitUint8(){return vk}visitUint16(){return wk}visitUint32(){return xk}visitUint64(){return yk}visitFloat(){return ek}visitFloat16(){return hk}visitFloat32(){return ik}visitFloat64(){return jk}visitUtf8(){return Rk}visitBinary(){return Qj}visitFixedSizeBinary(){return ck}visitDate(){return Tj}visitDateDay(){return Yj}visitDateMillisecond(){return Zj}visitTimestamp(){return Ek}visitTimestampSecond(){return Fk}visitTimestampMillisecond(){return Gk}visitTimestampMicrosecond(){return Hk}visitTimestampNanosecond(){return Ik}visitTime(){return Jk}visitTimeSecond(){return Kk}visitTimeMillisecond(){return Lk}visitTimeMicrosecond(){return Mk}visitTimeNanosecond(){return Nk}visitDecimal(){return ak}visitList(){return zk}visitStruct(){return Dk}visitUnion(){return Ok}visitDenseUnion(){return Pk}visitSparseUnion(){return Qk}visitDictionary(){return bk}visitInterval(){return kk}visitIntervalDayTime(){return lk}visitIntervalYearMonth(){return mk}visitFixedSizeList(){return dk}visitMap(){return Ak}}
const El=new Dl;B.new=Fl;B.from=Gl;function Fl(a,...b){return new (El.getVisitFn(a)())(a,...b)}function Sj(a,b){if(ib(b)||jb(b))return B.from({nullValues:[null,void 0],type:a(),values:b});const {type:c=a(),nullValues:d=[null,void 0]}=Object.assign({},b);return B.from(Object.assign({},{nullValues:d},b,{type:c}))}
function Gl(a){a=Object.assign({},{nullValues:[null,void 0]},a);var b=Object.assign({},a);const c=void 0===a.values?[]:a.values,d=(delete b.values,b);return ib(c)?(a=[...L.throughIterable(d)(c)],1===a.length?a[0]:$h.concat(a)):(e=>l(function*(){var f=L.throughAsyncIterable(d);for(f=ia(f(c));;){const h=yield f.next();if(h.done)break;e.push(h.value)}return 1===e.length?e[0]:$h.concat(e)}))([])}g=T.prototype;g.get=function(a){return ol.visit(this,a)};g.set=function(a,b){return Rg.visit(this,a,b)};
g.indexOf=function(a,b){return rl.visit(this,a,b)};g.toArray=function(){return xl.visit(this)};g.getByteWidth=function(){return Cl.visit(this.type)};T.prototype[Symbol.iterator]=function(){return vl.visit(this)};T.prototype.Nb=Hl;
Object.keys(G).map(a=>G[a]).filter(a=>"number"===typeof a).filter(a=>a!==G.NONE).forEach(a=>{const b=El.visit(a);b.prototype.get=Tk(ol.getVisitFn(a));b.prototype.set=Uk(Rg.getVisitFn(a));b.prototype.indexOf=Uk(rl.getVisitFn(a));b.prototype.toArray=Sk(xl.getVisitFn(a));b.prototype.getByteWidth=Il(Cl.getVisitFn(a));b.prototype[Symbol.iterator]=Sk(vl.getVisitFn(a))});function Il(a){return function(){return a(this.type)}}function Jl(a){return function(b){return this.isValid(b)?a.call(this,b):null}}
function Kl(a){return function(b,c){Lc(this.nullBitmap,this.offset+b,null!=c)&&a.call(this,b,c)}}function Hl(){const a=this.nullBitmap;a&&0<a.byteLength&&(this.get=Jl(this.get),this.set=Kl(this.set))};class S extends $h{constructor(...a){let b=null;a[0]instanceof M&&(b=a[0]);a=a[0]instanceof S?a[0].chunks:Yh(qj,a,[],0);let c;if(!b&&!(b=null==(c=a[0])?void 0:c.schema))throw new TypeError("Table must be initialized with a Schema or at least one RecordBatch");a[0]||(a[0]=new Fj(b));super(new ke(b.fields),a);this.u=b;this.o=a}static empty(a){a=void 0===a?new M([]):a;return new S(a,[])}static from(a){if(!a)return S.empty();if("object"===typeof a){const c=ib(a.values)?a.type instanceof ke?S.fromStruct(Dk.from(a)):
null:jb(a.values)?Ll(a):null;if(null!==c)return c}let b=Ml.from(a);return y(b)&&x(b.then)?(()=>l(function*(){return yield S.from(yield b)}))():b.isSync()&&(b=b.open())?b.schema?new S(b.schema,[...b]):S.empty():(c=>l(function*(){var d=yield c;const e=d.schema,f=[];if(e){for(d=ia(d);;){const h=yield d.next();if(h.done)break;f.push(h.value)}return new S(e,f)}return S.empty()}))(b.open())}static fromAsync(a){return l(function*(){return yield S.from(a)})}static fromStruct(a){return S.new(a.data.childData,
a.type.children)}static new(...a){return new S(...Mj(Xh(a)))}get schema(){return this.u}get length(){return this.Ba}get chunks(){return this.o}get numCols(){return this.pb}clone(a){a=void 0===a?this.o:a;return new S(this.u,a)}getColumn(a){return this.getColumnAt(this.getColumnIndex(a))}getColumnAt(a){return this.getChildAt(a)}getColumnIndex(a){return this.u.fields.findIndex(b=>b.name===a)}getChildAt(a){if(0>a||a>=this.numChildren)return null;var b,c=this.u.fields;const d=this.S||(this.S=[]);if(b=
d[a])return b;if(b=c[a])if(c=this.o.map(e=>e.getChildAt(a)).filter(e=>null!=e),0<c.length)return d[a]=new Q(b,c);return null}serialize(a,b){return(void 0===b||b?Gj:Hj).writeAll(this).toUint8Array(!0)}count(){return this.Ba}select(...a){const b=this.u.fields.reduce((c,d,e)=>c.set(d.name,e),new Map);return this.selectAt(...a.map(c=>b.get(c)).filter(c=>-1<c))}selectAt(...a){const b=this.u.selectAt(...a);return new S(b,this.o.map(c=>{var {length:d,data:{childData:e}}=c;return new qj(b,d,a.map(f=>e[f]).filter(Boolean))}))}assign(a){const b=
this.u.fields,[c,d]=a.schema.fields.reduce((h,k,n)=>{const [p,u]=h,Z=b.findIndex(sb=>sb.name===k.name);~Z?u[Z]=n:p.push(n);return h},[[],[]]),e=this.u.assign(a.schema),f=[...b.map((h,k,n,p)=>{p=void 0===p?d[k]:p;return void 0===p?this.getColumnAt(k):a.getColumnAt(p)}),...c.map(h=>a.getColumnAt(h))].filter(Boolean);return new S(...Nj(e,f))}}function Ll(a){return a.type instanceof ke?Dk.from(a).then(b=>S.fromStruct(b)):null};class qj extends Dk{constructor(...a){const b=a[0];let c;if(a[1]instanceof K)[,a,c]=a;else{const d=b.fields,[,e,f]=a;a=K.Struct(new ke(d),0,e,0,null,f)}super(a,c);this.u=b}static from(a){return S.from(a)}static new(...a){const [b,c]=Wh(a,[[],[]]);a=c.filter(d=>d instanceof B);return new qj(...Lj(new M(b),a.map(d=>d.data)))}clone(a,b=this.S){return new qj(this.u,a,b)}concat(...a){const b=this.u;a=$h.flatten(this,...a);return new S(b,a.map(({data:c})=>new qj(b,c)))}get schema(){return this.u}get numCols(){return this.u.fields.length}get dictionaries(){return this.ja||
(this.ja=(new Nl).visit(this.data,new ke(this.schema.fields)).dictionaries)}select(...a){const b=this.u.fields.reduce((c,d,e)=>c.set(d.name,e),new Map);return this.selectAt(...a.map(c=>b.get(c)).filter(c=>-1<c))}selectAt(...a){const b=this.u.selectAt(...a);a=a.map(c=>this.data.childData[c]).filter(Boolean);return new qj(b,this.length,a)}}class Fj extends qj{constructor(a){super(a,0,a.fields.map(b=>K.new(b.type,0,0,0)))}}
class Nl extends ng{constructor(){super(...arguments);this.dictionaries=new Map}visit(a,b){if(J.isDictionary(b))return this.visitDictionary(a,b);a.childData.forEach((c,d)=>this.visit(c,b.children[d].type));return this}visitDictionary(a,b){(a=a.dictionary)&&0<a.length&&this.dictionaries.set(b.id,a);return this}};class Ml extends ab{constructor(a){super();this.s=a}get closed(){return this.s.closed}get schema(){return this.s.schema}get autoDestroy(){return this.s.autoDestroy}get dictionaries(){return this.s.dictionaries}get numDictionaries(){return this.s.numDictionaries}get numRecordBatches(){return this.s.numRecordBatches}get footer(){return this.s.isFile()?this.s.footer:null}isSync(){return this.s.isSync()}isAsync(){return this.s.isAsync()}isFile(){return this.s.isFile()}isStream(){return this.s.isStream()}next(){return this.s.next()}throw(a){return this.s.throw(a)}return(a){return this.s.return(a)}cancel(){return this.s.cancel()}reset(a){this.s.reset(a);
this.Tb=this.Lb=void 0;return this}open(a){a=this.s.open(a);return y(a)&&x(a.then)?a.then(()=>this):this}readRecordBatch(a){return this.s.isFile()?this.s.readRecordBatch(a):null}[Symbol.iterator](){return this.s[Symbol.iterator]()}[Symbol.asyncIterator](){return this.s[Symbol.asyncIterator]()}toDOMStream(){return cb(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return db(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}static throughNode(){throw Error('"throughNode" not available in this environment');
}static throughDOM(){throw Error('"throughDOM" not available in this environment');}static from(a){return a instanceof Ml?a:y(a)&&y(a.schema)?new Ol(new Pl(a)):y(a)&&x(a.stat)&&"number"===typeof a.fd?Ql(a):y(a)&&x(a.then)?(()=>l(function*(){return yield Ml.from(yield a)}))():y(a)&&kb(a.body)||kb(a)||lb(a)||jb(a)?Rl(new eh(a)):Sl(new ch(a))}static readAll(a){return a instanceof Ml?a.isSync()?Tl(a):Ul(a):y(a)&&y(a.schema)||ArrayBuffer.isView(a)||ib(a)||y(a)&&"done"in a&&"value"in a?Tl(a):Ul(a)}}
class Ol extends Ml{constructor(a){super(a);this.s=a}[Symbol.iterator](){return this.s[Symbol.iterator]()}[Symbol.asyncIterator](){const a=this;return new oa(function*(){yield new m(1,a[Symbol.iterator]())}())}}class Vl extends Ml{constructor(a){super(a);this.s=a}[Symbol.iterator](){throw Error("AsyncRecordBatchStreamReader is not Iterable");}[Symbol.asyncIterator](){return this.s[Symbol.asyncIterator]()}}class Wl extends Ol{constructor(a){super(a);this.s=a}}
class Xl extends Vl{constructor(a){super(a);this.s=a}}function Yl(a,b,c){return new qj(a.schema,b.length,a.Ra(b,c,a.schema.fields))}function Zl(a,b,c){var d=b.id;const e=b.cb;b=b.data;const f=a.schema,h=a.dictionaries.get(d);return e||!h?(d=f.dictionaries.get(d),h&&e?h.concat(B.new(a.Ra(b,c,[d])[0])):B.new(a.Ra(b,c,[d])[0])):h}
class $l{constructor(a){a=void 0===a?new Map:a;this.closed=!1;this.autoDestroy=!0;this.O=this.$=0;this.dictionaries=a}get numDictionaries(){return this.$}get numRecordBatches(){return this.O}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(a){this.O=this.$=0;this.schema=a;this.dictionaries=new Map;return this}Ra(a,b,c){return(new rh(b,a.N,a.buffers,this.dictionaries)).visitMany(c)}}
class am extends $l{constructor(a,b){super(b);this.A=y(a)&&y(a.schema)?new Xi(this.J=a):new Vi(this.J=a)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset().A.return(),this.dictionaries=this.A=null)}open(a){this.closed||(this.autoDestroy=bm(this,a),this.schema||(this.schema=this.A.readSchema())||this.cancel());return this}throw(a){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset().A.throw(a):w}return(a){return!this.closed&&
this.autoDestroy&&(this.closed=!0)?this.reset().A.return(a):w}next(){if(this.closed)return w;for(var a,b=this.A;a=this.Da();)if(a.isSchema())this.reset(a.header());else{if(a.isRecordBatch()){this.O++;var c=a.header();b=b.readMessageBody(a.bodyLength);return{done:!1,value:Yl(this,c,b)}}a.isDictionaryBatch()&&(this.$++,c=a.header(),a=b.readMessageBody(a.bodyLength),a=Zl(this,c,a),this.dictionaries.set(c.id,a))}return this.schema&&0===this.O?(this.O++,{done:!1,value:new Fj(this.schema)}):this.return()}Da(){return this.A.readMessage(void 0)}}
class cm extends $l{constructor(a,b){super(b);this.A=new Wi(this.J=a)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){const a=this;return l(function*(){!a.closed&&(a.closed=!0)&&(yield a.reset().A.return(),a.A=null,a.dictionaries=null)})}open(a){const b=this;return l(function*(){b.closed||(b.autoDestroy=bm(b,a),b.schema||(b.schema=yield b.A.readSchema())||(yield b.cancel()));return b})}throw(a){const b=this;return l(function*(){return!b.closed&&b.autoDestroy&&
(b.closed=!0)?yield b.reset().A.throw(a):w})}return(a){const b=this;return l(function*(){return!b.closed&&b.autoDestroy&&(b.closed=!0)?yield b.reset().A.return(a):w})}next(){const a=this;return l(function*(){if(a.closed)return w;for(var b,c=a.A;b=yield a.Da();)if(b.isSchema())yield a.reset(b.header());else{if(b.isRecordBatch()){a.O++;var d=b.header();c=yield c.readMessageBody(b.bodyLength);return{done:!1,value:Yl(a,d,c)}}b.isDictionaryBatch()&&(a.$++,d=b.header(),b=yield c.readMessageBody(b.bodyLength),
b=Zl(a,d,b),a.dictionaries.set(d.id,b))}return a.schema&&0===a.O?(a.O++,{done:!1,value:new Fj(a.schema)}):yield a.return()})}Da(){const a=this;return l(function*(){return yield a.A.readMessage(void 0)})}}
class dm extends am{constructor(a){super(a instanceof gh?a:new gh(a),void 0)}get footer(){return this.j}get numDictionaries(){return this.j?this.j.numDictionaries:0}get numRecordBatches(){return this.j?this.j.numRecordBatches:0}isSync(){return!0}isFile(){return!0}open(a){if(!this.closed&&!this.j){this.schema=(this.j=this.sb()).schema;for(const b of Yg(this.j))b&&this.rb(this.$++)}return super.open(a)}readRecordBatch(a){if(this.closed)return null;this.j||this.open();if((a=this.j&&this.j.ra(a))&&this.J.seek(a.offset)){var b=
this.A.readMessage(F.RecordBatch);if(null==b?0:b.isRecordBatch())return a=b.header(),b=this.A.readMessageBody(b.bodyLength),Yl(this,a,b)}return null}rb(a){if((a=this.j&&this.j.bb(a))&&this.J.seek(a.offset)){var b=this.A.readMessage(F.DictionaryBatch);if(null==b?0:b.isDictionaryBatch())a=b.header(),b=this.A.readMessageBody(b.bodyLength),b=Zl(this,a,b),this.dictionaries.set(a.id,b)}}sb(){var a=this.J;const b=a.size-aj,c=a.v(b);a=a.sa(b-c,c);return Zg.decode(a)}Da(){this.j||this.open();if(this.j&&this.O<
this.numRecordBatches){const a=this.j&&this.j.ra(this.O);if(a&&this.J.seek(a.offset))return this.A.readMessage(void 0)}return null}}
class em extends cm{constructor(a){var b=[];const c="number"!==typeof b[0]?b.shift():void 0;b=b[0]instanceof Map?b.shift():void 0;super(a instanceof hh?a:new hh(a,c),b)}get footer(){return this.j}get numDictionaries(){return this.j?this.j.numDictionaries:0}get numRecordBatches(){return this.j?this.j.numRecordBatches:0}isFile(){return!0}isAsync(){return!0}open(a){const b=this,c=()=>Object.getPrototypeOf(Object.getPrototypeOf(this)).open;return l(function*(){if(!b.closed&&!b.j){b.schema=(b.j=yield b.sb()).schema;
for(const d of Yg(b.j))d&&(yield b.rb(b.$++))}return yield c().call(b,a)})}readRecordBatch(a){const b=this;return l(function*(){if(b.closed)return null;b.j||(yield b.open());var c=b.j&&b.j.ra(a);if(c&&(yield b.J.seek(c.offset))){var d=yield b.A.readMessage(F.RecordBatch);if(null==d?0:d.isRecordBatch())return c=d.header(),d=yield b.A.readMessageBody(d.bodyLength),Yl(b,c,d)}return null})}rb(a){const b=this;return l(function*(){var c=b.j&&b.j.bb(a);if(c&&(yield b.J.seek(c.offset))){var d=yield b.A.readMessage(F.DictionaryBatch);
if(null==d?0:d.isDictionaryBatch())c=d.header(),d=yield b.A.readMessageBody(d.bodyLength),d=Zl(b,c,d),b.dictionaries.set(c.id,d)}})}sb(){const a=this;return l(function*(){var b=a.J;b.F&&(yield b.F);const c=b.size-aj,d=yield b.v(c);b=yield b.sa(c-d,d);return Zg.decode(b)})}Da(){const a=this;return l(function*(){a.j||(yield a.open());if(a.j&&a.O<a.numRecordBatches){const b=a.j.ra(a.O);if(b&&(yield a.J.seek(b.offset)))return yield a.A.readMessage(void 0)}return null})}}
class Pl extends am{constructor(a){super(a,void 0)}Ra(a,b,c){return(new sh(b,a.N,a.buffers,this.dictionaries)).visitMany(c)}}function bm(a,b){return b&&"boolean"===typeof b.autoDestroy?b.autoDestroy:a.autoDestroy}function*Tl(a){a=Ml.from(a);try{if(!a.open({autoDestroy:!1}).closed){do yield a;while(!a.reset().open().closed)}}finally{a.cancel()}}
function Ul(a){return new oa(function*(){const b=yield new m(2,Ml.from(a));try{if(!(yield new m(2,b.open({autoDestroy:!1}))).closed){do yield new m(0,b);while(!(yield new m(2,b.reset().open())).closed)}}finally{yield new m(2,b.cancel())}}())}function Sl(a){const b=a.peek($i+7&-8);return b&&4<=b.byteLength?Zi(b)?new Wl(new dm(a.read())):new Ol(new am(a)):new Ol(new am(function*(){}()))}
function Rl(a){return l(function*(){const b=yield a.peek($i+7&-8);return b&&4<=b.byteLength?Zi(b)?new Wl(new dm(yield a.read())):new Vl(new cm(a)):new Vl(new cm(function(){return new oa(function*(){}())}()))})}function Ql(a){return l(function*(){const {size:b}=yield a.stat(),c=new hh(a,b);return b>=bj&&Zi(yield c.sa(0,$i+7&-8))?new Xl(new em(c)):new Vl(new cm(c))})};function fm(a,b){function c(h,k){let n,p,u=h.desiredSize||null;for(;!(p=k.next(e?u:null)).done;)if(ArrayBuffer.isView(p.value)&&(n=z(Uint8Array,p.value))&&(null!=u&&e&&(u=u-n.byteLength+1),p.value=n),h.enqueue(p.value),null!=u&&0>=--u)return;h.close()}let d=null;const e="bytes"===(null==b?void 0:b.type)||!1,f=(null==b?void 0:b.highWaterMark)||Math.pow(2,24);return new ReadableStream(Object.assign({},b,{start(h){c(h,d||(d=a[Symbol.iterator]()))},pull(h){d?c(h,d):h.close()},cancel(){let h;(null==(h=
d)?0:h.return)&&d.return();d=null}}),Object.assign({},{highWaterMark:e?f:void 0},b))}
function gm(a,b){function c(h,k){return l(function*(){let n,p,u=h.desiredSize||null;for(;!(p=yield k.next(e?u:null)).done;)if(ArrayBuffer.isView(p.value)&&(n=z(Uint8Array,p.value))&&(null!=u&&e&&(u=u-n.byteLength+1),p.value=n),h.enqueue(p.value),null!=u&&0>=--u)return;h.close()})}let d=null;const e="bytes"===(null==b?void 0:b.type)||!1,f=(null==b?void 0:b.highWaterMark)||Math.pow(2,24);return new ReadableStream(Object.assign({},b,{start(h){return l(function*(){yield c(h,d||(d=a[Symbol.asyncIterator]()))})},
pull(h){return l(function*(){d?yield c(h,d):h.close()})},cancel(){return l(function*(){let h;(null==(h=d)?0:h.return)&&(yield d.return());d=null})}}),Object.assign({},{highWaterMark:e?f:void 0},b))};function hm(a,b,c){null!==c&&(a.wa>=c.desiredSize&&++a.qb&&im(a,c,b.toVector()),b.finished&&((0<b.length||0===a.qb)&&++a.qb&&im(a,c,b.toVector()),!a.Pb&&(a.Pb=!0)&&im(a,c,null)))}function im(a,b,c){a.wa=0;a.xa=null;null===c?b.close():b.enqueue(c)}
class jm{constructor(a){this.qb=0;this.Pb=!1;this.wa=0;var b=Object.assign({},a),c=a.readableStrategy,d=a.writableStrategy;a=a.queueingStrategy;a=void 0===a?"count":a;b=(delete b.readableStrategy,delete b.writableStrategy,delete b.queueingStrategy,b);this.xa=null;this.fa=L.new(b);this.mc="bytes"!==a?km:lm;({["highWaterMark"]:c="bytes"===a?Math.pow(2,14):1E3}=Object.assign({},c));({["highWaterMark"]:d="bytes"===a?Math.pow(2,14):1E3}=Object.assign({},d));this.readable=new ReadableStream({["cancel"]:()=>
{this.fa.clear()},["pull"]:e=>{hm(this,this.fa,this.xa=e)},["start"]:e=>{hm(this,this.fa,this.xa=e)}},{highWaterMark:c,size:"bytes"!==a?km:lm});this.writable=new WritableStream({["abort"]:()=>{this.fa.clear()},["write"]:()=>{hm(this,this.fa,this.xa)},["close"]:()=>{hm(this,this.fa.finish(),this.xa)}},{highWaterMark:d,size:e=>{const f=this.wa;this.wa=this.mc(this.fa.append(e));return this.wa-f}})}}const km=a=>a.length,lm=a=>a.byteLength;function mm(a,b){function c(){return l(function*(){return yield(yield Ml.from(e)).open(b)})}function d(k,n){return l(function*(){let p=k.desiredSize,u;for(;!(u=yield n.next()).done;)if(k.enqueue(u.value),null!=p&&0>=--p)return;k.close()})}const e=new bh;let f=null;const h=new ReadableStream({cancel(){return l(function*(){yield e.close()})},start(k){return l(function*(){yield d(k,f||(f=yield c()))})},pull(k){return l(function*(){f?yield d(k,f):k.close()})}});return{writable:new WritableStream(e,Object.assign({},
{highWaterMark:Math.pow(2,14)},a)),readable:h}};function nm(a,b){function c(f){return l(function*(){let h,k=f.desiredSize;for(;h=yield e.read(k||null);)if(f.enqueue(h),null!=k&&0>=(k-=h.byteLength))return;f.close()})}const d=new this(a),e=new eh(d);b=new ReadableStream({type:"bytes",cancel(){return l(function*(){yield e.cancel()})},pull(f){return l(function*(){yield c(f)})},start(f){return l(function*(){yield c(f)})}},Object.assign({},{highWaterMark:Math.pow(2,14)},b));return{writable:new WritableStream(d,a),readable:b}};class om{eq(a){a instanceof om||(a=new pm(a));return new qm(this,a)}le(a){a instanceof om||(a=new pm(a));return new rm(this,a)}ge(a){a instanceof om||(a=new pm(a));return new sm(this,a)}lt(a){return new tm(this.ge(a))}gt(a){return new tm(this.le(a))}ne(a){return new tm(this.eq(a))}}class pm extends om{constructor(a){super();this.R=a}}
class um extends om{constructor(a){super();this.name=a}bind(a){if(!this.Za){this.Za=-1;const c=a.schema.fields;for(let d=-1;++d<c.length;)if(c[d].name===this.name){this.Za=d;break}if(0>this.Za)throw Error(`Failed to bind Col "${this.name}"`);}const b=this.ba=a.getChildAt(this.Za);return c=>b.get(c)}}class vm{and(...a){return new wm(this,...a)}or(...a){return new xm(this,...a)}not(){return new tm(this)}}
class ym extends vm{constructor(a,b){super();this.left=a;this.right=b}bind(a){return this.left instanceof pm?this.right instanceof pm?this.ib(this.left,this.right):this.hb(a,this.left,this.right):this.right instanceof pm?this.Ma(a,this.left,this.right):this.gb(a,this.left,this.right)}}class zm extends vm{constructor(...a){super();this.children=a}}zm.prototype.children=Object.freeze([]);
class wm extends zm{constructor(...a){a=a.reduce((b,c)=>b.concat(c instanceof wm?c.children:c),[]);super(...a)}bind(a){const b=this.children.map(c=>c.bind(a));return(c,d)=>b.every(e=>e(c,d))}}class xm extends zm{constructor(...a){a=a.reduce((b,c)=>b.concat(c instanceof xm?c.children:c),[]);super(...a)}bind(a){const b=this.children.map(c=>c.bind(a));return(c,d)=>b.some(e=>e(c,d))}}
class qm extends ym{ib(a,b){const c=a.R==b.R;return()=>c}gb(a,b,c){const d=b.bind(a),e=c.bind(a);return(f,h)=>d(f,h)==e(f,h)}Ma(a,b,c){const d=b.bind(a);if(b.ba instanceof bk){let e;const f=b.ba;f.dictionary!==this.yc?(e=f.reverseLookup(c.R),this.yc=f.dictionary,this.zc=e):e=this.zc;return-1===e?()=>!1:h=>f.getKey(h)===e}return(e,f)=>d(e,f)==c.R}hb(a,b,c){return this.Ma(a,c,b)}}
class rm extends ym{ib(a,b){const c=a.R<=b.R;return()=>c}gb(a,b,c){const d=b.bind(a),e=c.bind(a);return(f,h)=>d(f,h)<=e(f,h)}Ma(a,b,c){const d=b.bind(a);return(e,f)=>d(e,f)<=c.R}hb(a,b,c){const d=c.bind(a);return(e,f)=>b.R<=d(e,f)}}class sm extends ym{ib(a,b){const c=a.R>=b.R;return()=>c}gb(a,b,c){const d=b.bind(a),e=c.bind(a);return(f,h)=>d(f,h)>=e(f,h)}Ma(a,b,c){const d=b.bind(a);return(e,f)=>d(e,f)>=c.R}hb(a,b,c){const d=c.bind(a);return(e,f)=>b.R>=d(e,f)}}
class tm extends vm{constructor(a){super();this.wc=a}bind(a){const b=this.wc.bind(a);return(c,d)=>!b(c,d)}}class Am extends vm{constructor(a,b){super();this.next=a;this.sc=b}bind(a){this.sc(a);return this.next}}var X={};X.And=wm;X.Col=um;X.CombinationPredicate=zm;X.ComparisonPredicate=ym;X.CustomPredicate=Am;X.Equals=qm;X.GTeq=sm;X.LTeq=rm;X.Literal=pm;X.Not=tm;X.Or=xm;X.Predicate=vm;X.Value=om;X.and=function(...a){return new wm(...a)};X.col=function(a){return new um(a)};
X.custom=function(a,b){return new Am(a,b)};X.lit=function(a){return new pm(a)};X.or=function(...a){return new xm(...a)};class Bm extends S{filter(a){return new Cm(this.chunks,a)}scan(a,b){const c=this.chunks,d=c.length;for(let e=-1;++e<d;){const f=c[e];b&&b(f);for(let h=-1,k=f.length;++h<k;)a(h,f)}}scanReverse(a,b){const c=this.chunks;for(var d=c.length;0<=--d;){const e=c[d];b&&b(e);for(let f=e.length;0<=--f;)a(f,e)}}countBy(a){const b=this.chunks,c=b.length;a="string"===typeof a?new um(a):a;a.bind(b[c-1]);const d=a.ba;if(!J.isDictionary(d.type))throw Error("countBy currently only supports dictionary-encoded columns");
var e=Math.ceil(Math.log(d.length)/Math.log(256));e=new (4==e?Uint32Array:2<=e?Uint16Array:Uint8Array)(d.dictionary.length);for(let h=-1;++h<c;){var f=b[h];a.bind(f);const k=a.ba.indices;for(let n=-1,p=f.length;++n<p;)f=k.get(n),null!==f&&e[f]++}return new Dm(d.dictionary,nk.from(e))}}
class Dm extends S{constructor(a,b){const c=new M([new N("values",a.type),new N("counts",b.type)]);super(new qj(c,b.length,[a,b]))}toJSON(){const a=this.getColumnAt(0),b=this.getColumnAt(1),c={};for(let d=-1;++d<this.length;)c[a.get(d)]=b.get(d);return c}}
class Em{constructor(a,b){this.ha=a;this.predicate=b;this.index=this.Xa=0;this.na=this.ha[this.Xa];this.ac=this.predicate.bind(this.na)}next(){for(;this.Xa<this.ha.length;){for(;this.index<this.na.length;){if(this.ac(this.index,this.na))return{value:this.na.get(this.index++)};this.index++}++this.Xa<this.ha.length&&(this.index=0,this.na=this.ha[this.Xa],this.ac=this.predicate.bind(this.na))}return{done:!0,value:null}}[Symbol.iterator](){return this}}
class Cm extends Bm{constructor(a,b){super(a);this.ma=b}scan(a,b){const c=this.o,d=c.length;for(let e=-1;++e<d;){const f=c[e],h=this.ma.bind(f);let k=!1;for(let n=-1,p=f.length;++n<p;)h(n,f)&&(b&&!k&&(b(f),k=!0),a(n,f))}}scanReverse(a,b){const c=this.o;for(var d=c.length;0<=--d;){const e=c[d],f=this.ma.bind(e);let h=!1;for(let k=e.length;0<=--k;)f(k,e)&&(b&&!h&&(b(e),h=!0),a(k,e))}}count(){let a=0;const b=this.o,c=b.length;for(let d=-1;++d<c;){const e=b[d],f=this.ma.bind(e);for(let h=-1,k=e.length;++h<
k;)f(h,e)&&++a}return a}[Symbol.iterator](){return new Em(this.o,this.ma)}filter(a){return new Cm(this.o,this.ma.and(a))}countBy(a){const b=this.o,c=b.length;a="string"===typeof a?new um(a):a;a.bind(b[c-1]);const d=a.ba;if(!J.isDictionary(d.type))throw Error("countBy currently only supports dictionary-encoded columns");var e=Math.ceil(Math.log(d.length)/Math.log(256));e=new (4==e?Uint32Array:2<=e?Uint16Array:Uint8Array)(d.dictionary.length);for(let f=-1;++f<c;){const h=b[f],k=this.ma.bind(h);a.bind(h);
const n=a.ba.indices;for(let p=-1,u=h.length;++p<u;){const Z=n.get(p);null!==Z&&k(p,h)&&e[Z]++}}return new Dm(d.dictionary,nk.from(e))}};const Fm=Object.assign({},Ef,ph,Sc,pf,A,Sh,{compareSchemas:oj,compareFields:function(a,b){return mj.compareFields(a,b)},compareTypes:function(a,b){return mj.visit(a,b)}});cb=function(a,b){if(jb(a))return gm(a,b);if(ib(a))return fm(a,b);throw Error("toDOMStream() must be called with an Iterable or AsyncIterable");};L.throughDOM=function(a){return new jm(a)};Ml.throughDOM=mm;Wl.throughDOM=mm;Ol.throughDOM=mm;Cj.throughDOM=nm;Hj.throughDOM=nm;Gj.throughDOM=nm;var Y={};Y.AsyncByteQueue=bh;Y.AsyncByteStream=eh;Y.AsyncMessageReader=Wi;Y.AsyncRecordBatchFileReader=Xl;Y.AsyncRecordBatchStreamReader=Vl;Y.BaseVector=T;Y.Binary=pd;Y.BinaryBuilder=bg;Y.BinaryVector=Qj;
Y.Bool=xd;Y.BoolBuilder=cf;Y.BoolVector=Rj;Y.BufferType=I;Y.Builder=L;Y.ByteStream=ch;Y.Chunked=$h;Y.Column=Q;Y.CountByResult=Dm;Y.Data=K;Y.DataFrame=Bm;Y.DataType=J;Y.DateBuilder=ef;Y.DateDay=Jd;Y.DateDayBuilder=ff;Y.DateDayVector=Yj;Y.DateMillisecond=Kd;Y.DateMillisecondBuilder=gf;Y.DateMillisecondVector=Zj;Y.DateUnit=Rb;Y.DateVector=Tj;Y.Date_=Fd;Y.Decimal=Bd;Y.DecimalBuilder=hf;Y.DecimalVector=ak;Y.DenseUnion=se;Y.DenseUnionBuilder=mg;Y.DenseUnionVector=Pk;Y.Dictionary=He;
Y.DictionaryBuilder=jf;Y.DictionaryVector=bk;Y.Field=N;Y.FilteredDataFrame=Cm;Y.FixedSizeBinary=ue;Y.FixedSizeBinaryBuilder=kf;Y.FixedSizeBinaryVector=ck;Y.FixedSizeList=ye;Y.FixedSizeListBuilder=hg;Y.FixedSizeListVector=dk;Y.Float=id;Y.Float16=md;Y.Float16Builder=rf;Y.Float16Vector=hk;Y.Float32=nd;Y.Float32Builder=sf;Y.Float32Vector=ik;Y.Float64=od;Y.Float64Builder=tf;Y.Float64Vector=jk;Y.FloatBuilder=qf;Y.FloatVector=ek;Y.Int=Xc;Y.Int16=bd;Y.Int16Builder=Hf;Y.Int16Vector=sk;Y.Int32=cd;
Y.Int32Builder=If;Y.Int32Vector=tk;Y.Int64=dd;Y.Int64Builder=Jf;Y.Int64Vector=uk;Y.Int8=ad;Y.Int8Builder=Gf;Y.Int8Vector=rk;Y.IntBuilder=Ff;Y.IntVector=nk;Y.Interval=ae;Y.IntervalBuilder=Zf;Y.IntervalDayTime=ee;Y.IntervalDayTimeBuilder=$f;Y.IntervalDayTimeVector=lk;Y.IntervalUnit=Ub;Y.IntervalVector=kk;Y.IntervalYearMonth=fe;Y.IntervalYearMonthBuilder=ag;Y.IntervalYearMonthVector=mk;Y.JSONMessageReader=Xi;Y.List=ge;Y.ListBuilder=gg;Y.ListVector=zk;Y.MapBuilder=ig;Y.MapVector=Ak;Y.Map_=Ce;
Y.Message=vi;Y.MessageHeader=F;Y.MessageReader=Vi;Y.MetadataVersion=Hb;Y.Null=Wc;Y.NullBuilder=df;Y.NullVector=Bk;Y.Precision=Pb;Y.RecordBatch=qj;Y.RecordBatchFileReader=Wl;Y.RecordBatchFileWriter=Hj;Y.RecordBatchJSONWriter=Ij;Y.RecordBatchReader=Ml;Y.RecordBatchStreamReader=Ol;Y.RecordBatchStreamWriter=Gj;Y.RecordBatchWriter=Cj;Y.Schema=M;Y.SparseUnion=te;Y.SparseUnionBuilder=lg;Y.SparseUnionVector=Qk;Y.Struct=ke;Y.StructBuilder=jg;Y.StructVector=Dk;Y.Table=S;Y.Time=Ld;Y.TimeBuilder=Pf;
Y.TimeMicrosecond=Rd;Y.TimeMicrosecondBuilder=Sf;Y.TimeMicrosecondVector=Mk;Y.TimeMillisecond=Qd;Y.TimeMillisecondBuilder=Rf;Y.TimeMillisecondVector=Lk;Y.TimeNanosecond=Sd;Y.TimeNanosecondBuilder=Tf;Y.TimeNanosecondVector=Nk;Y.TimeSecond=Pd;Y.TimeSecondBuilder=Qf;Y.TimeSecondVector=Kk;Y.TimeUnit=C;Y.TimeVector=Jk;Y.Timestamp=Td;Y.TimestampBuilder=Uf;Y.TimestampMicrosecond=Zd;Y.TimestampMicrosecondBuilder=Xf;Y.TimestampMicrosecondVector=Hk;Y.TimestampMillisecond=Yd;Y.TimestampMillisecondBuilder=Wf;
Y.TimestampMillisecondVector=Gk;Y.TimestampNanosecond=$d;Y.TimestampNanosecondBuilder=Yf;Y.TimestampNanosecondVector=Ik;Y.TimestampSecond=Xd;Y.TimestampSecondBuilder=Vf;Y.TimestampSecondVector=Fk;Y.TimestampVector=Ek;Y.Type=G;Y.Uint16=fd;Y.Uint16Builder=Mf;Y.Uint16Vector=wk;Y.Uint32=gd;Y.Uint32Builder=Nf;Y.Uint32Vector=xk;Y.Uint64=hd;Y.Uint64Builder=Of;Y.Uint64Vector=yk;Y.Uint8=ed;Y.Uint8Builder=Lf;Y.Uint8Vector=vk;Y.Union=oe;Y.UnionBuilder=kg;Y.UnionMode=Nb;Y.UnionVector=Ok;Y.Utf8=td;
Y.Utf8Builder=cg;Y.Utf8Vector=Rk;Y.Vector=B;Y.Visitor=ng;Y.isTypedArray=Uh;Y.predicate=X;Y.util=Fm;Object.assign(arguments[0],Y);}.bind(this))));

//# sourceMappingURL=Arrow.es2015.min.js.map
