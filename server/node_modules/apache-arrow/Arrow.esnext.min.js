// Licensed to the Apache Software Foundation (ASF) under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The ASF licenses this file
// to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.  You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing,
// software distributed under the License is distributed on an
// "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
// KIND, either express or implied.  See the License for the
// specific language governing permissions and limitations
// under the License.
(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :
    typeof define === 'function' && define.amd ? define(['exports'], factory) :
    (factory(global.Arrow = global.Arrow || {}));
}(this, (function (exports) {'use strict';var g,aa=new Int32Array(2);new Float32Array(aa.buffer);new Float64Array(aa.buffer);new Uint16Array((new Uint8Array([1,0])).buffer);function ba(a,b){this.low=a|0;this.high=b|0}ba.prototype.equals=function(a){return this.low==a.low&&this.high==a.high};var ca=new ba(0,0);function da(){this.g=new ea(new Uint8Array(1024));this.B=1024;this.Fa=1;this.$=null;this.Db=0;this.Ea=!1;this.yb=0;this.Ga=[];this.Cb=0;this.ma=!1}g=da.prototype;
g.clear=function(){this.g.clear();this.B=this.g.m.length;this.Fa=1;this.$=null;this.Db=0;this.Ea=!1;this.yb=0;this.Ga=[];this.Cb=0;this.ma=!1};function ha(a){return a.g.R().subarray(a.g.position(),a.g.position()+a.offset())}
function ia(a,b,c){b>a.Fa&&(a.Fa=b);for(var d=~(a.g.m.length-a.B+c)+1&b-1;a.B<d+b+c;){var e=a.g.m.length,f=a,h=a.g,k=h.m.length;if(k&3221225472)throw Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");var n=k<<1,p=new ea(new Uint8Array(n));p.setPosition(n-k);p.R().set(h.R(),n-k);f.g=p;a.B+=a.g.m.length-e}ja(a,d)}function ja(a,b){for(var c=0;c<b;c++)a.g.ra(--a.B,0)}g.ra=function(a){this.g.ra(--this.B,a)};g.Eb=function(a){this.g.Eb(this.B-=2,a)};g.W=function(a){this.g.W(this.B-=4,a)};
g.aa=function(a){this.g.aa(this.B-=8,a)};function ka(a,b){ia(a,2,0);a.Eb(b)}function la(a,b){ia(a,4,0);a.W(b)}function ma(a,b,c,d){if(a.ma||c!=d)ia(a,1,0),a.ra(c),a.slot(b)}function na(a,b,c){if(a.ma||b!=c)ka(a,b),a.slot(0)}function oa(a,b,c,d){if(a.ma||c!=d)la(a,c),a.slot(b)}function pa(a,b,c,d){if(a.ma||!c.equals(d))ia(a,8,0),a.aa(c),a.slot(b)}function l(a,b,c){if(a.ma||0!=c)qa(a,c),a.slot(b)}function ra(a){if(a.Ea)throw Error("FlatBuffers: object serialization must not be nested.");}
g.slot=function(a){this.$[a]=this.offset()};g.offset=function(){return this.g.m.length-this.B};function qa(a,b){ia(a,4,0);a.W(a.offset()-b+4)}function m(a,b){ra(a);null==a.$&&(a.$=[]);a.Db=b;for(var c=0;c<b;c++)a.$[c]=0;a.Ea=!0;a.yb=a.offset()}
function q(a){if(null==a.$||!a.Ea)throw Error("FlatBuffers: endObject called without startObject");la(a,0);for(var b=a.offset(),c=a.Db-1;0<=c&&0==a.$[c];c--);for(var d=c+1;0<=c;c--)ka(a,0!=a.$[c]?b-a.$[c]:0);ka(a,b-a.yb);d=2*(d+2);ka(a,d);var e=0,f=a.B;c=0;a:for(;c<a.Ga.length;c++){var h=a.g.m.length-a.Ga[c];if(d==sa(a.g,h)){for(var k=2;k<d;k+=2)if(sa(a.g,f+k)!=sa(a.g,h+k))continue a;e=a.Ga[c];break}}e?(a.B=a.g.m.length-b,a.g.W(a.B,e-b)):(a.Ga.push(a.offset()),a.g.W(a.g.m.length-b,a.offset()-b));
a.Ea=!1;return b}g.finish=function(a,b,c){c=c?4:0;if(b){ia(this,this.Fa,8+c);if(4!=b.length)throw Error("FlatBuffers: file identifier must be length 4");for(var d=3;0<=d;d--)this.ra(b.charCodeAt(d))}ia(this,this.Fa,4+c);qa(this,a);c&&la(this,this.g.m.length-this.B);this.g.setPosition(this.B)};function ta(a,b,c,d){ra(a);a.Cb=c;ia(a,4,b*c);ia(a,d,b*c)}function ua(a){a.W(a.Cb);return a.offset()}
function va(a,b){if(b instanceof Uint8Array)var c=b;else{c=[];for(var d=0;d<b.length;){var e=b.charCodeAt(d++);if(!(55296>e||56320<=e)){var f=b.charCodeAt(d++);e=(e<<10)+f+-56613888}128>e?c.push(e):(2048>e?c.push(e>>6&31|192):(65536>e?c.push(e>>12&15|224):c.push(e>>18&7|240,e>>12&63|128),c.push(e>>6&63|128)),c.push(e&63|128))}}ia(a,1,0);a.ra(0);ta(a,1,c.length,1);a.g.setPosition(a.B-=c.length);d=0;b=a.B;for(e=a.g.R();d<c.length;d++)e[b++]=c[d];return ua(a)}
g.U=function(a,b){return 0==a&&0==b?ca:new ba(a,b)};function ea(a){this.m=a;this.zb=0}g=ea.prototype;g.clear=function(){this.zb=0};g.R=function(){return this.m};g.position=function(){return this.zb};g.setPosition=function(a){this.zb=a};function wa(a,b){return a.m[b]}function sa(a,b){return(a.m[b]|a.m[b+1]<<8)<<16>>16}g.v=function(a){return this.m[a]|this.m[a+1]<<8|this.m[a+2]<<16|this.m[a+3]<<24};function xa(a,b){return new ba(a.v(b),a.v(b+4))}g.ra=function(a,b){this.m[a]=b};
g.Eb=function(a,b){this.m[a]=b;this.m[a+1]=b>>8};g.W=function(a,b){this.m[a]=b;this.m[a+1]=b>>8;this.m[a+2]=b>>16;this.m[a+3]=b>>24};g.aa=function(a,b){this.W(a,b.low);this.W(a+4,b.high)};function r(a,b,c){b-=a.v(b);return c<sa(a,b)?sa(a,b+c):0}function ya(a,b,c){b.h=c+a.v(c);b.g=a;return b}
function za(a,b,c){b+=a.v(b);var d=a.v(b),e="",f=0;b+=4;if(1===c)return a.m.subarray(b,b+d);for(;f<d;){c=wa(a,b+f++);if(!(192>c)){var h=wa(a,b+f++);if(224>c)c=(c&31)<<6|h&63;else{var k=wa(a,b+f++);if(240>c)c=(c&15)<<12|(h&63)<<6|k&63;else{var n=wa(a,b+f++);c=(c&7)<<18|(h&63)<<12|(k&63)<<6|n&63}}}65536>c?e+=String.fromCharCode(c):(c-=65536,e+=String.fromCharCode((c>>10)+55296,(c&1023)+56320))}return e}function Aa(a,b){return b+a.v(b)}function Ba(a,b){return b+a.v(b)+4}
function Ca(a,b){return a.v(b+a.v(b))}g.U=function(a,b){return 0==a&&0==b?ca:new ba(a,b)};const Da=new TextDecoder("utf-8"),Ea=a=>Da.decode(a),Fa=new TextEncoder;const t=Object.freeze({done:!0,value:void 0});class Ga{constructor(a){this.wa=a}get schema(){return this.wa.schema}get ea(){return this.wa.batches||[]}get dictionaries(){return this.wa.dictionaries||[]}}function Ha(a){return a.Fb||(a.Fb=a.toDOMStream())}function Ia(a,b,c){return Ia(a.Nb||(a.Nb=a.toNodeStream()),b,c)}class Ja{tee(){return Ha(this).tee()}pipeTo(a,b){return Ha(this).pipeTo(a,b)}pipeThrough(a,b){return Ha(this).pipeThrough(a,b)}}
class Ka extends Ja{constructor(){super();this.l=[];this.qa=[];this.gb=new Promise(a=>this.K=a)}get closed(){return this.gb}async cancel(a){await this.return(a)}write(a){if(!this.K)throw Error("AsyncQueue is closed");0>=this.qa.length?this.l.push(a):this.qa.shift().resolve({done:!1,value:a})}abort(a){this.K&&(0>=this.qa.length?this.ib={error:a}:this.qa.shift().reject({done:!0,value:a}))}close(){if(this.K){const a=this.qa;for(;0<a.length;)a.shift().resolve(t);this.K();this.K=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(a){return La(this.K||
this.ib?this:this.l,a)}toNodeStream(){return Ma()}async throw(a){await this.abort(a);return t}async return(){await this.close();return t}async read(a){return(await this.next(a,"read")).value}async peek(a){return(await this.next(a,"peek")).value}next(){return 0<this.l.length?Promise.resolve({done:!1,value:this.l.shift()}):this.ib?Promise.reject({done:!0,value:this.ib.error}):this.K?new Promise((a,b)=>{this.qa.push({resolve:a,reject:b})}):Promise.resolve(t)}};const [Na,Oa]=(()=>{function a(){throw b();}const b=()=>{throw Error("BigInt is not available in this environment");};a.asIntN=()=>{throw b();};a.asUintN=()=>{throw b();};return"undefined"!==typeof BigInt?[BigInt,!0]:[a,!1]})(),[Pa]=(()=>{const a=()=>{throw Error("BigInt64Array is not available in this environment");};class b{static get BYTES_PER_ELEMENT(){return 8}static of(){throw a();}static from(){throw a();}constructor(){throw a();}}return"undefined"!==typeof BigInt64Array?[BigInt64Array,!0]:
[b,!1]})(),[Qa]=(()=>{const a=()=>{throw Error("BigUint64Array is not available in this environment");};class b{static get BYTES_PER_ELEMENT(){return 8}static of(){throw a();}static from(){throw a();}constructor(){throw a();}}return"undefined"!==typeof BigUint64Array?[BigUint64Array,!0]:[b,!1]})(),u=a=>"function"===typeof a,v=a=>null!=a&&Object(a)===a,Ra=a=>v(a)&&u(a[Symbol.iterator]),Sa=a=>v(a)&&u(a[Symbol.asyncIterator]),Ta=a=>v(a)&&u(a.cancel)&&u(a.getReader)&&!(a instanceof Ja),Ua=a=>v(a)&&u(a.read)&&
u(a.pipe)&&"boolean"===typeof a.readable&&!(a instanceof Ja);const Va="undefined"!==typeof SharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;function Wa(a){const b=a[0]?[a[0]]:[];let c,d,e,f;for(let h,k,n=0,p=0,w=a.length;++n<w;)h=b[p],k=a[n],!h||!k||h.buffer!==k.buffer||k.byteOffset<h.byteOffset?k&&(b[++p]=k):({byteOffset:c,byteLength:e}=h,{byteOffset:d,byteLength:f}=k,c+e<d||d+f<c?k&&(b[++p]=k):b[p]=new Uint8Array(h.buffer,c,d-c+f));return b}
function Xa(a,b,c=0,d=b.byteLength){const e=a.byteLength,f=new Uint8Array(a.buffer,a.byteOffset,e);b=new Uint8Array(b.buffer,b.byteOffset,Math.min(d,e));f.set(b,c);return a}
function Ya(a,b){a=Wa(a);const c=a.reduce((n,p)=>n+p.byteLength,0);let d,e,f=0,h=-1;const k=Math.min(b||Infinity,c);for(let n=a.length;++h<n;){b=a[h];d=b.subarray(0,Math.min(b.length,k-f));if(k<=f+d.length){d.length<b.length?a[h]=b.subarray(d.length):d.length===b.length&&h++;e?Xa(e,d,f):e=d;break}Xa(e||(e=new Uint8Array(k)),d,f);f+=d.length}return[e||new Uint8Array(0),a.slice(h),c-(e?e.byteLength:0)]}
function x(a,b){b=v(b)&&"done"in b&&"value"in b?b.value:b;if(b instanceof a)return a===Uint8Array?new a(b.buffer,b.byteOffset,b.byteLength):b;if(!b)return new a(0);"string"===typeof b&&(b=Fa.encode(b));return b instanceof ArrayBuffer||b instanceof Va?new a(b):b instanceof ea?x(a,b.R()):ArrayBuffer.isView(b)?0>=b.byteLength?new a(0):new a(b.buffer,b.byteOffset,b.byteLength/a.BYTES_PER_ELEMENT):a.from(b)}const Za=a=>{a.next();return a};
function*$a(a,b){function*c(d){yield d}b="string"===typeof b?c(b):ArrayBuffer.isView(b)?c(b):b instanceof ArrayBuffer?c(b):b instanceof Va?c(b):Ra(b)?b:c(b);yield*Za(function*(d){let e=null;do e=d.next(yield x(a,e));while(!e.done)}(b[Symbol.iterator]()));return new a}
async function*ab(a,b){async function*c(e){yield*Za(function*(f){let h=null;do h=f.next(yield h?.value);while(!h.done)}(e[Symbol.iterator]()))}async function*d(e){yield await e}if(v(b)&&u(b.then))return yield*ab(a,await b);b="string"===typeof b?d(b):ArrayBuffer.isView(b)?d(b):b instanceof ArrayBuffer?d(b):b instanceof Va?d(b):Ra(b)?c(b):Sa(b)?b:d(b);yield*Za(async function*(e){let f=null;do f=await e.next(yield x(a,f));while(!f.done)}(b[Symbol.asyncIterator]()));return new a}
function bb(a,b,c){if(0!==a){c=c.slice(0,b+1);for(let d=-1;++d<=b;)c[d]+=a}return c}function cb(a,b){let c=0;const d=a.length;if(d!==b.length)return!1;if(0<d){do if(a[c]!==b[c])return!1;while(++c<d)}return!0}var y={};y.compareArrayLike=cb;y.joinUint8Arrays=Ya;y.memcpy=Xa;y.rebaseValueOffsets=bb;y.toArrayBufferView=x;y.toArrayBufferViewAsyncIterator=ab;y.toArrayBufferViewIterator=$a;y.toBigInt64Array=a=>x(Pa,a);y.toBigUint64Array=a=>x(Qa,a);y.toFloat32Array=a=>x(Float32Array,a);
y.toFloat32ArrayAsyncIterator=a=>ab(Float32Array,a);y.toFloat32ArrayIterator=a=>$a(Float32Array,a);y.toFloat64Array=a=>x(Float64Array,a);y.toFloat64ArrayAsyncIterator=a=>ab(Float64Array,a);y.toFloat64ArrayIterator=a=>$a(Float64Array,a);y.toInt16Array=a=>x(Int16Array,a);y.toInt16ArrayAsyncIterator=a=>ab(Int16Array,a);y.toInt16ArrayIterator=a=>$a(Int16Array,a);y.toInt32Array=a=>x(Int32Array,a);y.toInt32ArrayAsyncIterator=a=>ab(Int32Array,a);y.toInt32ArrayIterator=a=>$a(Int32Array,a);
y.toInt8Array=a=>x(Int8Array,a);y.toInt8ArrayAsyncIterator=a=>ab(Int8Array,a);y.toInt8ArrayIterator=a=>$a(Int8Array,a);y.toUint16Array=a=>x(Uint16Array,a);y.toUint16ArrayAsyncIterator=a=>ab(Uint16Array,a);y.toUint16ArrayIterator=a=>$a(Uint16Array,a);y.toUint32Array=a=>x(Uint32Array,a);y.toUint32ArrayAsyncIterator=a=>ab(Uint32Array,a);y.toUint32ArrayIterator=a=>$a(Uint32Array,a);y.toUint8Array=a=>x(Uint8Array,a);y.toUint8ArrayAsyncIterator=a=>ab(Uint8Array,a);
y.toUint8ArrayIterator=a=>$a(Uint8Array,a);y.toUint8ClampedArray=a=>x(Uint8ClampedArray,a);y.toUint8ClampedArrayAsyncIterator=a=>ab(Uint8ClampedArray,a);y.toUint8ClampedArrayIterator=a=>$a(Uint8ClampedArray,a);function La(){throw Error('"toDOMStream" not available in this environment');}function Ma(){throw Error('"toNodeStream" not available in this environment');}const db=a=>{a.next();return a};
function*eb(a){let b,c=!1,d=[],e,f,h,k=0;({Y:f,size:h}=yield null);a=$a(Uint8Array,a)[Symbol.iterator]();try{do if({done:b,value:e}=isNaN(h-k)?a.next(void 0):a.next(h-k),!b&&0<e.byteLength&&(d.push(e),k+=e.byteLength),b||h<=k){do{if("peek"===f)var n=Ya(d,h)[0];else[e,d,k]=Ya(d,h),n=e;({Y:f,size:h}=yield n)}while(h<k)}while(!b)}catch(p){(c=!0,"function"===typeof a.throw)&&a.throw(p)}finally{!1===c&&"function"===typeof a.return&&a.return(null)}return null}
async function*fb(a){let b,c=!1,d=[],e,f,h,k=0;({Y:f,size:h}=yield null);a=ab(Uint8Array,a)[Symbol.asyncIterator]();try{do if({done:b,value:e}=isNaN(h-k)?await a.next(void 0):await a.next(h-k),!b&&0<e.byteLength&&(d.push(e),k+=e.byteLength),b||h<=k){do{if("peek"===f)var n=Ya(d,h)[0];else[e,d,k]=Ya(d,h),n=e;({Y:f,size:h}=yield n)}while(h<k)}while(!b)}catch(p){(c=!0,"function"===typeof a.throw)&&await a.throw(p)}finally{!1===c&&"function"===typeof a.return&&await a.return(new Uint8Array(0))}return null}
async function*gb(a){let b=!1,c=!1,d=[],e,f,h,k=0;({Y:f,size:h}=yield null);const n=new hb(a);try{do if({done:b,value:e}=isNaN(h-k)?await n.read(void 0):await n.read(h-k),!b&&0<e.byteLength&&(d.push(x(Uint8Array,e)),k+=e.byteLength),b||h<=k){do{if("peek"===f)var p=Ya(d,h)[0];else[e,d,k]=Ya(d,h),p=e;({Y:f,size:h}=yield p)}while(h<k)}while(!b)}catch(w){c=!0,await n.cancel(w)}finally{!1===c?await n.cancel():a.locked&&n.releaseLock()}return null}
function ib(a){a.la&&a.releaseLock();a.ka||(a.ka=a.source.getReader({mode:"byob"}),a.ka.closed.catch(()=>{}));return a.V=a.ka}function jb(a){a.ka&&a.releaseLock();a.la||(a.la=a.source.getReader(),a.la.closed.catch(()=>{}));return a.V=a.la}async function kb(a,b){return await lb(ib(a),new ArrayBuffer(b),0,b)}
class hb{constructor(a){this.source=a;this.la=this.ka=null;try{this.Vb=!!(this.V=ib(this))}catch(b){this.Vb=!(this.V=jb(this))}}get closed(){return this.V?this.V.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.V&&this.V.releaseLock();this.V=this.ka=this.la=null}async cancel(a){const b=this.V,c=this.source;b&&await b.cancel(a).catch(()=>{});c&&c.locked&&this.releaseLock()}async read(a){if(0===a)return{done:null==this.V,value:new Uint8Array(0)};a=this.Vb&&"number"===typeof a?await kb(this,
a):await jb(this).read();!a.done&&(a.value=x(Uint8Array,a));return a}}async function lb(a,b,c,d){if(c>=d)return{done:!1,value:new Uint8Array(b,0,d)};const {done:e,value:f}=await a.read(new Uint8Array(b,c,d-c));return(c+=f.byteLength)<d&&!e?await lb(a,f.buffer,c,d):{done:e,value:new Uint8Array(f.buffer,0,c)}}const mb=(a,b)=>{const c=e=>d([b,e]);let d;return[b,c,new Promise(e=>(d=e)&&a.once(b,c))]};
async function*nb(a){function b(ob,Fb){w=p=null;return new Promise((vj,wj)=>{for(const [Gb,xj]of ob)a.off(Gb,xj);try{const Gb=a.destroy;Gb&&Gb.call(a,Fb);Fb=void 0}catch(Gb){Fb=Gb||Fb}finally{null!=Fb?wj(Fb):vj()}})}const c=[];let d="error",e=!1,f=null,h,k,n=0,p=[],w;({Y:h,size:k}=yield null);if(a.isTTY)return yield new Uint8Array(0),null;try{c[0]=mb(a,"end");c[1]=mb(a,"error");do{c[2]=mb(a,"readable");[d,f]=await Promise.race(c.map(ob=>ob[2]));if("error"===d)break;(e="end"===d)||(isFinite(k-n)?(w=
x(Uint8Array,a.read(k-n)),w.byteLength<k-n&&(w=x(Uint8Array,a.read(void 0)))):w=x(Uint8Array,a.read(void 0)),0<w.byteLength&&(p.push(w),n+=w.byteLength));if(e||k<=n){do{if("peek"===h)var fa=Ya(p,k)[0];else[w,p,n]=Ya(p,k),fa=w;({Y:h,size:k}=yield fa)}while(k<n)}}while(!e)}finally{await b(c,"error"===d?f:null)}return null};class z{}z.prototype.data=null;var A,pb=A||(A={});pb[pb.V1=0]="V1";pb[pb.V2=1]="V2";pb[pb.V3=2]="V3";pb[pb.V4=3]="V4";pb[pb.V5=4]="V5";var qb,rb=qb||(qb={});rb[rb.UNUSED=0]="UNUSED";rb[rb.DICTIONARY_REPLACEMENT=1]="DICTIONARY_REPLACEMENT";rb[rb.COMPRESSED_BODY=2]="COMPRESSED_BODY";var B,sb=B||(B={});sb[sb.Sparse=0]="Sparse";sb[sb.Dense=1]="Dense";var C,tb=C||(C={});tb[tb.HALF=0]="HALF";tb[tb.SINGLE=1]="SINGLE";tb[tb.DOUBLE=2]="DOUBLE";var ub,vb=ub||(ub={});vb[vb.DAY=0]="DAY";vb[vb.MILLISECOND=1]="MILLISECOND";var D,wb=D||(D={});
wb[wb.SECOND=0]="SECOND";wb[wb.MILLISECOND=1]="MILLISECOND";wb[wb.MICROSECOND=2]="MICROSECOND";wb[wb.NANOSECOND=3]="NANOSECOND";var xb,yb=xb||(xb={});yb[yb.YEAR_MONTH=0]="YEAR_MONTH";yb[yb.DAY_TIME=1]="DAY_TIME";var E,F=E||(E={});F[F.NONE=0]="NONE";F[F.Null=1]="Null";F[F.Int=2]="Int";F[F.FloatingPoint=3]="FloatingPoint";F[F.Binary=4]="Binary";F[F.Utf8=5]="Utf8";F[F.Bool=6]="Bool";F[F.Decimal=7]="Decimal";F[F.Date=8]="Date";F[F.Time=9]="Time";F[F.Timestamp=10]="Timestamp";F[F.Interval=11]="Interval";
F[F.List=12]="List";F[F.Struct_=13]="Struct_";F[F.Union=14]="Union";F[F.FixedSizeBinary=15]="FixedSizeBinary";F[F.FixedSizeList=16]="FixedSizeList";F[F.Map=17]="Map";F[F.Duration=18]="Duration";F[F.LargeBinary=19]="LargeBinary";F[F.LargeUtf8=20]="LargeUtf8";F[F.LargeList=21]="LargeList";var zb,Ab=zb||(zb={});Ab[Ab.DenseArray=0]="DenseArray";var Bb,Cb=Bb||(Bb={});Cb[Cb.Little=0]="Little";Cb[Cb.Big=1]="Big";
class Db{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}listSize(){const a=r(this.g,this.h,4);return a?this.g.v(this.h+a):0}}class Eb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}keysSorted(){const a=r(this.g,this.h,4);return a?!!(this.g.m[this.h+a]<<24>>24):!1}}
class Hb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}mode(){const a=r(this.g,this.h,4);return a?sa(this.g,this.h+a):B.Sparse}typeIds(a){const b=r(this.g,this.h,6);return b?this.g.v(Ba(this.g,this.h+b)+4*a):0}}class Ib{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}bitWidth(){const a=r(this.g,this.h,4);return a?this.g.v(this.h+a):0}isSigned(){const a=r(this.g,this.h,6);return a?!!(this.g.m[this.h+a]<<24>>24):!1}}
class Jb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}precision(){const a=r(this.g,this.h,4);return a?sa(this.g,this.h+a):C.HALF}}class Kb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}byteWidth(){const a=r(this.g,this.h,4);return a?this.g.v(this.h+a):0}}
class Lb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}precision(){const a=r(this.g,this.h,4);return a?this.g.v(this.h+a):0}scale(){const a=r(this.g,this.h,6);return a?this.g.v(this.h+a):0}bitWidth(){const a=r(this.g,this.h,8);return a?this.g.v(this.h+a):128}}class Mb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}unit(){const a=r(this.g,this.h,4);return a?sa(this.g,this.h+a):ub.MILLISECOND}}
class Nb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}unit(){const a=r(this.g,this.h,4);return a?sa(this.g,this.h+a):D.MILLISECOND}bitWidth(){const a=r(this.g,this.h,6);return a?this.g.v(this.h+a):32}}class Ob{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}unit(){const a=r(this.g,this.h,4);return a?sa(this.g,this.h+a):D.SECOND}timezone(a){const b=r(this.g,this.h,6);return b?za(this.g,this.h+b,a):null}}
class Pb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}unit(){const a=r(this.g,this.h,4);return a?sa(this.g,this.h+a):xb.YEAR_MONTH}}class Qb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}key(a){const b=r(this.g,this.h,4);return b?za(this.g,this.h+b,a):null}value(a){const b=r(this.g,this.h,6);return b?za(this.g,this.h+b,a):null}}function Rb(a){const b=r(a.g,a.h,6);return b?(new Ib).i(Aa(a.g,a.h+b),a.g):null}
class Sb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}id(){const a=r(this.g,this.h,4);return a?xa(this.g,this.h+a):this.g.U(0,0)}isOrdered(){const a=r(this.g,this.h,8);return a?!!(this.g.m[this.h+a]<<24>>24):!1}}function Tb(a,b){ta(a,4,b.length,4);for(let c=b.length-1;0<=c;c--)qa(a,b[c]);return ua(a)}function Ub(a,b){ta(a,4,b.length,4);for(let c=b.length-1;0<=c;c--)qa(a,b[c]);return ua(a)}function Vb(a){const b=r(a.g,a.h,14);return b?Ca(a.g,a.h+b):0}
class Wb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}name(a){const b=r(this.g,this.h,4);return b?za(this.g,this.h+b,a):null}nullable(){const a=r(this.g,this.h,6);return a?!!(this.g.m[this.h+a]<<24>>24):!1}type(a){const b=r(this.g,this.h,10);return b?ya(this.g,a,this.h+b):null}dictionary(a){const b=r(this.g,this.h,12);return b?(a||new Sb).i(Aa(this.g,this.h+b),this.g):null}children(a,b){const c=r(this.g,this.h,14);return c?(b||new Wb).i(Aa(this.g,Ba(this.g,this.h+c)+4*a),
this.g):null}Wa(a){const b=r(this.g,this.h,16);return b?(new Qb).i(Aa(this.g,Ba(this.g,this.h+b)+4*a),this.g):null}Xa(){const a=r(this.g,this.h,16);return a?Ca(this.g,this.h+a):0}}class Xb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}offset(){return xa(this.g,this.h)}length(){return xa(this.g,this.h+8)}}function Yb(a,b){ta(a,4,b.length,4);for(let c=b.length-1;0<=c;c--)qa(a,b[c]);return ua(a)}
function Zb(a,b){ta(a,4,b.length,4);for(let c=b.length-1;0<=c;c--)qa(a,b[c]);return ua(a)}function $b(a){const b=r(a.g,a.h,6);return b?Ca(a.g,a.h+b):0}
class ac{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}fields(a,b){const c=r(this.g,this.h,6);return c?(b||new Wb).i(Aa(this.g,Ba(this.g,this.h+c)+4*a),this.g):null}Wa(a){const b=r(this.g,this.h,8);return b?(new Qb).i(Aa(this.g,Ba(this.g,this.h+b)+4*a),this.g):null}Xa(){const a=r(this.g,this.h,8);return a?Ca(this.g,this.h+a):0}features(a){const b=r(this.g,this.h,10);return b?xa(this.g,Ba(this.g,this.h+b)+8*a):this.g.U(0,0)}};var bc,cc=bc||(bc={});cc[cc.LZ4_FRAME=0]="LZ4_FRAME";cc[cc.ZSTD=1]="ZSTD";var dc,ec=dc||(dc={});ec[ec.BUFFER=0]="BUFFER";var G,fc=G||(G={});fc[fc.NONE=0]="NONE";fc[fc.Schema=1]="Schema";fc[fc.DictionaryBatch=2]="DictionaryBatch";fc[fc.RecordBatch=3]="RecordBatch";fc[fc.Tensor=4]="Tensor";fc[fc.SparseTensor=5]="SparseTensor";class gc{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}length(){return xa(this.g,this.h)}nullCount(){return xa(this.g,this.h+8)}}
function hc(a,b){pa(a,0,b,a.U(0,0))}function ic(a){const b=r(a.g,a.h,6);return b?Ca(a.g,a.h+b):0}function jc(a){const b=r(a.g,a.h,8);return b?Ca(a.g,a.h+b):0}
class kc{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}length(){const a=r(this.g,this.h,4);return a?xa(this.g,this.h+a):this.g.U(0,0)}M(a,b){const c=r(this.g,this.h,6);return c?(b||new gc).i(Ba(this.g,this.h+c)+16*a,this.g):null}buffers(a,b){const c=r(this.g,this.h,8);return c?(b||new Xb).i(Ba(this.g,this.h+c)+16*a,this.g):null}}
class lc{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}id(){const a=r(this.g,this.h,4);return a?xa(this.g,this.h+a):this.g.U(0,0)}data(a){const b=r(this.g,this.h,6);return b?(a||new kc).i(Aa(this.g,this.h+b),this.g):null}Za(){const a=r(this.g,this.h,8);return a?!!(this.g.m[this.h+a]<<24>>24):!1}}
class mc{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}version(){const a=r(this.g,this.h,4);return a?sa(this.g,this.h+a):A.V1}headerType(){const a=r(this.g,this.h,6);return a?this.g.m[this.h+a]:G.NONE}header(a){const b=r(this.g,this.h,8);return b?ya(this.g,a,this.h+b):null}bodyLength(){const a=r(this.g,this.h,10);return a?xa(this.g,this.h+a):this.g.U(0,0)}Wa(a){const b=r(this.g,this.h,12);return b?(new Qb).i(Aa(this.g,Ba(this.g,this.h+b)+4*a),this.g):null}Xa(){const a=r(this.g,
this.h,12);return a?Ca(this.g,this.h+a):0}};var H,I=H||(H={});I[I.NONE=0]="NONE";I[I.Null=1]="Null";I[I.Int=2]="Int";I[I.Float=3]="Float";I[I.Binary=4]="Binary";I[I.Utf8=5]="Utf8";I[I.Bool=6]="Bool";I[I.Decimal=7]="Decimal";I[I.Date=8]="Date";I[I.Time=9]="Time";I[I.Timestamp=10]="Timestamp";I[I.Interval=11]="Interval";I[I.List=12]="List";I[I.Struct=13]="Struct";I[I.Union=14]="Union";I[I.FixedSizeBinary=15]="FixedSizeBinary";I[I.FixedSizeList=16]="FixedSizeList";I[I.Map=17]="Map";I[I.Dictionary=-1]="Dictionary";I[I.Int8=-2]="Int8";
I[I.Int16=-3]="Int16";I[I.Int32=-4]="Int32";I[I.Int64=-5]="Int64";I[I.Uint8=-6]="Uint8";I[I.Uint16=-7]="Uint16";I[I.Uint32=-8]="Uint32";I[I.Uint64=-9]="Uint64";I[I.Float16=-10]="Float16";I[I.Float32=-11]="Float32";I[I.Float64=-12]="Float64";I[I.DateDay=-13]="DateDay";I[I.DateMillisecond=-14]="DateMillisecond";I[I.TimestampSecond=-15]="TimestampSecond";I[I.TimestampMillisecond=-16]="TimestampMillisecond";I[I.TimestampMicrosecond=-17]="TimestampMicrosecond";I[I.TimestampNanosecond=-18]="TimestampNanosecond";
I[I.TimeSecond=-19]="TimeSecond";I[I.TimeMillisecond=-20]="TimeMillisecond";I[I.TimeMicrosecond=-21]="TimeMicrosecond";I[I.TimeNanosecond=-22]="TimeNanosecond";I[I.DenseUnion=-23]="DenseUnion";I[I.SparseUnion=-24]="SparseUnion";I[I.IntervalDayTime=-25]="IntervalDayTime";I[I.IntervalYearMonth=-26]="IntervalYearMonth";var J,nc=J||(J={});nc[nc.OFFSET=0]="OFFSET";nc[nc.DATA=1]="DATA";nc[nc.VALIDITY=2]="VALIDITY";nc[nc.TYPE=3]="TYPE";function oc(a,b,c,d){return 0!==(c&1<<d)}function pc(a,b,c,d){return(c&1<<d)>>d}function qc(a,b,c){return c?!!(a[b>>3]|=1<<b%8)||!0:!(a[b>>3]&=~(1<<b%8))&&!1}function rc(a,b,c){const d=c.byteLength+7&-8;if(0<a||c.byteLength<d){const e=new Uint8Array(d);e.set(0===a%8?c.subarray(a>>3):sc(new tc(c,a,b,null,oc)).subarray(0,d));return e}return c}
function sc(a){const b=[];let c=0,d=0,e=0;for(const f of a)f&&(e|=1<<d),8===++d&&(b[c++]=e,e=d=0);if(0===c||0<d)b[c++]=e;a=new Uint8Array(b.length+7&-8);a.set(b);return a}
class tc{constructor(a,b,c,d,e){this.R=a;this.length=c;this.context=d;this.get=e;this.sb=b%8;this.Sb=b>>3;this.Rb=a[this.Sb++];this.index=0}next(){return this.index<this.length?(8===this.sb&&(this.sb=0,this.Rb=this.R[this.Sb++]),{value:this.get(this.context,this.index++,this.Rb,this.sb++)}):{done:!0,value:null}}[Symbol.iterator](){return this}}
function uc(a,b,c){if(0>=c-b)return 0;if(8>c-b){var d=0;for(var e of new tc(a,b,c-b,a,pc))d+=e;return d}d=c>>3<<3;e=b+(0===b%8?0:8-b%8);return uc(a,b,e)+uc(a,d,c)+vc(a,e>>3,d-e>>3)}function vc(a,b,c){let d=0;b|=0;const e=new DataView(a.buffer,a.byteOffset,a.byteLength);for(a=void 0===c?a.byteLength:b+c;4<=a-b;)d+=wc(e.getUint32(b)),b+=4;for(;2<=a-b;)d+=wc(e.getUint16(b)),b+=2;for(;1<=a-b;)d+=wc(e.getUint8(b)),b+=1;return d}
function wc(a){a|=0;a-=a>>>1&1431655765;a=(a&858993459)+(a>>>2&858993459);return 16843009*(a+(a>>>4)&252645135)>>>24}var xc={};xc.BitIterator=tc;xc.getBit=pc;xc.getBool=oc;xc.packBools=sc;xc.popcnt_array=vc;xc.popcnt_bit_range=uc;xc.popcnt_uint32=wc;xc.setBool=qc;xc.truncateBitmap=rc;class K{static isNull(a){return a?.typeId===H.Null}static isInt(a){return a?.typeId===H.Int}static isFloat(a){return a?.typeId===H.Float}static isBinary(a){return a?.typeId===H.Binary}static isUtf8(a){return a?.typeId===H.Utf8}static isBool(a){return a?.typeId===H.Bool}static isDecimal(a){return a?.typeId===H.Decimal}static isDate(a){return a?.typeId===H.Date}static isTime(a){return a?.typeId===H.Time}static isTimestamp(a){return a?.typeId===H.Timestamp}static isInterval(a){return a?.typeId===H.Interval}static isList(a){return a?.typeId===
H.List}static isStruct(a){return a?.typeId===H.Struct}static isUnion(a){return a?.typeId===H.Union}static isFixedSizeBinary(a){return a?.typeId===H.FixedSizeBinary}static isFixedSizeList(a){return a?.typeId===H.FixedSizeList}static isMap(a){return a?.typeId===H.Map}static isDictionary(a){return a?.typeId===H.Dictionary}get typeId(){return H.NONE}}var yc=Symbol.toStringTag,zc,Ac=K.prototype;Ac.children=null;Ac.ArrayType=Array;zc=Ac[Symbol.toStringTag]="DataType";K[yc]=zc;
class Bc extends K{toString(){return"Null"}get typeId(){return H.Null}}Bc[Symbol.toStringTag]=Bc.prototype[Symbol.toStringTag]="Null";
class Cc extends K{constructor(a,b){super();this.isSigned=a;this.bitWidth=b}get typeId(){return H.Int}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?Int32Array:Uint32Array}throw Error(`Unrecognized ${this[Symbol.toStringTag]} type`);}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}
var Dc=Symbol.toStringTag,Ec,Fc=Cc.prototype;Fc.isSigned=null;Fc.bitWidth=null;Ec=Fc[Symbol.toStringTag]="Int";Cc[Dc]=Ec;class Gc extends Cc{constructor(){super(!0,8)}}class Hc extends Cc{constructor(){super(!0,16)}}class Ic extends Cc{constructor(){super(!0,32)}}class Jc extends Cc{constructor(){super(!0,64)}}class Kc extends Cc{constructor(){super(!1,8)}}class Lc extends Cc{constructor(){super(!1,16)}}class Mc extends Cc{constructor(){super(!1,32)}}
class Nc extends Cc{constructor(){super(!1,64)}}Object.defineProperty(Gc.prototype,"ArrayType",{value:Int8Array});Object.defineProperty(Hc.prototype,"ArrayType",{value:Int16Array});Object.defineProperty(Ic.prototype,"ArrayType",{value:Int32Array});Object.defineProperty(Jc.prototype,"ArrayType",{value:Int32Array});Object.defineProperty(Kc.prototype,"ArrayType",{value:Uint8Array});Object.defineProperty(Lc.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(Mc.prototype,"ArrayType",{value:Uint32Array});
Object.defineProperty(Nc.prototype,"ArrayType",{value:Uint32Array});class Oc extends K{constructor(a){super();this.precision=a}get typeId(){return H.Float}get ArrayType(){switch(this.precision){case C.HALF:return Uint16Array;case C.SINGLE:return Float32Array;case C.DOUBLE:return Float64Array}throw Error(`Unrecognized ${this[Symbol.toStringTag]} type`);}toString(){return`Float${this.precision<<5||16}`}}var Pc=Symbol.toStringTag,Qc,Rc=Oc.prototype;Rc.precision=null;Qc=Rc[Symbol.toStringTag]="Float";
Oc[Pc]=Qc;class Sc extends Oc{constructor(){super(C.HALF)}}class Tc extends Oc{constructor(){super(C.SINGLE)}}class Uc extends Oc{constructor(){super(C.DOUBLE)}}Object.defineProperty(Sc.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(Tc.prototype,"ArrayType",{value:Float32Array});Object.defineProperty(Uc.prototype,"ArrayType",{value:Float64Array});class Vc extends K{constructor(){super()}get typeId(){return H.Binary}toString(){return"Binary"}}var Wc=Symbol.toStringTag,Xc,Yc=Vc.prototype;
Yc.ArrayType=Uint8Array;Xc=Yc[Symbol.toStringTag]="Binary";Vc[Wc]=Xc;class Zc extends K{constructor(){super()}get typeId(){return H.Utf8}toString(){return"Utf8"}}var $c=Symbol.toStringTag,ad,bd=Zc.prototype;bd.ArrayType=Uint8Array;ad=bd[Symbol.toStringTag]="Utf8";Zc[$c]=ad;class cd extends K{constructor(){super()}get typeId(){return H.Bool}toString(){return"Bool"}}var dd=Symbol.toStringTag,ed,fd=cd.prototype;fd.ArrayType=Uint8Array;ed=fd[Symbol.toStringTag]="Bool";cd[dd]=ed;
class gd extends K{constructor(a,b){super();this.scale=a;this.precision=b}get typeId(){return H.Decimal}toString(){return`Decimal[${this.precision}e${0<this.scale?"+":""}${this.scale}]`}}var hd=Symbol.toStringTag,id,jd=gd.prototype;jd.scale=null;jd.precision=null;jd.ArrayType=Uint32Array;id=jd[Symbol.toStringTag]="Decimal";gd[hd]=id;class kd extends K{constructor(a){super();this.unit=a}get typeId(){return H.Date}toString(){return`Date${32*(this.unit+1)}<${ub[this.unit]}>`}}
var ld=Symbol.toStringTag,md,nd=kd.prototype;nd.unit=null;nd.ArrayType=Int32Array;md=nd[Symbol.toStringTag]="Date";kd[ld]=md;class od extends kd{constructor(){super(ub.DAY)}}class pd extends kd{constructor(){super(ub.MILLISECOND)}}class qd extends K{constructor(a,b){super();this.unit=a;this.bitWidth=b}get typeId(){return H.Time}toString(){return`Time${this.bitWidth}<${D[this.unit]}>`}}var rd=Symbol.toStringTag,sd,td=qd.prototype;td.unit=null;td.bitWidth=null;td.ArrayType=Int32Array;
sd=td[Symbol.toStringTag]="Time";qd[rd]=sd;class ud extends qd{constructor(){super(D.SECOND,32)}}class vd extends qd{constructor(){super(D.MILLISECOND,32)}}class wd extends qd{constructor(){super(D.MICROSECOND,64)}}class xd extends qd{constructor(){super(D.NANOSECOND,64)}}class yd extends K{constructor(a,b){super();this.unit=a;this.timezone=b}get typeId(){return H.Timestamp}toString(){return`Timestamp<${D[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}}var zd=Symbol.toStringTag,Ad,Bd=yd.prototype;
Bd.unit=null;Bd.timezone=null;Bd.ArrayType=Int32Array;Ad=Bd[Symbol.toStringTag]="Timestamp";yd[zd]=Ad;class Cd extends yd{constructor(a){super(D.SECOND,a)}}class Dd extends yd{constructor(a){super(D.MILLISECOND,a)}}class Ed extends yd{constructor(a){super(D.MICROSECOND,a)}}class Fd extends yd{constructor(a){super(D.NANOSECOND,a)}}class Gd extends K{constructor(a){super();this.unit=a}get typeId(){return H.Interval}toString(){return`Interval<${xb[this.unit]}>`}}var Hd=Symbol.toStringTag,Id,Jd=Gd.prototype;
Jd.unit=null;Jd.ArrayType=Int32Array;Id=Jd[Symbol.toStringTag]="Interval";Gd[Hd]=Id;class Kd extends Gd{constructor(){super(xb.DAY_TIME)}}class Ld extends Gd{constructor(){super(xb.YEAR_MONTH)}}class Md extends K{constructor(a){super();this.children=[a]}get typeId(){return H.List}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}}var Nd=Symbol.toStringTag,Od,Pd=Md.prototype;
Pd.children=null;Od=Pd[Symbol.toStringTag]="List";Md[Nd]=Od;class Qd extends K{constructor(a){super();this.children=a}get typeId(){return H.Struct}toString(){return`Struct<{${this.children.map(a=>`${a.name}:${a.type}`).join(", ")}}>`}}var Rd=Symbol.toStringTag,Sd,Td=Qd.prototype;Td.children=null;Sd=Td[Symbol.toStringTag]="Struct";Qd[Rd]=Sd;
class Ud extends K{constructor(a,b,c){super();this.mode=a;this.children=c;this.typeIds=b=Int32Array.from(b);this.typeIdToChildIndex=b.reduce((d,e,f)=>(d[e]=f)&&d||d,Object.create(null))}get typeId(){return H.Union}toString(){return`${this[Symbol.toStringTag]}<${this.children.map(a=>`${a.type}`).join(" | ")}>`}}var Vd=Symbol.toStringTag,Wd,Xd=Ud.prototype;Xd.mode=null;Xd.typeIds=null;Xd.children=null;Xd.typeIdToChildIndex=null;Xd.ArrayType=Int8Array;Wd=Xd[Symbol.toStringTag]="Union";Ud[Vd]=Wd;
class Yd extends Ud{constructor(a,b){super(B.Dense,a,b)}}class Zd extends Ud{constructor(a,b){super(B.Sparse,a,b)}}class $d extends K{constructor(a){super();this.byteWidth=a}get typeId(){return H.FixedSizeBinary}toString(){return`FixedSizeBinary[${this.byteWidth}]`}}var ae=Symbol.toStringTag,be,ce=$d.prototype;ce.byteWidth=null;ce.ArrayType=Uint8Array;be=ce[Symbol.toStringTag]="FixedSizeBinary";$d[ae]=be;
class de extends K{constructor(a,b){super();this.listSize=a;this.children=[b]}get typeId(){return H.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}var ee=Symbol.toStringTag,fe,ge=de.prototype;ge.children=null;ge.listSize=null;fe=ge[Symbol.toStringTag]="FixedSizeList";de[ee]=fe;
class he extends K{constructor(a,b=!1){super();this.children=[a];this.keysSorted=b}get typeId(){return H.Map}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}toString(){return`Map<{${this.children[0].type.children.map(a=>`${a.name}:${a.type}`).join(", ")}}>`}}var ie=Symbol.toStringTag,je,ke=he.prototype;ke.children=null;ke.keysSorted=null;je=ke[Symbol.toStringTag]="Map_";he[ie]=je;const le=(a=>()=>++a)(-1);
class me extends K{constructor(a,b,c,d){super();this.indices=b;this.dictionary=a;this.isOrdered=d||!1;this.id=null==c?le():"number"===typeof c?c:c.low}get typeId(){return H.Dictionary}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}}var ne=Symbol.toStringTag,oe,pe=me.prototype;pe.id=null;pe.indices=null;pe.isOrdered=null;pe.dictionary=null;
oe=pe[Symbol.toStringTag]="Dictionary";me[ne]=oe;function qe(a){switch(a.typeId){case H.Decimal:return 4;case H.Timestamp:return 2;case H.Date:return 1+a.unit;case H.Interval:return 1+a.unit;case H.Int:return 1+ +(32<a.bitWidth);case H.Time:return 1+ +(32<a.bitWidth);case H.FixedSizeList:return a.listSize;case H.FixedSizeBinary:return a.byteWidth;default:return 1}};function re(a,b,c){return a.map(d=>d.slice(b,c))}function se(a,b){if(a.typeId===H.Null)return a.clone(a.type,0,b,0);const c=a.length,d=a.nullCount,e=(new Uint8Array((b+63&-64)>>3)).fill(255,0,c>>3);e[c>>3]=(1<<c-(c&-8))-1;0<d&&e.set(rc(a.offset,c,a.nullBitmap),0);const f=a.buffers;f[J.VALIDITY]=e;return a.clone(a.type,0,b,d+(b-c),f)}
class L{constructor(a,b,c,d,e,f,h){this.type=a;this.dictionary=h;this.offset=Math.floor(Math.max(b||0,0));this.length=Math.floor(Math.max(c||0,0));this.da=Math.floor(Math.max(d||0,-1));this.childData=(f||[]).map(n=>n instanceof L?n:n.data);let k;e instanceof L?(this.stride=e.stride,this.values=e.values,this.typeIds=e.typeIds,this.nullBitmap=e.nullBitmap,this.valueOffsets=e.valueOffsets):(this.stride=qe(a),e&&((k=e[0])&&(this.valueOffsets=k),(k=e[1])&&(this.values=k),(k=e[2])&&(this.nullBitmap=k),
(k=e[3])&&(this.typeIds=k)))}get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get byteLength(){let a=0;const b=this.valueOffsets,c=this.values,d=this.nullBitmap,e=this.typeIds;b&&(a+=b.byteLength);c&&(a+=c.byteLength);d&&(a+=d.byteLength);e&&(a+=e.byteLength);return this.childData.reduce((f,h)=>f+h.byteLength,a)}get nullCount(){let a=this.da,b;-1>=a&&(b=this.nullBitmap)&&(this.da=a=this.length-
uc(b,this.offset,this.offset+this.length));return a}clone(a,b=this.offset,c=this.length,d=this.da,e=this,f=this.childData){return new L(a,b,c,d,e,f,this.dictionary)}slice(a,b){const c=this.stride,d=this.typeId,e=this.childData,f=+(0===this.da)-1,h=16===d?c:1;let k;const n=this.buffers;(k=n[J.TYPE])&&(n[J.TYPE]=k.subarray(a,a+b));(k=n[J.OFFSET])&&(n[J.OFFSET]=k.subarray(a,a+b+1))||(k=n[J.DATA])&&(n[J.DATA]=6===d?k:k.subarray(c*a,c*(a+b)));return this.clone(this.type,this.offset+a,b,f,n,!e.length||
this.valueOffsets?e:re(e,h*a,h*b))}static new(a,b,c,d,e,f,h){e instanceof L?e=e.buffers:e||(e=[]);switch(a.typeId){case H.Null:return L.Null(a,b,c);case H.Int:return L.Int(a,b,c,d||0,e[J.VALIDITY],e[J.DATA]||[]);case H.Dictionary:return L.Dictionary(a,b,c,d||0,e[J.VALIDITY],e[J.DATA]||[],h);case H.Float:return L.Float(a,b,c,d||0,e[J.VALIDITY],e[J.DATA]||[]);case H.Bool:return L.Bool(a,b,c,d||0,e[J.VALIDITY],e[J.DATA]||[]);case H.Decimal:return L.Decimal(a,b,c,d||0,e[J.VALIDITY],e[J.DATA]||[]);case H.Date:return L.Date(a,
b,c,d||0,e[J.VALIDITY],e[J.DATA]||[]);case H.Time:return L.Time(a,b,c,d||0,e[J.VALIDITY],e[J.DATA]||[]);case H.Timestamp:return L.Timestamp(a,b,c,d||0,e[J.VALIDITY],e[J.DATA]||[]);case H.Interval:return L.Interval(a,b,c,d||0,e[J.VALIDITY],e[J.DATA]||[]);case H.FixedSizeBinary:return L.FixedSizeBinary(a,b,c,d||0,e[J.VALIDITY],e[J.DATA]||[]);case H.Binary:return L.Binary(a,b,c,d||0,e[J.VALIDITY],e[J.OFFSET]||[],e[J.DATA]||[]);case H.Utf8:return L.Utf8(a,b,c,d||0,e[J.VALIDITY],e[J.OFFSET]||[],e[J.DATA]||
[]);case H.List:return L.List(a,b,c,d||0,e[J.VALIDITY],e[J.OFFSET]||[],(f||[])[0]);case H.FixedSizeList:return L.FixedSizeList(a,b,c,d||0,e[J.VALIDITY],(f||[])[0]);case H.Struct:return L.Struct(a,b,c,d||0,e[J.VALIDITY],f||[]);case H.Map:return L.Map(a,b,c,d||0,e[J.VALIDITY],e[J.OFFSET]||[],(f||[])[0]);case H.Union:return L.Union(a,b,c,d||0,e[J.VALIDITY],e[J.TYPE]||[],e[J.OFFSET]||f,f)}throw Error(`Unrecognized typeId ${a.typeId}`);}static Null(a,b,c){return new L(a,b,c,0)}static Int(a,b,c,d,e,f){return new L(a,
b,c,d,[void 0,x(a.ArrayType,f),x(Uint8Array,e)])}static Dictionary(a,b,c,d,e,f,h){return new L(a,b,c,d,[void 0,x(a.indices.ArrayType,f),x(Uint8Array,e)],[],h)}static Float(a,b,c,d,e,f){return new L(a,b,c,d,[void 0,x(a.ArrayType,f),x(Uint8Array,e)])}static Bool(a,b,c,d,e,f){return new L(a,b,c,d,[void 0,x(a.ArrayType,f),x(Uint8Array,e)])}static Decimal(a,b,c,d,e,f){return new L(a,b,c,d,[void 0,x(a.ArrayType,f),x(Uint8Array,e)])}static Date(a,b,c,d,e,f){return new L(a,b,c,d,[void 0,x(a.ArrayType,f),
x(Uint8Array,e)])}static Time(a,b,c,d,e,f){return new L(a,b,c,d,[void 0,x(a.ArrayType,f),x(Uint8Array,e)])}static Timestamp(a,b,c,d,e,f){return new L(a,b,c,d,[void 0,x(a.ArrayType,f),x(Uint8Array,e)])}static Interval(a,b,c,d,e,f){return new L(a,b,c,d,[void 0,x(a.ArrayType,f),x(Uint8Array,e)])}static FixedSizeBinary(a,b,c,d,e,f){return new L(a,b,c,d,[void 0,x(a.ArrayType,f),x(Uint8Array,e)])}static Binary(a,b,c,d,e,f,h){return new L(a,b,c,d,[x(Int32Array,f),x(Uint8Array,h),x(Uint8Array,e)])}static Utf8(a,
b,c,d,e,f,h){return new L(a,b,c,d,[x(Int32Array,f),x(Uint8Array,h),x(Uint8Array,e)])}static List(a,b,c,d,e,f,h){return new L(a,b,c,d,[x(Int32Array,f),void 0,x(Uint8Array,e)],h?[h]:[])}static FixedSizeList(a,b,c,d,e,f){return new L(a,b,c,d,[void 0,void 0,x(Uint8Array,e)],f?[f]:[])}static Struct(a,b,c,d,e,f){return new L(a,b,c,d,[void 0,void 0,x(Uint8Array,e)],f)}static Map(a,b,c,d,e,f,h){return new L(a,b,c,d,[x(Int32Array,f),void 0,x(Uint8Array,e)],h?[h]:[])}static Union(a,b,c,d,e,f,h,k){e=[void 0,
void 0,x(Uint8Array,e),x(a.ArrayType,f)];if(a.mode===B.Sparse)return new L(a,b,c,d,e,h);e[J.OFFSET]=x(Int32Array,h);return new L(a,b,c,d,e,k)}}L.prototype.childData=Object.freeze([]);function te(a){if(null===a)return"null";if(void 0===a)return"undefined";switch(typeof a){case "number":return`${a}`;case "bigint":return`${a}`;case "string":return`"${a}"`}return"function"===typeof a[Symbol.toPrimitive]?a[Symbol.toPrimitive]("string"):ArrayBuffer.isView(a)?`[${a}]`:JSON.stringify(a)};function ue(a){if(!a||0>=a.length)return function(){return!0};let b="";const c=a.filter(d=>d===d);0<c.length&&(b=`
    switch (x) {${c.map(d=>`
        case ${"bigint"!==typeof d?te(d):Oa?`${te(d)}n`:`"${te(d)}"`}:`).join("")}
            return false;
    }`);a.length!==c.length&&(b=`if (x !== x) return false;\n${b}`);return new Function("x",`${b}\nreturn true;`)};const ve=(a,b)=>(a*b+63&-64||64)/b,we=(a,b=0)=>a.length>=b?a.subarray(0,b):Xa(new a.constructor(b),a,0);function xe(a,b){if(0<b){a.length+=b;b=a.length*a.stride;const c=a.buffer.length;b>=c&&a.Aa(0===c?ve(1*b,a.BYTES_PER_ELEMENT):ve(2*b,a.BYTES_PER_ELEMENT))}return a}
class ye{constructor(a,b=1){this.buffer=a;this.stride=b;this.BYTES_PER_ELEMENT=a.BYTES_PER_ELEMENT;this.ArrayType=a.constructor;this.Aa(this.length=a.length/b|0)}get byteLength(){return this.length*this.stride*this.BYTES_PER_ELEMENT|0}get reservedLength(){return this.buffer.length/this.stride}get reservedByteLength(){return this.buffer.byteLength}set(){return this}append(a){return this.set(this.length,a)}flush(a=this.length){a=ve(a*this.stride,this.BYTES_PER_ELEMENT);a=we(this.buffer,a);this.clear();
return a}clear(){this.length=0;this.Aa(0);return this}Aa(a){return this.buffer=Xa(new this.ArrayType(a),this.buffer)}}ye.prototype.offset=0;class ze extends ye{get(a){return this.buffer[a]}set(a,b){xe(this,a-this.length+1);this.buffer[a*this.stride]=b;return this}}
class Ae extends ze{constructor(){super(new Uint8Array(0),.125);this.$a=0}get rc(){return this.length-this.$a}get(a){return this.buffer[a>>3]>>a%8&1}set(a,b){const {buffer:c}=xe(this,a-this.length+1),d=a>>3;a%=8;const e=c[d]>>a&1;b?0===e&&(c[d]|=1<<a,++this.$a):1===e&&(c[d]&=~(1<<a),--this.$a);return this}clear(){this.$a=0;return super.clear()}}
class Be extends ze{constructor(){super(new Int32Array(1),1)}append(a){return this.set(this.length-1,a)}set(a,b){const c=this.length-1,d=xe(this,a-c+1).buffer;c<a++&&d.fill(d[c],c,a);d[a]=d[a-1]+b;return this}flush(a=this.length-1){a>this.length&&this.set(a-1,0);return super.flush(a+1)}}
class Ce extends ye{get Xb(){return this.Zb||(this.Zb=this.buffer instanceof Int32Array?Pa:Qa)}set(a,b){xe(this,a-this.length+1);switch(typeof b){case "bigint":this.tb[a]=b;break;case "number":this.buffer[a*this.stride]=b;break;default:this.buffer.set(b,a*this.stride)}return this}Aa(a){a=super.Aa(a);const b=a.byteLength/(this.BYTES_PER_ELEMENT*this.stride);Oa&&(this.tb=new this.Xb(a.buffer,a.byteOffset,b));return a}};class M{constructor({type:a,nullValues:b}){this.length=0;this.finished=!1;this.type=a;this.children=[];this.nullValues=b;this.stride=qe(a);this.G=new Ae;b&&0<b.length&&(this.Lb=ue(b))}static new(){}static throughNode(){throw Error('"throughNode" not available in this environment');}static throughDOM(){throw Error('"throughDOM" not available in this environment');}static throughIterable(a){return De(a)}static throughAsyncIterable(a){return Ee(a)}toVector(){return z.new(this.flush())}get ArrayType(){return this.type.ArrayType}get nullCount(){return this.G.rc}get numChildren(){return this.children.length}get byteLength(){let a=
0;this.C&&(a+=this.C.byteLength);this.l&&(a+=this.l.byteLength);this.G&&(a+=this.G.byteLength);this.T&&(a+=this.T.byteLength);return this.children.reduce((b,c)=>b+c.byteLength,a)}get reservedLength(){return this.G.reservedLength}get reservedByteLength(){let a=0;this.C&&(a+=this.C.reservedByteLength);this.l&&(a+=this.l.reservedByteLength);this.G&&(a+=this.G.reservedByteLength);this.T&&(a+=this.T.reservedByteLength);return this.children.reduce((b,c)=>b+c.reservedByteLength,a)}get valueOffsets(){return this.C?
this.C.buffer:null}get values(){return this.l?this.l.buffer:null}get nullBitmap(){return this.G?this.G.buffer:null}get typeIds(){return this.T?this.T.buffer:null}append(a){return this.set(this.length,a)}isValid(a){return this.Lb(a)}set(a,b){this.setValid(a,this.isValid(b))&&this.setValue(a,b);return this}setValue(a,b){this.Pa(this,a,b)}setValid(a,b){this.length=this.G.set(a,+b).length;return b}addChild(){throw Error(`Cannot append children to non-nested type "${this.type}"`);}getChildAt(a){return this.children[a]||
null}flush(){var a=[];const b=this.l,c=this.C,d=this.T,e=this.length,f=this.nullCount;d?(a[J.TYPE]=d.flush(e),c&&(a[J.OFFSET]=c.flush(e))):c?(b&&(a[J.DATA]=b.flush(c.get(c.length-1))),a[J.OFFSET]=c.flush(e)):b&&(a[J.DATA]=b.flush(e));0<f&&(a[J.VALIDITY]=this.G.flush(e));a=L.new(this.type,0,e,f,a,this.children.map(h=>h.flush()));this.clear();return a}finish(){this.finished=!0;this.children.forEach(a=>a.finish());return this}clear(){this.length=0;this.C&&this.C.clear();this.l&&this.l.clear();this.G&&
this.G.clear();this.T&&this.T.clear();this.children.forEach(a=>a.clear());return this}}g=M.prototype;g.length=1;g.stride=1;g.children=null;g.finished=!1;g.nullValues=null;g.Lb=()=>!0;class Fe extends M{constructor(a){super(a);this.l=new ze(new this.ArrayType(0),this.stride)}setValue(a,b){const c=this.l;xe(c,a-c.length+1);return super.setValue(a,b)}}function Ge(a){const b=a.F,c=a.L;a.L=0;a.F=void 0;b&&0<b.size&&a.ha(b,c)}
class He extends M{constructor(a){super(a);this.L=0;this.C=new Be}setValue(a,b){const c=this.F||(this.F=new Map),d=c.get(a);d&&(this.L-=d.length);this.L+=b.length;c.set(a,b)}setValid(a,b){return super.setValid(a,b)?!0:((this.F||(this.F=new Map)).set(a,void 0),!1)}clear(){this.L=0;this.F=void 0;return super.clear()}flush(){Ge(this);return super.flush()}finish(){Ge(this);return super.finish()}}
function De(a){const {["queueingStrategy"]:b="count"}=a,{["highWaterMark"]:c="bytes"!==b?1E3:16384}=a,d="bytes"!==b?"length":"byteLength";return function*(e){let f=0;const h=M.new(a);for(const k of e)h.append(k)[d]>=c&&++f&&(yield h.toVector());if(0<h.finish().length||0===f)yield h.toVector()}}
function Ee(a){const {["queueingStrategy"]:b="count"}=a,{["highWaterMark"]:c="bytes"!==b?1E3:16384}=a,d="bytes"!==b?"length":"byteLength";return async function*(e){let f=0;const h=M.new(a);for await(const k of e)h.append(k)[d]>=c&&++f&&(yield h.toVector());if(0<h.finish().length||0===f)yield h.toVector()}};class Ie extends M{constructor(a){super(a);this.l=new Ae}setValue(a,b){this.l.set(a,+b)}};class Je extends M{setValue(){}setValid(a,b){this.length=Math.max(a+1,this.length);return b}};class Ke extends Fe{}class Le extends Ke{}class Me extends Ke{};class Ne extends Fe{};class Oe extends M{constructor({type:a,nullValues:b,dictionaryHashFunction:c}){super({type:new me(a.dictionary,a.indices,a.id,a.isOrdered)});this.G=null;this.Ma=0;this.Mb=Object.create(null);this.indices=M.new({type:this.type.indices,nullValues:b});this.dictionary=M.new({type:this.type.dictionary,nullValues:null});"function"===typeof c&&(this.valueToKey=c)}get values(){return this.indices.values}get nullCount(){return this.indices.nullCount}get nullBitmap(){return this.indices.nullBitmap}get byteLength(){return this.indices.byteLength+
this.dictionary.byteLength}get reservedLength(){return this.indices.reservedLength+this.dictionary.reservedLength}get reservedByteLength(){return this.indices.reservedByteLength+this.dictionary.reservedByteLength}isValid(a){return this.indices.isValid(a)}setValid(a,b){const c=this.indices;b=c.setValid(a,b);this.length=c.length;return b}setValue(a,b){const c=this.Mb,d=this.valueToKey(b);let e=c[d];void 0===e&&(c[d]=e=this.Ma+this.dictionary.append(b).length-1);return this.indices.setValue(a,e)}flush(){var a=
this.type;const b=this.cc,c=this.dictionary.toVector();a=this.indices.flush().clone(a);a.dictionary=b?b.concat(c):c;this.finished||(this.Ma+=c.length);this.cc=a.dictionary;this.clear();return a}finish(){this.indices.finish();this.dictionary.finish();this.Ma=0;this.Mb=Object.create(null);return super.finish()}clear(){this.indices.clear();this.dictionary.clear();return super.clear()}valueToKey(a){return"string"===typeof a?a:`${a}`}};class Pe extends Fe{};const Qe=new Float64Array(1),Re=new Uint32Array(Qe.buffer);function Se(a){const b=(a&31744)>>10,c=(a&1023)/1024;a=(-1)**((a&32768)>>15);switch(b){case 31:return a*(c?NaN:1/0);case 0:return a*(c?6.103515625E-5*c:0)}return a*2**(b-15)*(1+c)}
function Te(a){if(a!==a)return 32256;Qe[0]=a;a=(Re[1]&2147483648)>>16&65535;let b=Re[1]&2146435072,c=0;1089470464<=b?0<Re[0]?b=31744:(b=(b&2080374784)>>16,c=(Re[1]&1048575)>>10):1056964608>=b?(c=1048576+(Re[1]&1048575),c=1048576+(c<<(b>>20)-998)>>21,b=0):(b=b-1056964608>>10,c=(Re[1]&1048575)+512>>10);return a|b|c&65535}var Ue={};Ue.float64ToUint16=Te;Ue.uint16ToFloat64=Se;class Ve extends Fe{}class We extends Ve{setValue(a,b){this.l.set(a,Te(b))}}class Xe extends Ve{setValue(a,b){this.l.set(a,b)}}class Ye extends Ve{setValue(a,b){this.l.set(a,b)}};const Ze=Symbol.for("isArrowBigNum");function $e(a,...b){return 0===b.length?Object.setPrototypeOf(x(this.TypedArray,a),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(a,...b),this.constructor.prototype)}$e.prototype[Ze]=!0;$e.prototype.toJSON=function(){return`"${af(this)}"`};$e.prototype.valueOf=function(){return bf(this)};$e.prototype.toString=function(){return af(this)};$e.prototype[Symbol.toPrimitive]=function(a="default"){switch(a){case "number":return bf(this);case "default":return cf(this)}return af(this)};
function df(...a){return $e.apply(this,a)}function ef(...a){return $e.apply(this,a)}function ff(...a){return $e.apply(this,a)}Object.setPrototypeOf(df.prototype,Object.create(Int32Array.prototype));Object.setPrototypeOf(ef.prototype,Object.create(Uint32Array.prototype));Object.setPrototypeOf(ff.prototype,Object.create(Uint32Array.prototype));Object.assign(df.prototype,$e.prototype,{constructor:df,signed:!0,TypedArray:Int32Array,BigIntArray:Pa});
Object.assign(ef.prototype,$e.prototype,{constructor:ef,signed:!1,TypedArray:Uint32Array,BigIntArray:Qa});Object.assign(ff.prototype,$e.prototype,{constructor:ff,signed:!0,TypedArray:Uint32Array,BigIntArray:Qa});function bf(a){const {buffer:b,byteOffset:c,length:d,signed:e}=a;a=new Int32Array(b,c,d);let f=0,h=0;const k=a.length;let n,p;for(;h<k;)p=a[h++],n=a[h++],e||(n>>>=0),f+=(p>>>0)+n*h**32;return f}let af,cf;
Oa?(cf=a=>8===a.byteLength?(new a.BigIntArray(a.buffer,a.byteOffset,1))[0]:gf(a),af=a=>8===a.byteLength?`${(new a.BigIntArray(a.buffer,a.byteOffset,1))[0]}`:gf(a)):cf=af=gf;
function gf(a){let b="";const c=new Uint32Array(2);a=new Uint16Array(a.buffer,a.byteOffset,a.byteLength/2);const d=new Uint32Array((a=(new Uint16Array(a)).reverse()).buffer);let e;const f=a.length-1;do{for(c[0]=a[e=0];e<f;)a[e++]=c[1]=c[0]/10,c[0]=(c[0]-10*c[1]<<16)+a[e];a[e]=c[1]=c[0]/10;c[0]-=10*c[1];b=`${c[0]}${b}`}while(d[0]||d[1]||d[2]||d[3]);return b?b:"0"}
class hf{static new(a,b){switch(b){case !0:return new df(a);case !1:return new ef(a)}switch(a.constructor){case Int8Array:case Int16Array:case Int32Array:case Pa:return new df(a)}return 16===a.byteLength?new ff(a):new ef(a)}constructor(a,b){return hf.new(a,b)}}var jf={};jf.BN=hf;jf.bignumToBigInt=cf;jf.bignumToString=af;jf.isArrowBigNumSymbol=Ze;class kf extends Fe{setValue(a,b){this.l.set(a,b)}}class lf extends kf{}class mf extends kf{}class nf extends kf{}class of extends kf{constructor(a){a.nullValues&&(a.nullValues=a.nullValues.map(pf));super(a);this.l=new Ce(new Int32Array(0),2)}get values64(){return this.l.tb}isValid(a){return super.isValid(pf(a))}}class qf extends kf{}class rf extends kf{}class sf extends kf{}
class tf extends kf{constructor(a){a.nullValues&&(a.nullValues=a.nullValues.map(pf));super(a);this.l=new Ce(new Uint32Array(0),2)}get values64(){return this.l.tb}isValid(a){return super.isValid(pf(a))}}const pf=(a=>b=>{ArrayBuffer.isView(b)&&(a.buffer=b.buffer,a.byteOffset=b.byteOffset,a.byteLength=b.byteLength,b=cf(a),a.buffer=null);return b})({BigIntArray:Pa});class uf extends Fe{}class vf extends uf{}class wf extends uf{}class xf extends uf{}class yf extends uf{};class zf extends Fe{}class Af extends zf{}class Bf extends zf{}class Cf extends zf{}class Df extends zf{};class Ef extends Fe{}class Ff extends Ef{}class Gf extends Ef{};class Hf extends He{constructor(a){super(a);this.l=new ye(new Uint8Array(0))}get byteLength(){let a=this.L+4*this.length;this.C&&(a+=this.C.byteLength);this.l&&(a+=this.l.byteLength);this.G&&(a+=this.G.byteLength);return a}setValue(a,b){return super.setValue(a,x(Uint8Array,b))}ha(a,b){const c=this.C;b=xe(this.l,b).buffer;let d=0,e=0,f;for([d,f]of a)void 0===f?c.set(d,0):(a=f.length,b.set(f,e),c.set(d,a),e+=a)}};class If extends He{constructor(a){super(a);this.l=new ye(new Uint8Array(0))}get byteLength(){let a=this.L+4*this.length;this.C&&(a+=this.C.byteLength);this.l&&(a+=this.l.byteLength);this.G&&(a+=this.G.byteLength);return a}setValue(a,b){return super.setValue(a,Fa.encode(b))}ha(){}}If.prototype.ha=Hf.prototype.ha;class Jf{get length(){return this.l.length}get(a){return this.l[a]}clear(){this.l=null;return this}bind(a){if(a instanceof z)return a;this.l=a;return this}};class N{constructor(a=[],b,c){this.fields=a||[];this.metadata=b||new Map;c||(c=Kf(a));this.dictionaries=c}get [Symbol.toStringTag](){return"Schema"}toString(){return`Schema<{ ${this.fields.map((a,b)=>`${b}: ${a}`).join(", ")} }>`}select(...a){const b=a.reduce((c,d)=>(c[d]=!0,c),Object.create(null));return new N(this.fields.filter(c=>b[c.name]),this.metadata)}selectAt(...a){return new N(a.map(b=>this.fields[b]).filter(Boolean),this.metadata)}assign(...a){var b=a[0]instanceof N?a[0]:Array.isArray(a[0])?
new N(a[0]):new N(a);const c=[...this.fields];a=Lf(Lf(new Map,this.metadata),b.metadata);b=b.fields.filter(e=>{const f=c.findIndex(h=>h.name===e.name);return~f?(c[f]=e.clone({metadata:Lf(Lf(new Map,c[f].metadata),e.metadata)}))&&!1:!0});const d=Kf(b,new Map);return new N([...c,...b],a,new Map([...this.dictionaries,...d]))}}
class O{constructor(a,b,c=!1,d){this.name=a;this.type=b;this.nullable=c;this.metadata=d||new Map}static new(...a){let [b,c,d,e]=a;a[0]&&"object"===typeof a[0]&&({name:b}=a[0],void 0===c&&(c=a[0].type),void 0===d&&(d=a[0].nullable),void 0===e&&(e=a[0].metadata));return new O(`${b}`,c,d,e)}get typeId(){return this.type.typeId}get [Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...a){let [b,c,d,e]=a;a[0]&&"object"===typeof a[0]?{name:b=this.name,type:c=this.type,
nullable:d=this.nullable,metadata:e=this.metadata}=a[0]:[b=this.name,c=this.type,d=this.nullable,e=this.metadata]=a;return O.new(b,c,d,e)}}function Lf(a,b){return new Map([...(a||new Map),...(b||new Map)])}
function Kf(a,b=new Map){for(let c=-1,d=a.length;++c<d;){const e=a[c].type;if(K.isDictionary(e))if(!b.has(e.id))b.set(e.id,e.dictionary);else if(b.get(e.id)!==e.dictionary)throw Error("Cannot create Schema containing two different dictionaries with the same Id");e.children&&0<e.children.length&&Kf(e.children,b)}return b}N.prototype.fields=null;N.prototype.metadata=null;N.prototype.dictionaries=null;O.prototype.type=null;O.prototype.name=null;O.prototype.nullable=null;O.prototype.metadata=null;class Mf extends He{constructor(a){super(a);this.Ba=new Jf;this.C=new Be}addChild(a,b="0"){if(0<this.numChildren)throw Error("ListBuilder can only have one child.");this.children[this.numChildren]=a;this.type=new Md(new O(b,a.type,!0));return this.numChildren-1}clear(){this.Ba.clear();return super.clear()}ha(a){const b=this.Ba,c=this.C,d=this.Pa;let e=0,f;for([e,f]of a)void 0===f?c.set(e,0):(c.set(e,f.length),d(this,e,b.bind(f)))}};class Nf extends M{constructor(){super(...arguments);this.Ba=new Jf}setValue(a,b){super.setValue(a,this.Ba.bind(b))}addChild(a,b="0"){if(0<this.numChildren)throw Error("FixedSizeListBuilder can only have one child.");const c=this.children.push(a);this.type=new de(this.type.listSize,new O(b,a.type,!0));return c}clear(){this.Ba.clear();return super.clear()}};class Of extends He{set(a,b){return super.set(a,b)}setValue(a,b){b=b instanceof Map?b:new Map(Object.entries(b));const c=this.F||(this.F=new Map),d=c.get(a);d&&(this.L-=d.size);this.L+=b.size;c.set(a,b)}addChild(a,b=`${this.numChildren}`){if(0<this.numChildren)throw Error("ListBuilder can only have one child.");this.children[this.numChildren]=a;this.type=new he(new O(b,a.type,!0),this.type.keysSorted);return this.numChildren-1}ha(a){const b=this.C,c=this.Pa;a.forEach((d,e)=>{void 0===d?b.set(e,0):
(b.set(e,d.size),c(this,e,d))})}};class Pf extends M{addChild(a,b=`${this.numChildren}`){const c=this.children.push(a);this.type=new Qd([...this.type.children,new O(b,a.type,!0)]);return c}};class Qf extends M{constructor(a){super(a);this.T=new ze(new Int8Array(0),1);"function"===typeof a.valueToChildTypeId&&(this.Ob=a.valueToChildTypeId)}get typeIdToChildIndex(){return this.type.typeIdToChildIndex}append(a,b){return this.set(this.length,a,b)}set(a,b,c){void 0===c&&(c=this.Ob(this,b,a));this.setValid(a,this.isValid(b))&&this.setValue(a,b,c);return this}setValue(a,b,c){this.T.set(a,c);super.setValue(a,b)}addChild(a,b=`${this.children.length}`){const c=this.children.push(a),{type:{children:d,
mode:e,typeIds:f}}=this;a=[...d,new O(b,a.type)];this.type=new Ud(e,[...f,c],a);return c}Ob(){throw Error("Cannot map UnionBuilder value to child typeId. Pass the `childTypeId` as the second argument to unionBuilder.append(), or supply a `valueToChildTypeId` function as part of the UnionBuilder constructor options.");}}class Rf extends Qf{}
class Sf extends Qf{constructor(a){super(a);this.C=new ze(new Int32Array(0))}setValue(a,b,c){this.C.set(a,this.getChildAt(this.type.typeIdToChildIndex[c]).length);return super.setValue(a,b,c)}};class Tf{visitMany(a,...b){return a.map((c,d)=>this.visit(c,...b.map(e=>e[d])))}visit(...a){return this.getVisitFn(a[0],!1).apply(this,a)}getVisitFn(a,b=!0){return Uf(this,a,b)}visitNull(){return null}visitBool(){return null}visitInt(){return null}visitFloat(){return null}visitUtf8(){return null}visitBinary(){return null}visitFixedSizeBinary(){return null}visitDate(){return null}visitTimestamp(){return null}visitTime(){return null}visitDecimal(){return null}visitList(){return null}visitStruct(){return null}visitUnion(){return null}visitDictionary(){return null}visitInterval(){return null}visitFixedSizeList(){return null}visitMap(){return null}}
function Uf(a,b,c=!0){let d=null,e=H.NONE;b instanceof L?e=Vf(b.type):b instanceof z?e=Vf(b.type):b instanceof K?e=Vf(b):"number"!==typeof(e=b)&&(e=H[b]);switch(e){case H.Null:d=a.visitNull;break;case H.Bool:d=a.visitBool;break;case H.Int:d=a.visitInt;break;case H.Int8:d=a.visitInt8||a.visitInt;break;case H.Int16:d=a.visitInt16||a.visitInt;break;case H.Int32:d=a.visitInt32||a.visitInt;break;case H.Int64:d=a.visitInt64||a.visitInt;break;case H.Uint8:d=a.visitUint8||a.visitInt;break;case H.Uint16:d=
a.visitUint16||a.visitInt;break;case H.Uint32:d=a.visitUint32||a.visitInt;break;case H.Uint64:d=a.visitUint64||a.visitInt;break;case H.Float:d=a.visitFloat;break;case H.Float16:d=a.visitFloat16||a.visitFloat;break;case H.Float32:d=a.visitFloat32||a.visitFloat;break;case H.Float64:d=a.visitFloat64||a.visitFloat;break;case H.Utf8:d=a.visitUtf8;break;case H.Binary:d=a.visitBinary;break;case H.FixedSizeBinary:d=a.visitFixedSizeBinary;break;case H.Date:d=a.visitDate;break;case H.DateDay:d=a.visitDateDay||
a.visitDate;break;case H.DateMillisecond:d=a.visitDateMillisecond||a.visitDate;break;case H.Timestamp:d=a.visitTimestamp;break;case H.TimestampSecond:d=a.visitTimestampSecond||a.visitTimestamp;break;case H.TimestampMillisecond:d=a.visitTimestampMillisecond||a.visitTimestamp;break;case H.TimestampMicrosecond:d=a.visitTimestampMicrosecond||a.visitTimestamp;break;case H.TimestampNanosecond:d=a.visitTimestampNanosecond||a.visitTimestamp;break;case H.Time:d=a.visitTime;break;case H.TimeSecond:d=a.visitTimeSecond||
a.visitTime;break;case H.TimeMillisecond:d=a.visitTimeMillisecond||a.visitTime;break;case H.TimeMicrosecond:d=a.visitTimeMicrosecond||a.visitTime;break;case H.TimeNanosecond:d=a.visitTimeNanosecond||a.visitTime;break;case H.Decimal:d=a.visitDecimal;break;case H.List:d=a.visitList;break;case H.Struct:d=a.visitStruct;break;case H.Union:d=a.visitUnion;break;case H.DenseUnion:d=a.visitDenseUnion||a.visitUnion;break;case H.SparseUnion:d=a.visitSparseUnion||a.visitUnion;break;case H.Dictionary:d=a.visitDictionary;
break;case H.Interval:d=a.visitInterval;break;case H.IntervalDayTime:d=a.visitIntervalDayTime||a.visitInterval;break;case H.IntervalYearMonth:d=a.visitIntervalYearMonth||a.visitInterval;break;case H.FixedSizeList:d=a.visitFixedSizeList;break;case H.Map:d=a.visitMap}if("function"===typeof d)return d;if(!c)return()=>null;throw Error(`Unrecognized type '${H[e]}'`);}
function Vf(a){switch(a.typeId){case H.Null:return H.Null;case H.Int:const b=a.isSigned;switch(a.bitWidth){case 8:return b?H.Int8:H.Uint8;case 16:return b?H.Int16:H.Uint16;case 32:return b?H.Int32:H.Uint32;case 64:return b?H.Int64:H.Uint64}return H.Int;case H.Float:switch(a.precision){case C.HALF:return H.Float16;case C.SINGLE:return H.Float32;case C.DOUBLE:return H.Float64}return H.Float;case H.Binary:return H.Binary;case H.Utf8:return H.Utf8;case H.Bool:return H.Bool;case H.Decimal:return H.Decimal;
case H.Time:switch(a.unit){case D.SECOND:return H.TimeSecond;case D.MILLISECOND:return H.TimeMillisecond;case D.MICROSECOND:return H.TimeMicrosecond;case D.NANOSECOND:return H.TimeNanosecond}return H.Time;case H.Timestamp:switch(a.unit){case D.SECOND:return H.TimestampSecond;case D.MILLISECOND:return H.TimestampMillisecond;case D.MICROSECOND:return H.TimestampMicrosecond;case D.NANOSECOND:return H.TimestampNanosecond}return H.Timestamp;case H.Date:switch(a.unit){case ub.DAY:return H.DateDay;case ub.MILLISECOND:return H.DateMillisecond}return H.Date;
case H.Interval:switch(a.unit){case xb.DAY_TIME:return H.IntervalDayTime;case xb.YEAR_MONTH:return H.IntervalYearMonth}return H.Interval;case H.Map:return H.Map;case H.List:return H.List;case H.Struct:return H.Struct;case H.Union:switch(a.mode){case B.Dense:return H.DenseUnion;case B.Sparse:return H.SparseUnion}return H.Union;case H.FixedSizeBinary:return H.FixedSizeBinary;case H.FixedSizeList:return H.FixedSizeList;case H.Dictionary:return H.Dictionary}throw Error(`Unrecognized type '${H[a.typeId]}'`);
}g=Tf.prototype;g.visitInt8=null;g.visitInt16=null;g.visitInt32=null;g.visitInt64=null;g.visitUint8=null;g.visitUint16=null;g.visitUint32=null;g.visitUint64=null;g.visitFloat16=null;g.visitFloat32=null;g.visitFloat64=null;g.visitDateDay=null;g.visitDateMillisecond=null;g.visitTimestampSecond=null;g.visitTimestampMillisecond=null;g.visitTimestampMicrosecond=null;g.visitTimestampNanosecond=null;g.visitTimeSecond=null;g.visitTimeMillisecond=null;g.visitTimeMicrosecond=null;g.visitTimeNanosecond=null;
g.visitDenseUnion=null;g.visitSparseUnion=null;g.visitIntervalDayTime=null;g.visitIntervalYearMonth=null;class Wf extends Tf{}
const Xf=(a,b,c,d)=>{const {[c]:e,[c+1]:f}=b;null!=e&&null!=f&&a.set(d.subarray(0,f-e),e)},Yf=({values:a},b,c)=>{a[b]=c.valueOf()/864E5|0},Zf=({values:a},b,c)=>{b*=2;c=c.valueOf();a[b]=c%4294967296|0;a[b+1]=c/4294967296|0},$f=({stride:a,values:b},c,d)=>{b[a*c]=d},ag=({stride:a,values:b},c,d)=>{b[a*c]=Te(d)},bg=(a,b,c)=>{switch(typeof c){case "bigint":a.values64[b]=c;break;case "number":a.values[b*a.stride]=c;break;default:const d=a.stride;c=x(a.ArrayType,c);a.values.set(c.subarray(0,d),d*b)}},cg=
({values:a},b,c)=>{b*=2;c/=1E3;a[b]=c%4294967296|0;a[b+1]=c/4294967296|0},dg=({values:a},b,c)=>{b*=2;a[b]=c%4294967296|0;a[b+1]=c/4294967296|0},eg=({values:a},b,c)=>{b*=2;a[b]=1E3*c%4294967296|0;a[b+1]=1E3*c/4294967296|0},fg=({values:a},b,c)=>{b*=2;a[b]=1E6*c%4294967296|0;a[b+1]=1E6*c/4294967296|0},gg=({values:a,stride:b},c,d)=>{a[b*c]=d},hg=({values:a,stride:b},c,d)=>{a[b*c]=d},ig=({values:a},b,c)=>{a.set(c.subarray(0,2),2*b)},jg=({values:a},b,c)=>{a.set(c.subarray(0,2),2*b)},kg=(a,b)=>(c,d,e)=>
c?.set(a,b[e]),lg=(a,b)=>(c,d,e)=>c?.set(a,b.get(e)),mg=(a,b)=>(c,d)=>c?.set(a,b.get(d.name)),ng=(a,b)=>(c,d)=>c?.set(a,b[d.name]),og=(a,b,c)=>{const d=a.getChildAt(a.typeIdToChildIndex[a.typeIds[b]]);d&&d.set(a.valueOffsets[b],c)},pg=(a,b,c)=>{(a=a.getChildAt(a.typeIdToChildIndex[a.typeIds[b]]))&&a.set(b,c)},qg=({values:a},b,c)=>{a.set(c.subarray(0,2),2*b)},rg=({values:a},b,c)=>{a[b]=12*c[0]+c[1]%12};g=Wf.prototype;g.visitBool=({offset:a,values:b},c,d)=>{a+=c;d?b[a>>3]|=1<<a%8:b[a>>3]&=~(1<<a%8)};
g.visitInt=(a,b,c)=>{64>a.type.bitWidth?$f(a,b,c):bg(a,b,c)};g.visitInt8=$f;g.visitInt16=$f;g.visitInt32=$f;g.visitInt64=bg;g.visitUint8=$f;g.visitUint16=$f;g.visitUint32=$f;g.visitUint64=bg;g.visitFloat=(a,b,c)=>{a.type.precision!==C.HALF?$f(a,b,c):ag(a,b,c)};g.visitFloat16=ag;g.visitFloat32=$f;g.visitFloat64=$f;g.visitUtf8=({values:a,valueOffsets:b},c,d)=>{Xf(a,b,c,Fa.encode(d))};g.visitBinary=({values:a,valueOffsets:b},c,d)=>Xf(a,b,c,d);
g.visitFixedSizeBinary=({stride:a,values:b},c,d)=>{b.set(d.subarray(0,a),a*c)};g.visitDate=(a,b,c)=>{a.type.unit===ub.DAY?Yf(a,b,c):Zf(a,b,c)};g.visitDateDay=Yf;g.visitDateMillisecond=Zf;g.visitTimestamp=(a,b,c)=>{switch(a.type.unit){case D.SECOND:return cg(a,b,c);case D.MILLISECOND:return dg(a,b,c);case D.MICROSECOND:return eg(a,b,c);case D.NANOSECOND:return fg(a,b,c)}};g.visitTimestampSecond=cg;g.visitTimestampMillisecond=dg;g.visitTimestampMicrosecond=eg;g.visitTimestampNanosecond=fg;
g.visitTime=(a,b,c)=>{switch(a.type.unit){case D.SECOND:return gg(a,b,c);case D.MILLISECOND:return hg(a,b,c);case D.MICROSECOND:return ig(a,b,c);case D.NANOSECOND:return jg(a,b,c)}};g.visitTimeSecond=gg;g.visitTimeMillisecond=hg;g.visitTimeMicrosecond=ig;g.visitTimeNanosecond=jg;g.visitDecimal=({values:a},b,c)=>{a.set(c.subarray(0,4),4*b)};g.visitList=(a,b,c)=>{const d=a.getChildAt(0);a=a.valueOffsets;for(let e=-1,f=a[b],h=a[b+1];f<h;)d.set(f++,c.get(++e))};
g.visitStruct=(a,b,c)=>{const d=c instanceof Map?mg(b,c):c instanceof z?lg(b,c):Array.isArray(c)?kg(b,c):ng(b,c);a.type.children.forEach((e,f)=>d(a.getChildAt(f),e,f))};g.visitUnion=(a,b,c)=>{a.type.mode===B.Dense?og(a,b,c):pg(a,b,c)};g.visitDenseUnion=og;g.visitSparseUnion=pg;g.visitDictionary=(a,b,c)=>{b=a.getKey(b);null!==b&&a.setValue(b,c)};g.visitInterval=(a,b,c)=>{a.type.unit===xb.DAY_TIME?qg(a,b,c):rg(a,b,c)};g.visitIntervalDayTime=qg;g.visitIntervalYearMonth=rg;
g.visitFixedSizeList=(a,b,c)=>{const d=a.getChildAt(0);a=a.stride;for(let e=-1,f=b*a;++e<a;)d.set(f+e,c.get(e))};g.visitMap=(a,b,c)=>{const d=a.getChildAt(0);a=a.valueOffsets;c=c instanceof Map?[...c]:Object.entries(c);for(let e=-1,f=a[b],h=a[b+1];f<h;)d.set(f++,c[++e])};const sg=new Wf;class tg extends Tf{visitNull(){return Je}visitBool(){return Ie}visitInt(){return kf}visitInt8(){return lf}visitInt16(){return mf}visitInt32(){return nf}visitInt64(){return of}visitUint8(){return qf}visitUint16(){return rf}visitUint32(){return sf}visitUint64(){return tf}visitFloat(){return Ve}visitFloat16(){return We}visitFloat32(){return Xe}visitFloat64(){return Ye}visitUtf8(){return If}visitBinary(){return Hf}visitFixedSizeBinary(){return Pe}visitDate(){return Ke}visitDateDay(){return Le}visitDateMillisecond(){return Me}visitTimestamp(){return zf}visitTimestampSecond(){return Af}visitTimestampMillisecond(){return Bf}visitTimestampMicrosecond(){return Cf}visitTimestampNanosecond(){return Df}visitTime(){return uf}visitTimeSecond(){return vf}visitTimeMillisecond(){return wf}visitTimeMicrosecond(){return xf}visitTimeNanosecond(){return yf}visitDecimal(){return Ne}visitList(){return Mf}visitStruct(){return Pf}visitUnion(){return Qf}visitDenseUnion(){return Sf}visitSparseUnion(){return Rf}visitDictionary(){return Oe}visitInterval(){return Ef}visitIntervalDayTime(){return Ff}visitIntervalYearMonth(){return Gf}visitFixedSizeList(){return Nf}visitMap(){return Of}}
const ug=new tg;M.new=vg;function vg(a){const b=a.type,c=new (ug.getVisitFn(b)())(a);if(b.children&&0<b.children.length){const d=a.children||[],e={nullValues:a.nullValues},f=Array.isArray(d)?(h,k)=>d[k]||e:({name:h})=>d[h]||e;b.children.forEach((h,k)=>{const n=h.type;h=f(h,k);c.children.push(vg({...h,type:n}))})}return c}Object.keys(H).map(a=>H[a]).filter(a=>"number"===typeof a&&a!==H.NONE).forEach(a=>{ug.visit(a).prototype.Pa=sg.getVisitFn(a)});If.prototype.Pa=sg.visitBinary;function wg(a,b){a.finish(b)}
class xg{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}version(){const a=r(this.g,this.h,4);return a?sa(this.g,this.h+a):A.V1}schema(a){const b=r(this.g,this.h,6);return b?(a||new ac).i(Aa(this.g,this.h+b),this.g):null}dictionaries(a,b){const c=r(this.g,this.h,8);return c?(b||new yg).i(Ba(this.g,this.h+c)+24*a,this.g):null}Bb(a){const b=r(this.g,this.h,10);return b?(new yg).i(Ba(this.g,this.h+b)+24*a,this.g):null}Wa(a){const b=r(this.g,this.h,12);return b?(new Qb).i(Aa(this.g,
Ba(this.g,this.h+b)+4*a),this.g):null}Xa(){const a=r(this.g,this.h,12);return a?Ca(this.g,this.h+a):0}}class yg{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}offset(){return xa(this.g,this.h)}wb(){return this.g.v(this.h+8)}bodyLength(){return xa(this.g,this.h+16)}};function*zg(a){for(let b,c=-1,d=a.numDictionaries;++c<d;)if(b=a.Ya(c))yield b}
class Ag{constructor(a,b=A.V4,c,d){this.schema=a;this.version=b;c&&(this.ba=c);d&&(this.Ib=d)}static decode(a){a=new ea(x(Uint8Array,a));a=(new xg).i(a.v(a.position())+a.position(),a);const b=N.decode(a.schema());return new Bg(b,a)}static encode(a){const b=new da,c=N.encode(b,a.schema);ta(b,24,a.numRecordBatches,8);[...a.Bb()].slice().reverse().forEach(e=>Cg.encode(b,e));const d=ua(b);ta(b,24,a.numDictionaries,8);[...zg(a)].slice().reverse().forEach(e=>Cg.encode(b,e));a=ua(b);m(b,5);l(b,1,c);na(b,
A.V4,A.V1);l(b,3,d);l(b,2,a);wg(b,q(b));return ha(b)}get numRecordBatches(){return this.ba.length}get numDictionaries(){return this.Ib.length}*Bb(){for(let a,b=-1,c=this.numRecordBatches;++b<c;)if(a=this.na(b))yield a}na(a){return 0<=a&&a<this.numRecordBatches&&this.ba[a]||null}Ya(a){return 0<=a&&a<this.numDictionaries&&this.Ib[a]||null}}
class Bg extends Ag{constructor(a,b){super(a,b.version());this.j=b}get numRecordBatches(){var a=this.j;const b=r(a.g,a.h,10);return b?Ca(a.g,a.h+b):0}get numDictionaries(){var a=this.j;const b=r(a.g,a.h,8);return b?Ca(a.g,a.h+b):0}na(a){return 0<=a&&a<this.numRecordBatches&&(a=this.j.Bb(a))?Cg.decode(a):null}Ya(a){return 0<=a&&a<this.numDictionaries&&(a=this.j.dictionaries(a))?Cg.decode(a):null}}
class Cg{constructor(a,b,c){this.wb=a;this.offset="number"===typeof c?c:c.low;this.bodyLength="number"===typeof b?b:b.low}static decode(a){return new Cg(a.wb(),a.bodyLength(),a.offset())}static encode(a,b){var c=new ba(b.offset,0),d=b.wb;b=new ba(b.bodyLength,0);ia(a,8,24);a.aa(b);ja(a,4);a.W(d);a.aa(c);return a.offset()}};class Dg extends Ka{write(a){if(0<(a=x(Uint8Array,a)).byteLength)return super.write(a)}toString(a=!1){return a?Da.decode(this.toUint8Array(!0)):this.toUint8Array(!1).then(Ea)}toUint8Array(a=!1){return a?Ya(this.l)[0]:(async()=>{const b=[];let c=0;for await(const d of this)b.push(d),c+=d.byteLength;return Ya(b,c)[0]})()}}
class Eg{constructor(a){a&&(this.source=new Fg(db(eb(a))))}[Symbol.iterator](){return this}next(a){return this.source.next(a)}throw(a){return this.source.throw(a)}return(a){return this.source.return(a)}peek(a){return this.source.peek(a)}read(a){return this.source.read(a)}}
class Gg{constructor(a){a instanceof Gg?this.source=a.source:a instanceof Dg?this.source=new Hg(db(fb(a))):Ua(a)?this.source=new Hg(db(nb(a))):Ta(a)?this.source=new Hg(db(gb(a))):v(a)&&Ta(a.body)?this.source=new Hg(db(gb(a.body))):Ra(a)?this.source=new Hg(db(eb(a))):v(a)&&u(a.then)?this.source=new Hg(db(fb(a))):Sa(a)&&(this.source=new Hg(db(fb(a))))}[Symbol.asyncIterator](){return this}next(a){return this.source.next(a)}throw(a){return this.source.throw(a)}return(a){return this.source.return(a)}get closed(){return this.source.closed}cancel(a){return this.source.cancel(a)}peek(a){return this.source.peek(a)}read(a){return this.source.read(a)}}
class Fg{constructor(a){this.source=a}cancel(a){this.return(a)}peek(a){return this.next(a,"peek").value}read(a){return this.next(a,"read").value}next(a,b="read"){return this.source.next({Y:b,size:a})}throw(a){return Object.create(this.source.throw&&this.source.throw(a)||t)}return(a){return Object.create(this.source.return&&this.source.return(a)||t)}}
class Hg{constructor(a){this.source=a;this.gb=new Promise(b=>this.K=b)}async cancel(a){await this.return(a)}get closed(){return this.gb}async read(a){return(await this.next(a,"read")).value}async peek(a){return(await this.next(a,"peek")).value}async next(a,b="read"){return await this.source.next({Y:b,size:a})}async throw(a){a=this.source.throw&&await this.source.throw(a)||t;this.K&&this.K();this.K=void 0;return Object.create(a)}async return(a){a=this.source.return&&await this.source.return(a)||t;
this.K&&this.K();this.K=void 0;return Object.create(a)}};class Ig extends Eg{constructor(a){super();this.position=0;this.buffer=x(Uint8Array,a);this.size=this.buffer.byteLength}v(a){const {buffer:b,byteOffset:c}=this.oa(a,4);return(new DataView(b,c)).getInt32(0,!0)}seek(a){this.position=Math.min(a,this.size);return a<this.size}read(a){const b=this.buffer,c=this.size,d=this.position;return b&&d<c?("number"!==typeof a&&(a=Infinity),this.position=Math.min(c,d+Math.min(c-d,a)),b.subarray(d,this.position)):null}oa(a,b){const c=this.buffer,d=Math.min(this.size,
a+b);return c?c.subarray(a,d):new Uint8Array(b)}close(){this.buffer&&(this.buffer=null)}throw(a){this.close();return{done:!0,value:a}}return(a){this.close();return{done:!0,value:a}}}
class Jg extends Gg{constructor(a,b){super();this.position=0;this.J=a;"number"===typeof b?this.size=b:this.F=(async()=>{this.size=(await a.stat()).size;delete this.F})()}async v(a){const {buffer:b,byteOffset:c}=await this.oa(a,4);return(new DataView(b,c)).getInt32(0,!0)}async seek(a){this.F&&await this.F;this.position=Math.min(a,this.size);return a<this.size}async read(a){this.F&&await this.F;const b=this.J;var c=this.size,d=this.position;if(b&&d<c){"number"!==typeof a&&(a=Infinity);let e=0,f=0;a=
Math.min(c,d+Math.min(c-d,a));for(c=new Uint8Array(Math.max(0,(this.position=a)-d));(d+=f)<a&&(e+=f)<c.byteLength;)({tc:f}=await b.read(c,e,c.byteLength-e,d));return c}return null}async oa(a,b){this.F&&await this.F;const c=this.J;var d=this.size;return c&&a+b<d?(d=new Uint8Array(Math.min(d,a+b)-a),(await c.read(d,0,b,a)).buffer):new Uint8Array(b)}async close(){const a=this.J;this.J=null;a&&await a.close()}async throw(a){await this.close();return{done:!0,value:a}}async return(a){await this.close();
return{done:!0,value:a}}};function Kg(a){0>a&&(a=4294967295+a+1);return`0x${a.toString(16)}`}const Lg=[1,10,100,1E3,1E4,1E5,1E6,1E7,1E8];
function Mg(a,b){const c=new Uint32Array([a.buffer[1]>>>16,a.buffer[1]&65535,a.buffer[0]>>>16,a.buffer[0]&65535]);b=new Uint32Array([b.buffer[1]>>>16,b.buffer[1]&65535,b.buffer[0]>>>16,b.buffer[0]&65535]);let d=c[3]*b[3];a.buffer[0]=d&65535;let e=d>>>16;d=c[2]*b[3];e+=d;d=c[3]*b[2]>>>0;e+=d;a.buffer[0]+=e<<16;a.buffer[1]=e>>>0<d?65536:0;a.buffer[1]+=e>>>16;a.buffer[1]+=c[1]*b[3]+c[2]*b[2]+c[3]*b[1];a.buffer[1]+=c[0]*b[3]+c[1]*b[2]+c[2]*b[1]+c[3]*b[0]<<16}
function Ng(a,b){const c=a.buffer[0]+b.buffer[0]>>>0;a.buffer[1]+=b.buffer[1];c<a.buffer[0]>>>0&&++a.buffer[1];a.buffer[0]=c}class Og{constructor(a){this.buffer=a}high(){return this.buffer[1]}low(){return this.buffer[0]}lessThan(a){return this.buffer[1]<a.buffer[1]||this.buffer[1]===a.buffer[1]&&this.buffer[0]<a.buffer[0]}equals(a){return this.buffer[1]===a.buffer[1]&&this.buffer[0]==a.buffer[0]}greaterThan(a){return a.lessThan(this)}hex(){return`${Kg(this.buffer[1])} ${Kg(this.buffer[0])}`}}
class P extends Og{times(a){Mg(this,a);return this}plus(a){Ng(this,a);return this}static from(a,b=new Uint32Array(2)){return P.fromString("string"===typeof a?a:a.toString(),b)}static fromNumber(a,b=new Uint32Array(2)){return P.fromString(a.toString(),b)}static fromString(a,b=new Uint32Array(2)){const c=a.length;b=new P(b);for(let d=0;d<c;){const e=8<c-d?8:c-d,f=new P(new Uint32Array([parseInt(a.substr(d,e),10),0])),h=new P(new Uint32Array([Lg[e],0]));b.times(h);b.plus(f);d+=e}return b}static convertArray(a){const b=
new Uint32Array(2*a.length);for(let c=-1,d=a.length;++c<d;)P.from(a[c],new Uint32Array(b.buffer,b.byteOffset+8*c,2));return b}static multiply(a,b){return(new P(new Uint32Array(a.buffer))).times(b)}static add(a,b){return(new P(new Uint32Array(a.buffer))).plus(b)}}
class Pg extends Og{negate(){this.buffer[0]=~this.buffer[0]+1;this.buffer[1]=~this.buffer[1];0==this.buffer[0]&&++this.buffer[1];return this}times(a){Mg(this,a);return this}plus(a){Ng(this,a);return this}lessThan(a){const b=this.buffer[1]<<0,c=a.buffer[1]<<0;return b<c||b===c&&this.buffer[0]<a.buffer[0]}static from(a,b=new Uint32Array(2)){return Pg.fromString("string"===typeof a?a:a.toString(),b)}static fromNumber(a,b=new Uint32Array(2)){return Pg.fromString(a.toString(),b)}static fromString(a,b=
new Uint32Array(2)){const c=a.startsWith("-"),d=a.length;b=new Pg(b);for(let e=c?1:0;e<d;){const f=8<d-e?8:d-e,h=new Pg(new Uint32Array([parseInt(a.substr(e,f),10),0])),k=new Pg(new Uint32Array([Lg[f],0]));b.times(k);b.plus(h);e+=f}return c?b.negate():b}static convertArray(a){const b=new Uint32Array(2*a.length);for(let c=-1,d=a.length;++c<d;)Pg.from(a[c],new Uint32Array(b.buffer,b.byteOffset+8*c,2));return b}static multiply(a,b){return(new Pg(new Uint32Array(a.buffer))).times(b)}static add(a,b){return(new Pg(new Uint32Array(a.buffer))).plus(b)}}
class Qg{constructor(a){this.buffer=a}high(){return new Pg(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new Pg(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){this.buffer[0]=~this.buffer[0]+1;this.buffer[1]=~this.buffer[1];this.buffer[2]=~this.buffer[2];this.buffer[3]=~this.buffer[3];0==this.buffer[0]&&++this.buffer[1];0==this.buffer[1]&&++this.buffer[2];0==this.buffer[2]&&++this.buffer[3];return this}times(a){const b=new P(new Uint32Array([this.buffer[3],
0])),c=new P(new Uint32Array([this.buffer[2],0])),d=new P(new Uint32Array([this.buffer[1],0])),e=new P(new Uint32Array([this.buffer[0],0])),f=new P(new Uint32Array([a.buffer[3],0])),h=new P(new Uint32Array([a.buffer[2],0])),k=new P(new Uint32Array([a.buffer[1],0]));a=new P(new Uint32Array([a.buffer[0],0]));let n=P.multiply(e,a);this.buffer[0]=n.low();const p=new P(new Uint32Array([n.high(),0]));n=P.multiply(d,a);p.plus(n);n=P.multiply(e,k);p.plus(n);this.buffer[1]=p.low();this.buffer[3]=p.lessThan(n)?
1:0;this.buffer[2]=p.high();(new P(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))).plus(P.multiply(c,a)).plus(P.multiply(d,k)).plus(P.multiply(e,h));this.buffer[3]+=P.multiply(b,a).plus(P.multiply(c,k)).plus(P.multiply(d,h)).plus(P.multiply(e,f)).low();return this}plus(a){const b=new Uint32Array(4);b[3]=this.buffer[3]+a.buffer[3]>>>0;b[2]=this.buffer[2]+a.buffer[2]>>>0;b[1]=this.buffer[1]+a.buffer[1]>>>0;b[0]=this.buffer[0]+a.buffer[0]>>>0;b[0]<this.buffer[0]>>>0&&++b[1];b[1]<this.buffer[1]>>>
0&&++b[2];b[2]<this.buffer[2]>>>0&&++b[3];this.buffer[3]=b[3];this.buffer[2]=b[2];this.buffer[1]=b[1];this.buffer[0]=b[0];return this}hex(){return`${Kg(this.buffer[3])} ${Kg(this.buffer[2])} ${Kg(this.buffer[1])} ${Kg(this.buffer[0])}`}static multiply(a,b){return(new Qg(new Uint32Array(a.buffer))).times(b)}static add(a,b){return(new Qg(new Uint32Array(a.buffer))).plus(b)}static from(a,b=new Uint32Array(4)){return Qg.fromString("string"===typeof a?a:a.toString(),b)}static fromNumber(a,b=new Uint32Array(4)){return Qg.fromString(a.toString(),
b)}static fromString(a,b=new Uint32Array(4)){const c=a.startsWith("-"),d=a.length;b=new Qg(b);for(let e=c?1:0;e<d;){const f=8<d-e?8:d-e,h=new Qg(new Uint32Array([parseInt(a.substr(e,f),10),0,0,0])),k=new Qg(new Uint32Array([Lg[f],0,0,0]));b.times(k);b.plus(h);e+=f}return c?b.negate():b}static convertArray(a){const b=new Uint32Array(4*a.length);for(let c=-1,d=a.length;++c<d;)Qg.from(a[c],new Uint32Array(b.buffer,b.byteOffset+16*c,4));return b}}var Rg={};Rg.BaseInt64=Og;Rg.Int128=Qg;Rg.Int64=Pg;
Rg.Uint64=P;function Q(a){return a.M[++a.qc]}function Sg(a){return a.buffers[++a.lc]}
class Tg extends Tf{constructor(a,b,c,d){super();this.lc=this.qc=-1;this.R=a;this.M=b;this.buffers=c;this.dictionaries=d}visit(a){return super.visit(a instanceof O?a.type:a)}visitNull(a,{length:b}=Q(this)){return L.Null(a,0,b)}visitBool(a,{length:b,nullCount:c}=Q(this)){return L.Bool(a,0,b,c,this.D(a,c),this.I(a))}visitInt(a,{length:b,nullCount:c}=Q(this)){return L.Int(a,0,b,c,this.D(a,c),this.I(a))}visitFloat(a,{length:b,nullCount:c}=Q(this)){return L.Float(a,0,b,c,this.D(a,c),this.I(a))}visitUtf8(a,
{length:b,nullCount:c}=Q(this)){return L.Utf8(a,0,b,c,this.D(a,c),this.pa(a),this.I(a))}visitBinary(a,{length:b,nullCount:c}=Q(this)){return L.Binary(a,0,b,c,this.D(a,c),this.pa(a),this.I(a))}visitFixedSizeBinary(a,{length:b,nullCount:c}=Q(this)){return L.FixedSizeBinary(a,0,b,c,this.D(a,c),this.I(a))}visitDate(a,{length:b,nullCount:c}=Q(this)){return L.Date(a,0,b,c,this.D(a,c),this.I(a))}visitTimestamp(a,{length:b,nullCount:c}=Q(this)){return L.Timestamp(a,0,b,c,this.D(a,c),this.I(a))}visitTime(a,
{length:b,nullCount:c}=Q(this)){return L.Time(a,0,b,c,this.D(a,c),this.I(a))}visitDecimal(a,{length:b,nullCount:c}=Q(this)){return L.Decimal(a,0,b,c,this.D(a,c),this.I(a))}visitList(a,{length:b,nullCount:c}=Q(this)){return L.List(a,0,b,c,this.D(a,c),this.pa(a),this.visit(a.children[0]))}visitStruct(a,{length:b,nullCount:c}=Q(this)){return L.Struct(a,0,b,c,this.D(a,c),this.visitMany(a.children))}visitUnion(a){return a.mode===B.Sparse?this.visitSparseUnion(a):this.visitDenseUnion(a)}visitDenseUnion(a,
{length:b,nullCount:c}=Q(this)){return L.Union(a,0,b,c,this.D(a,c),this.Ab(a),this.pa(a),this.visitMany(a.children))}visitSparseUnion(a,{length:b,nullCount:c}=Q(this)){return L.Union(a,0,b,c,this.D(a,c),this.Ab(a),this.visitMany(a.children))}visitDictionary(a,{length:b,nullCount:c}=Q(this)){return L.Dictionary(a,0,b,c,this.D(a,c),this.I(a.indices),this.dictionaries.get(a.id))}visitInterval(a,{length:b,nullCount:c}=Q(this)){return L.Interval(a,0,b,c,this.D(a,c),this.I(a))}visitFixedSizeList(a,{length:b,
nullCount:c}=Q(this)){return L.FixedSizeList(a,0,b,c,this.D(a,c),this.visit(a.children[0]))}visitMap(a,{length:b,nullCount:c}=Q(this)){return L.Map(a,0,b,c,this.D(a,c),this.pa(a),this.visit(a.children[0]))}D(a,b){var c=Sg(this);return 0<b&&this.I(a,c)||new Uint8Array(0)}pa(a){return this.I(a,void 0)}Ab(a){return this.I(a,void 0)}I(a,{length:b,offset:c}=Sg(this)){return this.R.subarray(c,c+b)}}
class Ug extends Tg{constructor(a,b,c,d){super(new Uint8Array(0),b,c,d);this.sources=a}D(a,b){({offset:a}=Sg(this));return 0>=b?new Uint8Array(0):sc(this.sources[a])}pa(){var {offset:a}=Sg(this);return x(Uint8Array,x(Int32Array,this.sources[a]))}Ab(a){var {offset:b}=Sg(this);return x(Uint8Array,x(a.ArrayType,this.sources[b]))}I(a,{offset:b}=Sg(this)){const c=this.sources;return K.isTimestamp(a)||(K.isInt(a)||K.isTime(a))&&64===a.bitWidth||K.isDate(a)&&a.unit===ub.MILLISECOND?x(Uint8Array,Pg.convertArray(c[b])):
K.isDecimal(a)?x(Uint8Array,Qg.convertArray(c[b])):K.isBinary(a)||K.isFixedSizeBinary(a)?Vg(c[b]):K.isBool(a)?sc(c[b]):K.isUtf8(a)?Fa.encode(c[b].join("")):x(Uint8Array,x(a.ArrayType,c[b].map(d=>+d)))}}function Vg(a){a=a.join("");const b=new Uint8Array(a.length/2);for(let c=0;c<a.length;c+=2)b[c>>1]=parseInt(a.substr(c,2),16);return b};const Wg=Symbol.for("parent"),Xg=Symbol.for("rowIndex"),Yg=Symbol.for("keyToIdx"),Zg=Symbol.for("idxToVal"),$g=Symbol.for("nodejs.util.inspect.custom");
class ah{constructor(a,b){this[Wg]=a;this.size=b}entries(){return this[Symbol.iterator]()}has(a){return void 0!==this.get(a)}get(a){let b=void 0;if(null!=a){const c=this[Yg]||(this[Yg]=new Map);let d=c.get(a);void 0!==d?(a=this[Zg]||(this[Zg]=Array(this.size)),void 0!==(b=a[d])||(a[d]=b=this.getValue(d))):-1<(d=this.vb(a))&&(c.set(a,d),a=this[Zg]||(this[Zg]=Array(this.size)),void 0!==(b=a[d])||(a[d]=b=this.getValue(d)))}return b}set(a,b){if(null!=a){const c=this[Yg]||(this[Yg]=new Map);let d=c.get(a);
void 0===d&&c.set(a,d=this.vb(a));-1<d&&((this[Zg]||(this[Zg]=Array(this.size)))[d]=this.setValue(d,b))}return this}clear(){throw Error(`Clearing ${this[Symbol.toStringTag]} not supported.`);}delete(){throw Error(`Deleting ${this[Symbol.toStringTag]} values not supported.`);}*[Symbol.iterator](){const a=this.keys(),b=this.values(),c=this[Yg]||(this[Yg]=new Map),d=this[Zg]||(this[Zg]=Array(this.size));for(let e,f,h=0,k,n;!(k=a.next()).done&&!(n=b.next()).done;++h)e=k.value,f=n.value,d[h]=f,c.has(e)||
c.set(e,h),yield[e,f]}forEach(a,b){const c=this.keys(),d=this.values(),e=void 0===b?a:(k,n,p)=>a.call(b,k,n,p),f=this[Yg]||(this[Yg]=new Map),h=this[Zg]||(this[Zg]=Array(this.size));for(let k,n,p=0,w,fa;!(w=c.next()).done&&!(fa=d.next()).done;++p)k=w.value,n=fa.value,h[p]=n,f.has(k)||f.set(k,p),e(n,k,this)}toArray(){return[...this.values()]}toJSON(){const a={};this.forEach((b,c)=>a[c]=b);return a}[$g](){return this.toString()}toString(){const a=[];this.forEach((b,c)=>{c=te(c);b=te(b);a.push(`${c}: ${b}`)});
return`{ ${a.join(", ")} }`}}var bh=Symbol.toStringTag,ch,dh=ah.prototype;Object.defineProperties(dh,{size:{writable:!0,enumerable:!1,configurable:!1,value:0},[Wg]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Xg]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});ch=dh[Symbol.toStringTag]="Row";ah[bh]=ch;
class eh extends ah{constructor(a){super(a,a.length);return fh(this)}keys(){return this[Wg].getChildAt(0)[Symbol.iterator]()}values(){return this[Wg].getChildAt(1)[Symbol.iterator]()}getKey(a){return this[Wg].getChildAt(0).get(a)}vb(a){return this[Wg].getChildAt(0).indexOf(a)}getValue(a){return this[Wg].getChildAt(1).get(a)}setValue(a,b){this[Wg].getChildAt(1).set(a,b)}}
class gh extends ah{constructor(a){super(a,a.type.children.length);return hh(this)}*keys(){for(const a of this[Wg].type.children)yield a.name}*values(){for(const a of this[Wg].type.children)yield this[a.name]}getKey(a){return this[Wg].type.children[a].name}vb(a){return this[Wg].type.children.findIndex(b=>b.name===a)}getValue(a){return this[Wg].getChildAt(a).get(this[Xg])}setValue(a,b){return this[Wg].getChildAt(a).set(this[Xg],b)}}Object.setPrototypeOf(ah.prototype,Map.prototype);
const hh=(()=>{const a={enumerable:!0,configurable:!1,get:null,set:null};return b=>{let c=-1;const d=b[Yg]||(b[Yg]=new Map),e=h=>function(){return this.get(h)},f=h=>function(k){return this.set(h,k)};for(const h of b.keys())d.set(h,++c),a.get=e(h),a.set=f(h),Object.prototype.hasOwnProperty.call(b,h)||(a.enumerable=!0,Object.defineProperty(b,h,a)),Object.prototype.hasOwnProperty.call(b,c)||(a.enumerable=!1,Object.defineProperty(b,c,a));a.get=a.set=null;return b}})(),fh=(()=>{if("undefined"===typeof Proxy)return hh;
const a=ah.prototype.has,b=ah.prototype.get,c=ah.prototype.set,d=ah.prototype.getKey,e={isExtensible(){return!1},deleteProperty(){return!1},preventExtensions(){return!0},ownKeys(f){return[...f.keys()].map(h=>`${h}`)},has(f,h){switch(h){case "getKey":case "getIndex":case "getValue":case "setValue":case "toArray":case "toJSON":case "inspect":case "constructor":case "isPrototypeOf":case "propertyIsEnumerable":case "toString":case "toLocaleString":case "valueOf":case "size":case "has":case "get":case "set":case "clear":case "delete":case "keys":case "values":case "entries":case "forEach":case "__proto__":case "__defineGetter__":case "__defineSetter__":case "hasOwnProperty":case "__lookupGetter__":case "__lookupSetter__":case Symbol.iterator:case Symbol.toStringTag:case Wg:case Xg:case Zg:case Yg:case $g:return!0}"number"!==
typeof h||f.has(h)||(h=f.getKey(h));return f.has(h)},get(f,h,k){switch(h){case "getKey":case "getIndex":case "getValue":case "setValue":case "toArray":case "toJSON":case "inspect":case "constructor":case "isPrototypeOf":case "propertyIsEnumerable":case "toString":case "toLocaleString":case "valueOf":case "size":case "has":case "get":case "set":case "clear":case "delete":case "keys":case "values":case "entries":case "forEach":case "__proto__":case "__defineGetter__":case "__defineSetter__":case "hasOwnProperty":case "__lookupGetter__":case "__lookupSetter__":case Symbol.iterator:case Symbol.toStringTag:case Wg:case Xg:case Zg:case Yg:case $g:return Reflect.get(f,
h,k)}"number"!==typeof h||a.call(k,h)||(h=d.call(k,h));return b.call(k,h)},set(f,h,k,n){switch(h){case Wg:case Xg:case Zg:case Yg:return Reflect.set(f,h,k,n);case "getKey":case "getIndex":case "getValue":case "setValue":case "toArray":case "toJSON":case "inspect":case "constructor":case "isPrototypeOf":case "propertyIsEnumerable":case "toString":case "toLocaleString":case "valueOf":case "size":case "has":case "get":case "set":case "clear":case "delete":case "keys":case "values":case "entries":case "forEach":case "__proto__":case "__defineGetter__":case "__defineSetter__":case "hasOwnProperty":case "__lookupGetter__":case "__lookupSetter__":case Symbol.iterator:case Symbol.toStringTag:return!1}"number"!==
typeof h||a.call(n,h)||(h=d.call(n,h));return a.call(n,h)?!!c.call(n,h,k):!1}};return f=>new Proxy(f,e)})();let ih;function jh(a,b,c,d){const {length:e=0}=a;b="number"!==typeof b?0:b;c="number"!==typeof c?e:c;0>b&&(b=(b%e+e)%e);0>c&&(c=(c%e+e)%e);c<b&&(ih=b,b=c,c=ih);c>e&&(c=e);return d?d(a,b,c):[b,c]}const kh=Oa?Na(0):0,lh=a=>a!==a;
function mh(a){const b=typeof a;if("object"!==b||null===a)return a!==a?lh:"bigint"!==b?c=>c===a:c=>kh+c===a;if(a instanceof Date){const c=a.valueOf();return d=>d instanceof Date?d.valueOf()===c:!1}return ArrayBuffer.isView(a)?c=>c?cb(a,c):!1:a instanceof Map?nh(a):Array.isArray(a)?oh(a):a instanceof z?ph(a):qh(a)}function oh(a){const b=[];for(let c=-1,d=a.length;++c<d;)b[c]=mh(a[c]);return rh(b)}function nh(a){let b=-1;const c=[];a.forEach(d=>c[++b]=mh(d));return rh(c)}
function ph(a){const b=[];for(let c=-1,d=a.length;++c<d;)b[c]=mh(a.get(c));return rh(b)}function qh(a){const b=Object.keys(a);if(0===b.length)return()=>!1;const c=[];for(let d=-1,e=b.length;++d<e;)c[d]=mh(a[b[d]]);return rh(c,b)}
function rh(a,b){return c=>{if(!c||"object"!==typeof c)return!1;switch(c.constructor){case Array:a:{var d=a.length;if(c.length!==d)c=!1;else{for(var e=-1;++e<d;)if(!a[e](c[e])){c=!1;break a}c=!0}}return c;case Map:case eh:case gh:return sh(a,c,c.keys());case Object:case void 0:return sh(a,c,b||Object.keys(c))}if(c instanceof z)a:if(d=a.length,c.length!==d)c=!1;else{for(e=-1;++e<d;)if(!a[e](c.get(e))){c=!1;break a}c=!0}else c=!1;return c}}
function sh(a,b,c){c=c[Symbol.iterator]();const d=b instanceof Map?b.keys():Object.keys(b)[Symbol.iterator]();b=b instanceof Map?b.values():Object.values(b)[Symbol.iterator]();let e=0;const f=a.length;let h=b.next(),k=c.next(),n=d.next();for(;e<f&&!k.done&&!n.done&&!h.done&&k.value===n.value&&a[e](h.value);++e,k=c.next(),n=d.next(),h=b.next());if(e===f&&k.done&&n.done&&h.done)return!0;c.return&&c.return();d.return&&d.return();b.return&&b.return();return!1}
var th={clampIndex:function(a,b,c){const d=a.length;b=-1<b?b:d+b%d;return c?c(a,b):b}};th.clampRange=jh;th.createElementComparator=mh;const uh=Array.isArray;function vh(a){return ArrayBuffer.isView(a)&&"BYTES_PER_ELEMENT"in a}function wh(a){switch(a){case Int8Array:return Gc;case Int16Array:return Hc;case Int32Array:return Ic;case BigInt64Array:return Jc;case Uint8Array:return Kc;case Uint16Array:return Lc;case Uint32Array:return Mc;case BigUint64Array:return Nc;case Float32Array:return Tc;case Float64Array:return Uc;default:return null}}
const yh=a=>{const [b,c]=xh(a,[[],[]]);return c.map((d,e)=>{if(d instanceof R)var f=R.new(d.field.clone(b[e]),d);else if(d instanceof z)f=R.new(b[e],d);else if(vh(d)){f=R;var h=f.new;e=b[e];var k=wh(d.constructor);if(!k)throw new TypeError("Unrecognized Array input");k=new k;d=L.new(k,0,d.length,0,[void 0,d]);d=z.new(d);f=h.call(f,e,d)}else f=R.new(b[e],[]);return f})};
function zh(a,b,c,d){let e,f=-1;const h=b.length;for(;++f<h;)uh(e=b[f])?d=zh(a,e,c,d).length:e instanceof a&&(c[d++]=e);return c}function Ah(a,b,c,d){let e,f=-1;const h=b.length;for(;++f<h;)uh(e=b[f])?d=Ah(a,e,c,d).length:e instanceof Bh?d=Ah(a,e.chunks,c,d).length:e instanceof a&&(c[d++]=e);return c}
function Ch(a,b,c,d){let e,f=-1;const h=b.length;for(;++f<h;)uh(e=b[f])?d=Ch(a,e,c,d).length:e instanceof a?d=zh(z,e.schema.fields.map((k,n)=>e.getChildAt(n)),c,d).length:e instanceof z&&(c[d++]=e);return c}function Dh(a,b,c,d){let e,f=-1;const h=b.length;for(;++f<h;)uh(e=b[f])?d=Dh(a,e,c,d).length:e instanceof a?d=zh(R,e.schema.fields.map((k,n)=>R.new(k,e.getChildAt(n))),c,d).length:e instanceof R&&(c[d++]=e);return c}const Eh=(a,[b,c],d)=>(a[0][d]=b,a[1][d]=c,a);
function xh(a,b){let c;var d;switch(d=a.length){case 0:return b;case 1:c=b[0];if(!a[0])return b;if(uh(a[0]))return xh(a[0],b);a[0]instanceof L||a[0]instanceof z||vh(a[0])||a[0]instanceof K||([c,a]=Object.entries(a[0]).reduce(Eh,b));break;default:uh(c=a[d-1])?a=uh(a[0])?a[0]:a.slice(0,d-1):(a=uh(a[0])?a[0]:a,c=[])}let e=d=-1,f=-1;const h=a.length;let k,n;const [p,w]=b;for(;++f<h;)n=a[f],n instanceof R&&(w[++e]=n)?p[++d]=n.field.clone(c[f],n.type,!0):({[f]:k=f}=c,n instanceof K&&(w[++e]=n)?p[++d]=O.new(k,
n,!0):n?.type&&(w[++e]=n)&&(n instanceof L&&(w[e]=n=z.new(n)),p[++d]=O.new(k,n.type,!0)));return b};class Fh{constructor(a){this.chunks=a;this.Ua=0;this.Tb=this.chunks[this.Ua][Symbol.iterator]()}next(){for(;this.Ua<this.chunks.length;){const a=this.Tb.next();if(!a.done)return a;++this.Ua<this.chunks.length&&(this.Tb=this.chunks[this.Ua][Symbol.iterator]())}return{done:!0,value:null}}[Symbol.iterator](){return this}}
class Bh extends z{constructor(a,b=[],c=Gh(b)){super();this.da=-1;this.S=a;this.o=b;this.fb=c;this.xa=c[c.length-1];this.kb=(this.S.children||[]).length}static flatten(...a){return Ah(z,a,[],0)}static concat(...a){a=Bh.flatten(...a);return new Bh(a[0].type,a)}get type(){return this.S}get length(){return this.xa}get chunks(){return this.o}get typeId(){return this.S.typeId}get VectorName(){return`Chunked<${this.S}>`}get data(){return this.o[0]?this.o[0].data:null}get ArrayType(){return this.S.ArrayType}get numChildren(){return this.kb}get stride(){return this.o[0]?
this.o[0].stride:1}get byteLength(){return this.o.reduce((a,b)=>a+b.byteLength,0)}get nullCount(){let a=this.da;0>a&&(this.da=a=this.o.reduce((b,{nullCount:c})=>b+c,0));return a}get indices(){if(K.isDictionary(this.S)){if(!this.Kb){const a=this.o;this.Kb=1===a.length?a[0].indices:Bh.concat(...a.map(b=>b.indices))}return this.Kb}return null}get dictionary(){return K.isDictionary(this.S)?this.o[this.o.length-1].data.dictionary:null}[Symbol.iterator](){return new Fh(this.o)}clone(a=this.o){return new Bh(this.S,
a)}concat(...a){return this.clone(Bh.flatten(this,...a))}slice(a,b){return jh(this,a,b,this.ob)}getChildAt(a){if(0>a||a>=this.kb)return null;const b=this.P||(this.P=[]);var c;let d;if(c=b[a])return c;if(c=(this.S.children||[])[a])if(d=this.o.map(e=>e.getChildAt(a)).filter(e=>null!=e),0<d.length)return b[a]=new Bh(c.type,d);return null}search(a,b){const c=this.fb;let d=c.length-1;if(0>a||a>=c[d])return null;if(1>=d)return b?b(this,0,a):[0,a];let e=0,f=0,h;do{if(e+1===d)return b?b(this,e,a-f):[e,a-
f];h=e+(d-e)/2|0;a>=c[h]?e=h:d=h}while(a<c[d]&&a>=(f=c[e]));return null}isValid(a){return!!this.search(a,this.isValidInternal)}get(a){return this.search(a,this.getInternal)}set(a,b){this.search(a,({chunks:c},d,e)=>c[d].set(e,b))}indexOf(a,b){return b&&"number"===typeof b?this.search(b,(c,d,e)=>this.indexOfInternal(c,d,e,a)):this.indexOfInternal(this,0,Math.max(0,b||0),a)}toArray(){var a=this.chunks;const b=a.length;var c=this.S.ArrayType;if(0>=b)return new c(0);if(1>=b)return a[0].toArray();let d=
0;const e=Array(b);for(let f=-1;++f<b;)d+=(e[f]=a[f].toArray()).length;c!==e[0].constructor&&(c=e[0].constructor);a=new c(d);c=c===Array?Hh:Ih;for(let f=-1,h=0;++f<b;)h=c(e[f],a,h);return a}getInternal({o:a},b,c){return a[b].get(c)}isValidInternal({o:a},b,c){return a[b].isValid(c)}indexOfInternal({o:a},b,c,d){--b;const e=a.length;var f=c;for(c=0;++b<e;){if(~(f=a[b].indexOf(d,f)))return c+f;f=0;c+=a[b].length}return-1}ob(a,b,c){const d=[],e=a.chunks,f=a.fb;for(let h=-1,k=e.length;++h<k;){const n=e[h],
p=n.length,w=f[h];if(w>=c)break;b>=w+p||(w>=b&&w+p<=c?d.push(n):d.push(n.slice(Math.max(0,b-w),Math.min(c-w,p))))}return a.clone(d)}}function Gh(a){const b=new Uint32Array((a||[]).length+1);let c=b[0]=0;const d=b.length;for(let e=0;++e<d;)b[e]=c+=a[e-1].length;return b}const Ih=(a,b,c)=>{b.set(a,c);return c+a.length},Hh=(a,b,c)=>{for(let d=-1,e=a.length;++d<e;)b[c++]=a[d];return c};class R extends Bh{constructor(a,b=[],c){b=Bh.flatten(...b);super(a.type,b,c);this.va=a;if(1===b.length&&!(this instanceof Jh))return new Jh(a,b[0],this.fb)}static new(...a){let [b,c,...d]=a;"string"===typeof b||b instanceof O||(c=b,b="");a=Bh.flatten(Array.isArray(c)?[...c,...d]:c instanceof z?[c,...d]:[z.new(c,...d)]);"string"===typeof b?b=new O(b,a[0].data.type,!0):!b.nullable&&a.some(({nullCount:e})=>0<e)&&(b=b.clone({nullable:!0}));return new R(b,a)}get field(){return this.va}get name(){return this.va.name}get nullable(){return this.va.nullable}get metadata(){return this.va.metadata}clone(a=
this.o){return new R(this.va,a)}getChildAt(a){if(0>a||a>=this.numChildren)return null;const b=this.P||(this.P=[]);var c;let d;if(c=b[a])return c;if(c=(this.type.children||[])[a])if(d=this.o.map(e=>e.getChildAt(a)).filter(e=>null!=e),0<d.length)return b[a]=new R(c,d);return null}}
class Jh extends R{constructor(a,b,c){super(a,[b],c);this.La=b}search(a,b){return b?b(this,0,a):[0,a]}isValid(a){return this.La.isValid(a)}get(a){return this.La.get(a)}set(a,b){this.La.set(a,b)}indexOf(a,b){return this.La.indexOf(a,b)}};class Kh extends Tf{visit(a,b){return null==a||null==b?void 0:super.visit(a,b)}visitNull(a,b){m(b,0);return q(b)}visitInt(a,b){m(b,2);oa(b,0,a.bitWidth,0);ma(b,1,+a.isSigned,0);return q(b)}visitFloat(a,b){m(b,1);na(b,a.precision,C.HALF);return q(b)}visitBinary(a,b){m(b,0);return q(b)}visitBool(a,b){m(b,0);return q(b)}visitUtf8(a,b){m(b,0);return q(b)}visitDecimal(a,b){m(b,3);oa(b,1,a.scale,0);oa(b,0,a.precision,0);return q(b)}visitDate(a,b){m(b,1);na(b,a.unit,ub.MILLISECOND);return q(b)}visitTime(a,
b){m(b,2);na(b,a.unit,D.MILLISECOND);oa(b,1,a.bitWidth,32);return q(b)}visitTimestamp(a,b){const c=a.timezone&&va(b,a.timezone)||void 0;m(b,2);na(b,a.unit,D.SECOND);void 0!==c&&l(b,1,c);return q(b)}visitInterval(a,b){m(b,1);na(b,a.unit,xb.YEAR_MONTH);return q(b)}visitList(a,b){m(b,0);return q(b)}visitStruct(a,b){m(b,0);return q(b)}visitUnion(a,b){ta(b,4,a.typeIds.length,4);var c=a.typeIds;ta(b,4,c.length,4);for(let d=c.length-1;0<=d;d--)la(b,c[d]);c=ua(b);m(b,2);na(b,a.mode,B.Sparse);l(b,1,c);return q(b)}visitDictionary(a,
b){const c=this.visit(a.indices,b);m(b,4);pa(b,0,new ba(a.id,0),b.U(0,0));ma(b,2,+a.isOrdered,0);void 0!==c&&l(b,1,c);return q(b)}visitFixedSizeBinary(a,b){m(b,1);oa(b,0,a.byteWidth,0);return q(b)}visitFixedSizeList(a,b){m(b,1);oa(b,0,a.listSize,0);return q(b)}visitMap(a,b){m(b,1);ma(b,0,+a.keysSorted,0);return q(b)}}const Lh=new Kh;function Mh(a){return new Nh(a.count,Oh(a.columns),Ph(a.columns))}function Qh(a,b){return(a.fields||[]).filter(Boolean).map(c=>O.fromJSON(c,b))}function Rh(a,b){return(a.children||[]).filter(Boolean).map(c=>O.fromJSON(c,b))}function Oh(a){return(a||[]).reduce((b,c)=>[...b,new Sh(c.count,Th(c.VALIDITY)),...Oh(c.children)],[])}
function Ph(a,b=[]){for(let c=-1,d=(a||[]).length;++c<d;){const e=a[c];e.VALIDITY&&b.push(new Uh(b.length,e.VALIDITY.length));e.TYPE&&b.push(new Uh(b.length,e.TYPE.length));e.OFFSET&&b.push(new Uh(b.length,e.OFFSET.length));e.DATA&&b.push(new Uh(b.length,e.DATA.length));b=Ph(e.children,b)}return b}function Th(a){return(a||[]).reduce((b,c)=>b+ +(0===c),0)}function Vh(a){return new Cc(a.isSigned,a.bitWidth)}
function Wh(a,b){const c=a.type.name;switch(c){case "NONE":return new Bc;case "null":return new Bc;case "binary":return new Vc;case "utf8":return new Zc;case "bool":return new cd;case "list":return new Md((b||[])[0]);case "struct":return new Qd(b||[]);case "struct_":return new Qd(b||[])}switch(c){case "int":return b=a.type,new Cc(b.isSigned,b.bitWidth);case "floatingpoint":return new Oc(C[a.type.precision]);case "decimal":return b=a.type,new gd(b.scale,b.precision);case "date":return new kd(ub[a.type.unit]);
case "time":return b=a.type,new qd(D[b.unit],b.bitWidth);case "timestamp":return b=a.type,new yd(D[b.unit],b.timezone);case "interval":return new Gd(xb[a.type.unit]);case "union":return a=a.type,new Ud(B[a.mode],a.typeIds||[],b||[]);case "fixedsizebinary":return new $d(a.type.byteWidth);case "fixedsizelist":return new de(a.type.listSize,(b||[])[0]);case "map":return new he((b||[])[0],a.type.keysSorted)}throw Error(`Unrecognized type: "${c}"`);};class Xh{constructor(a,b,c,d){this.jc=b;this.ec=c;this.body=new Uint8Array(0);d&&(this.hb=()=>d);this.$b="number"===typeof a?a:a.low}static fromJSON(a,b){const c=new Xh(0,A.V4,b);c.hb=Yh(a,b);return c}static decode(a){a=new ea(x(Uint8Array,a));a=(new mc).i(a.v(a.position())+a.position(),a);var b=a.bodyLength();const c=a.version(),d=a.headerType();b=new Xh(b,c,d);b.hb=Zh(a,d);return b}static encode(a){const b=new da;let c=-1;a.isSchema()?c=N.encode(b,a.header()):a.isRecordBatch()?c=Nh.encode(b,a.header()):
a.isDictionaryBatch()&&(c=$h.encode(b,a.header()));m(b,5);na(b,A.V4,A.V1);l(b,2,c);ma(b,1,a.headerType,G.NONE);pa(b,3,new ba(a.bodyLength,0),b.U(0,0));a=q(b);b.finish(a);return ha(b)}static from(a,b=0){if(a instanceof N)return new Xh(0,A.V4,G.Schema,a);if(a instanceof Nh)return new Xh(b,A.V4,G.RecordBatch,a);if(a instanceof $h)return new Xh(b,A.V4,G.DictionaryBatch,a);throw Error(`Unrecognized Message header: ${a}`);}get type(){return this.headerType}get version(){return this.jc}get headerType(){return this.ec}get bodyLength(){return this.$b}header(){return this.hb()}isSchema(){return this.headerType===
G.Schema}isRecordBatch(){return this.headerType===G.RecordBatch}isDictionaryBatch(){return this.headerType===G.DictionaryBatch}}class Nh{constructor(a,b,c){this.jb=b;this.eb=c;this.xa="number"===typeof a?a:a.low}get M(){return this.jb}get length(){return this.xa}get buffers(){return this.eb}}
class $h{constructor(a,b,c=!1){this.bc=a;this.hc=c;this.fc="number"===typeof b?b:b.low}get id(){return this.fc}get data(){return this.bc}get Za(){return this.hc}get length(){return this.data.length}get M(){return this.data.M}get buffers(){return this.data.buffers}}class Uh{constructor(a,b){this.offset="number"===typeof a?a:a.low;this.length="number"===typeof b?b:b.low}}class Sh{constructor(a,b){this.length="number"===typeof a?a:a.low;this.nullCount="number"===typeof b?b:b.low}}
function Yh(a,b){return()=>{switch(b){case G.Schema:return N.fromJSON(a);case G.RecordBatch:return Nh.fromJSON(a);case G.DictionaryBatch:return $h.fromJSON(a)}throw Error(`Unrecognized Message type: { name: ${G[b]}, type: ${b} }`);}}
function Zh(a,b){return()=>{switch(b){case G.Schema:return N.decode(a.header(new ac));case G.RecordBatch:return Nh.decode(a.header(new kc),a.version());case G.DictionaryBatch:return $h.decode(a.header(new lc),a.version())}throw Error(`Unrecognized Message type: { name: ${G[b]}, type: ${b} }`);}}O.encode=ai;O.decode=bi;
O.fromJSON=function(a,b){var c;let d,e;b&&(e=a.dictionary)?(b.has(c=e.id)?(d=(d=e.indexType)?Vh(d):new Ic,c=new me(b.get(c),d,c,e.isOrdered)):(d=(d=e.indexType)?Vh(d):new Ic,b.set(c,b=Wh(a,Rh(a,b))),c=new me(b,d,c,e.isOrdered)),a=new O(a.name,c,a.nullable,new Map(Object.entries(a.customMetadata||{})))):(b=Wh(a,Rh(a,b)),a=new O(a.name,b,a.nullable,new Map(Object.entries(a.customMetadata||{}))));return a||null};N.encode=ci;N.decode=di;
N.fromJSON=function(a,b=new Map){return new N(Qh(a,b),new Map(Object.entries(a.customMetadata||{})),b)};Nh.encode=ei;Nh.decode=fi;Nh.fromJSON=Mh;$h.encode=gi;$h.decode=hi;$h.fromJSON=function(a){return new $h(Mh(a.data),a.id,a.isDelta)};Sh.encode=ii;Sh.decode=ji;Uh.encode=ki;Uh.decode=li;function di(a,b=new Map){const c=[];for(let d,e=-1,f=-1,h=$b(a);++e<h;)if(d=a.fields(e))c[++f]=O.decode(d,b);return new N(c,mi(a),b)}
function fi(a,b=A.V4){var c=a.length();const d=[];for(let f,h=-1,k=-1,n=ic(a);++h<n;)if(f=a.M(h))d[++k]=Sh.decode(f);const e=[];for(let f,h=-1,k=-1,n=jc(a);++h<n;)if(f=a.buffers(h))b<A.V4&&(f.h+=8*(h+1)),e[++k]=Uh.decode(f);return new Nh(c,d,e)}function hi(a,b=A.V4){return new $h(Nh.decode(a.data(),b),a.id(),a.Za())}function li(a){return new Uh(a.offset(),a.length())}function ji(a){return new Sh(a.length(),a.nullCount())}
function ni(a,b){const c=[];for(let d,e=-1,f=-1,h=Vb(a);++e<h;)if(d=a.children(e))c[++f]=O.decode(d,b);return c}function bi(a,b){var c;let d,e;b&&(e=a.dictionary())?(b.has(c=e.id().low)?(d=(d=Rb(e))?oi(d):new Ic,c=new me(b.get(c),d,c,e.isOrdered())):(d=(d=Rb(e))?oi(d):new Ic,b.set(c,b=pi(a,ni(a,b))),c=new me(b,d,c,e.isOrdered())),a=new O(a.name(),c,a.nullable(),mi(a))):(b=pi(a,ni(a,b)),a=new O(a.name(),b,a.nullable(),mi(a)));return a||null}
function mi(a){const b=new Map;if(a)for(let c,d,e=-1,f=a.Xa()|0;++e<f;)(c=a.Wa(e))&&null!=(d=c.key())&&b.set(d,c.value());return b}function oi(a){return new Cc(a.isSigned(),a.bitWidth())}
function pi(a,b){var c=(c=r(a.g,a.h,8))?a.g.m[a.h+c]:E.NONE;switch(c){case E.NONE:return new Bc;case E.Null:return new Bc;case E.Binary:return new Vc;case E.Utf8:return new Zc;case E.Bool:return new cd;case E.List:return new Md((b||[])[0]);case E.Struct_:return new Qd(b||[])}switch(c){case E.Int:return b=a.type(new Ib),new Cc(b.isSigned(),b.bitWidth());case E.FloatingPoint:return b=a.type(new Jb),new Oc(b.precision());case E.Decimal:return b=a.type(new Lb),new gd(b.scale(),b.precision());case E.Date:return b=
a.type(new Mb),new kd(b.unit());case E.Time:return b=a.type(new Nb),new qd(b.unit(),b.bitWidth());case E.Timestamp:return b=a.type(new Ob),new yd(b.unit(),b.timezone());case E.Interval:return b=a.type(new Pb),new Gd(b.unit());case E.Union:c=a.type(new Hb);a=c.mode();const d=r(c.g,c.h,6);c=d?new Int32Array(c.g.R().buffer,c.g.R().byteOffset+Ba(c.g,c.h+d),Ca(c.g,c.h+d)):null;return new Ud(a,c||[],b||[]);case E.FixedSizeBinary:return b=a.type(new Kb),new $d(b.byteWidth());case E.FixedSizeList:return a=
a.type(new Db),new de(a.listSize(),(b||[])[0]);case E.Map:return a=a.type(new Eb),new he((b||[])[0],a.keysSorted())}throw Error(`Unrecognized type: "${E[c]}" (${c})`);}function ci(a,b){var c=b.fields.map(d=>O.encode(a,d));ta(a,4,c.length,4);c=Yb(a,c);b=b.metadata&&0<b.metadata.size?Zb(a,[...b.metadata].map(([d,e])=>{d=va(a,`${d}`);e=va(a,`${e}`);m(a,2);l(a,0,d);l(a,1,e);return q(a)})):-1;m(a,4);l(a,1,c);na(a,qi?Bb.Yb:Bb.sc,Bb.Yb);-1!==b&&l(a,2,b);return q(a)}
function ai(a,b){let c=-1,d=-1,e=-1;var f=b.type;let h=b.typeId;K.isDictionary(f)?(h=f.dictionary.typeId,e=Lh.visit(f,a),d=Lh.visit(f.dictionary,a)):d=Lh.visit(f,a);f=(f.children||[]).map(n=>O.encode(a,n));f=Tb(a,f);const k=b.metadata&&0<b.metadata.size?Ub(a,[...b.metadata].map(([n,p])=>{n=va(a,`${n}`);p=va(a,`${p}`);m(a,2);l(a,0,n);l(a,1,p);return q(a)})):-1;b.name&&(c=va(a,b.name));m(a,7);l(a,3,d);ma(a,2,h,E.NONE);l(a,5,f);ma(a,1,+!!b.nullable,0);-1!==c&&l(a,0,c);-1!==e&&l(a,4,e);-1!==k&&l(a,6,
k);return q(a)}function ei(a,b){var c=b.M||[],d=b.buffers||[];ta(a,16,c.length,8);c.slice().reverse().forEach(e=>Sh.encode(a,e));c=ua(a);ta(a,16,d.length,8);d.slice().reverse().forEach(e=>Uh.encode(a,e));d=ua(a);m(a,4);hc(a,new ba(b.length,0));l(a,1,c);l(a,2,d);return q(a)}function gi(a,b){const c=Nh.encode(a,b.data);m(a,3);pa(a,0,new ba(b.id,0),a.U(0,0));ma(a,2,+b.Za,0);l(a,1,c);return q(a)}
function ii(a,b){var c=new ba(b.length,0);b=new ba(b.nullCount,0);ia(a,8,16);a.aa(b);a.aa(c);return a.offset()}function ki(a,b){var c=new ba(b.offset,0);b=new ba(b.length,0);ia(a,8,16);a.aa(b);a.aa(c);return a.offset()}const ri=new ArrayBuffer(2);(new DataView(ri)).setInt16(0,256,!0);const qi=256===(new Int16Array(ri))[0];const si=a=>`Expected ${G[a]} Message in stream, but was null or length 0.`,ti=a=>`Header pointer of flatbuffer-encoded ${G[a]} Message is null or length 0.`,ui=(a,b)=>`Expected to read ${a} metadata bytes, but only read ${b}.`,vi=(a,b)=>`Expected to read ${a} bytes for message body, but only read ${b}.`;
class wi{constructor(a){this.source=a instanceof Eg?a:new Eg(a)}[Symbol.iterator](){return this}next(){let a;return(a=this.readMetadataLength()).done||-1===a.value&&(a=this.readMetadataLength()).done||(a=this.readMetadata(a.value)).done?t:a}throw(a){return this.source.throw(a)}return(a){return this.source.return(a)}readMessage(a){let b;if((b=this.next()).done)return null;if(null!=a&&b.value.headerType!==a)throw Error(si(a));return b.value}readMessageBody(a){if(0>=a)return new Uint8Array(0);const b=
x(Uint8Array,this.source.read(a));if(b.byteLength<a)throw Error(vi(a,b.byteLength));return 0===b.byteOffset%8&&b.byteOffset+b.byteLength<=b.buffer.byteLength?b:b.slice()}readSchema(a=!1){const b=G.Schema,c=this.readMessage(b)?.header();if(a&&!c)throw Error(ti(b));return c}readMetadataLength(){var a=this.source.read(4);a=(a&&new ea(a))?.v(0)||0;return{done:0===a,value:a}}readMetadata(a){const b=this.source.read(a);if(!b)return t;if(b.byteLength<a)throw Error(ui(a,b.byteLength));return{done:!1,value:Xh.decode(b)}}}
class xi{constructor(a,b){this.source=a instanceof Gg?a:v(a)&&u(a.stat)&&"number"===typeof a.fd?new Jg(a,b):new Gg(a)}[Symbol.asyncIterator](){return this}async next(){let a;return(a=await this.readMetadataLength()).done||-1===a.value&&(a=await this.readMetadataLength()).done||(a=await this.readMetadata(a.value)).done?t:a}async throw(a){return await this.source.throw(a)}async return(a){return await this.source.return(a)}async readMessage(a){let b;if((b=await this.next()).done)return null;if(null!=
a&&b.value.headerType!==a)throw Error(si(a));return b.value}async readMessageBody(a){if(0>=a)return new Uint8Array(0);const b=x(Uint8Array,await this.source.read(a));if(b.byteLength<a)throw Error(vi(a,b.byteLength));return 0===b.byteOffset%8&&b.byteOffset+b.byteLength<=b.buffer.byteLength?b:b.slice()}async readSchema(a=!1){const b=G.Schema,c=(await this.readMessage(b))?.header();if(a&&!c)throw Error(ti(b));return c}async readMetadataLength(){var a=await this.source.read(4);a=(a&&new ea(a))?.v(0)||
0;return{done:0===a,value:a}}async readMetadata(a){const b=await this.source.read(a);if(!b)return t;if(b.byteLength<a)throw Error(ui(a,b.byteLength));return{done:!1,value:Xh.decode(b)}}}
class yi extends wi{constructor(a){super(new Uint8Array(0));this.u=!1;this.Ja=[];this.X=this.Gb=0;this.wa=a instanceof Ga?a:new Ga(a)}next(){var a=this.wa;if(!this.u)return this.u=!0,{done:!1,value:Xh.fromJSON(a.schema,G.Schema)};if(this.X<a.dictionaries.length)return a=a.dictionaries[this.X++],this.Ja=a.data.columns,{done:!1,value:Xh.fromJSON(a,G.DictionaryBatch)};if(this.Gb<a.ea.length)return a=a.ea[this.Gb++],this.Ja=a.columns,{done:!1,value:Xh.fromJSON(a,G.RecordBatch)};this.Ja=[];return t}readMessageBody(){function a(b){return(b||
[]).reduce((c,d)=>[...c,...(d.VALIDITY&&[d.VALIDITY]||[]),...(d.TYPE&&[d.TYPE]||[]),...(d.OFFSET&&[d.OFFSET]||[]),...(d.DATA&&[d.DATA]||[]),...a(d.children)],[])}return a(this.Ja)}readMessage(a){let b;if((b=this.next()).done)return null;if(null!=a&&b.value.headerType!==a)throw Error(si(a));return b.value}readSchema(){const a=G.Schema,b=this.readMessage(a),c=b?.header();if(!b||!c)throw Error(ti(a));return c}}const zi=new Uint8Array(6);for(let a=0;6>a;a+=1)zi[a]="ARROW1".charCodeAt(a);
function Ai(a){for(let b=-1,c=zi.length;++b<c;)if(zi[b]!==a[0+b])return!1;return!0}const Bi=zi.length,Ci=Bi+4,Di=2*Bi+4;function Ei(a,b,c){return b===c||Array.isArray(b)&&Array.isArray(c)&&b.length===c.length&&b.every((d,e)=>a.compareFields(d,c[e]))}class Fi extends Tf{compareSchemas(a,b){return a===b||b instanceof a.constructor&&Ei(this,a.fields,b.fields)}compareFields(a,b){return a===b||b instanceof a.constructor&&a.name===b.name&&a.nullable===b.nullable&&this.visit(a.type,b.type)}}function Gi(a,b){return b instanceof a.constructor}function Hi(a,b){return a===b||Gi(a,b)}
function Ii(a,b){return a===b||Gi(a,b)&&a.bitWidth===b.bitWidth&&a.isSigned===b.isSigned}function Ji(a,b){return a===b||Gi(a,b)&&a.precision===b.precision}function Ki(a,b){return a===b||Gi(a,b)&&a.unit===b.unit}function Li(a,b){return a===b||Gi(a,b)&&a.unit===b.unit&&a.timezone===b.timezone}function Mi(a,b){return a===b||Gi(a,b)&&a.unit===b.unit&&a.bitWidth===b.bitWidth}
function Ni(a,b){return a===b||Gi(a,b)&&a.mode===b.mode&&a.typeIds.every((c,d)=>c===b.typeIds[d])&&Ei(Oi,a.children,b.children)}function Pi(a,b){return a===b||Gi(a,b)&&a.unit===b.unit}g=Fi.prototype;g.visitNull=Hi;g.visitBool=Hi;g.visitInt=Ii;g.visitInt8=Ii;g.visitInt16=Ii;g.visitInt32=Ii;g.visitInt64=Ii;g.visitUint8=Ii;g.visitUint16=Ii;g.visitUint32=Ii;g.visitUint64=Ii;g.visitFloat=Ji;g.visitFloat16=Ji;g.visitFloat32=Ji;g.visitFloat64=Ji;g.visitUtf8=Hi;g.visitBinary=Hi;
g.visitFixedSizeBinary=function(a,b){return a===b||Gi(a,b)&&a.byteWidth===b.byteWidth};g.visitDate=Ki;g.visitDateDay=Ki;g.visitDateMillisecond=Ki;g.visitTimestamp=Li;g.visitTimestampSecond=Li;g.visitTimestampMillisecond=Li;g.visitTimestampMicrosecond=Li;g.visitTimestampNanosecond=Li;g.visitTime=Mi;g.visitTimeSecond=Mi;g.visitTimeMillisecond=Mi;g.visitTimeMicrosecond=Mi;g.visitTimeNanosecond=Mi;g.visitDecimal=Hi;
g.visitList=function(a,b){return a===b||Gi(a,b)&&a.children.length===b.children.length&&Ei(Oi,a.children,b.children)};g.visitStruct=function(a,b){return a===b||Gi(a,b)&&a.children.length===b.children.length&&Ei(Oi,a.children,b.children)};g.visitUnion=Ni;g.visitDenseUnion=Ni;g.visitSparseUnion=Ni;g.visitDictionary=function(a,b){return a===b||Gi(a,b)&&a.id===b.id&&a.isOrdered===b.isOrdered&&Oi.visit(a.indices,b.indices)&&Oi.visit(a.dictionary,b.dictionary)};g.visitInterval=Pi;
g.visitIntervalDayTime=Pi;g.visitIntervalYearMonth=Pi;g.visitFixedSizeList=function(a,b){return a===b||Gi(a,b)&&a.listSize===b.listSize&&a.children.length===b.children.length&&Ei(Oi,a.children,b.children)};g.visitMap=function(a,b){return a===b||Gi(a,b)&&a.keysSorted===b.keysSorted&&a.children.length===b.children.length&&Ei(Oi,a.children,b.children)};const Oi=new Fi;function Qi(a,b){return Oi.compareSchemas(a,b)};class Ri extends Tf{constructor(){super();this.Ka=0;this.jb=[];this.eb=[];this.ac=[]}static Da(...a){var b=new Ri;a=Ch(Si,a,[],0);[b=b]=b.visitMany(a);return b}visit(a){if(!K.isDictionary(a.type)){const b=a.data,c=a.length,d=a.nullCount;if(2147483647<c)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");K.isNull(a.type)||Ti.call(this,0>=d?new Uint8Array(0):rc(b.offset,c,b.nullBitmap));this.M.push(new Sh(c,d))}return super.visit(a)}visitNull(){return this}visitDictionary(a){return this.visit(a.indices)}get M(){return this.jb}get buffers(){return this.eb}get byteLength(){return this.Ka}get ub(){return this.ac}}
function Ti(a){const b=a.byteLength+7&-8;this.buffers.push(a);this.ub.push(new Uh(this.Ka,b));this.Ka+=b;return this}function Ui(a){return Ti.call(this,a.values.subarray(0,a.length*a.stride))}function Vi(a){const b=a.length,c=a.values;a=a.valueOffsets;const d=a[0],e=Math.min(a[b]-d,c.byteLength-d);Ti.call(this,bb(-a[0],b,a));Ti.call(this,c.subarray(d,d+e));return this}function Wi(a){const b=a.length,c=a.valueOffsets;c&&Ti.call(this,bb(c[0],b,c));return this.visit(a.getChildAt(0))}
function Xi(a){return this.visitMany(a.type.children.map((b,c)=>a.getChildAt(c)).filter(Boolean))[0]}g=Ri.prototype;g.visitBool=function(a){let b;return a.nullCount>=a.length?Ti.call(this,new Uint8Array(0)):(b=a.values)instanceof Uint8Array?Ti.call(this,rc(a.offset,a.length,b)):Ti.call(this,sc(a))};g.visitInt=Ui;g.visitFloat=Ui;g.visitUtf8=Vi;g.visitBinary=Vi;g.visitFixedSizeBinary=Ui;g.visitDate=Ui;g.visitTimestamp=Ui;g.visitTime=Ui;g.visitDecimal=Ui;g.visitList=Wi;g.visitStruct=Xi;
g.visitUnion=function(a){const b=a.type,c=a.length;var d=a.typeIds,e=a.valueOffsets;Ti.call(this,d);if(b.mode===B.Sparse)return Xi.call(this,a);if(b.mode===B.Dense){if(0>=a.offset)return Ti.call(this,e),Xi.call(this,a);var f=d.reduce((n,p)=>Math.max(n,p),d[0]);const h=new Int32Array(f+1);f=(new Int32Array(f+1)).fill(-1);const k=new Int32Array(c);e=bb(-e[0],c,e);for(let n,p,w=-1;++w<c;)-1===(p=f[n=d[w]])&&(p=f[n]=e[n]),k[w]=e[w]-p,++h[n];Ti.call(this,k);for(let n,p=-1,w=b.children.length;++p<w;)if(n=
a.getChildAt(p))d=b.typeIds[p],this.visit(n.slice(f[d],Math.min(c,h[d])))}return this};g.visitInterval=Ui;g.visitFixedSizeList=Wi;g.visitMap=Wi;class Yi extends Tf{visit(a){return null==a?void 0:super.visit(a)}visitNull({typeId:a}){return{name:E[a].toLowerCase()}}visitInt({typeId:a,bitWidth:b,isSigned:c}){return{name:E[a].toLowerCase(),bitWidth:b,isSigned:c}}visitFloat({typeId:a,precision:b}){return{name:E[a].toLowerCase(),precision:C[b]}}visitBinary({typeId:a}){return{name:E[a].toLowerCase()}}visitBool({typeId:a}){return{name:E[a].toLowerCase()}}visitUtf8({typeId:a}){return{name:E[a].toLowerCase()}}visitDecimal({typeId:a,scale:b,precision:c}){return{name:E[a].toLowerCase(),
scale:b,precision:c}}visitDate({typeId:a,unit:b}){return{name:E[a].toLowerCase(),unit:ub[b]}}visitTime({typeId:a,unit:b,bitWidth:c}){return{name:E[a].toLowerCase(),unit:D[b],bitWidth:c}}visitTimestamp({typeId:a,timezone:b,unit:c}){return{name:E[a].toLowerCase(),unit:D[c],timezone:b}}visitInterval({typeId:a,unit:b}){return{name:E[a].toLowerCase(),unit:xb[b]}}visitList({typeId:a}){return{name:E[a].toLowerCase()}}visitStruct({typeId:a}){return{name:E[a].toLowerCase()}}visitUnion({typeId:a,mode:b,typeIds:c}){return{name:E[a].toLowerCase(),
mode:B[b],typeIds:[...c]}}visitDictionary(a){return this.visit(a.dictionary)}visitFixedSizeBinary({typeId:a,byteWidth:b}){return{name:E[a].toLowerCase(),byteWidth:b}}visitFixedSizeList({typeId:a,listSize:b}){return{name:E[a].toLowerCase(),listSize:b}}visitMap({typeId:a,keysSorted:b}){return{name:E[a].toLowerCase(),keysSorted:b}}};class Zi extends Tf{static Da(...a){var b=new Zi,c=b.visitMany;a=Dh(Si,a,[],0);return c.call(b,a)}visit(a){const b=a.data,c=a.name,d=a.length,e=b.offset,f=b.nullCount,h=b.nullBitmap;a=K.isDictionary(a.type)?a.type.indices:a.type;const k=Object.assign([],b.buffers,{[J.VALIDITY]:void 0});return{name:c,count:d,VALIDITY:K.isNull(a)?void 0:0>=f?Array.from({length:d},()=>1):[...(new tc(h,e,d,null,pc))],...super.visit(z.new(b.clone(a,e,d,0,k)))}}visitNull(){return{}}visitBool({values:a,offset:b,length:c}){return{DATA:[...(new tc(a,
b,c,null,oc))]}}visitInt(a){return{DATA:64>a.type.bitWidth?[...a.values]:[...$i(a.values,2)]}}visitFloat(a){return{DATA:[...a.values]}}visitUtf8(a){return{DATA:[...a],OFFSET:[...a.valueOffsets]}}visitBinary(a){return{DATA:[...aj(a)],OFFSET:[...a.valueOffsets]}}visitFixedSizeBinary(a){return{DATA:[...aj(a)]}}visitDate(a){return{DATA:a.type.unit===ub.DAY?[...a.values]:[...$i(a.values,2)]}}visitTimestamp(a){return{DATA:[...$i(a.values,2)]}}visitTime(a){return{DATA:a.type.unit<D.MICROSECOND?[...a.values]:
[...$i(a.values,2)]}}visitDecimal(a){return{DATA:[...$i(a.values,4)]}}visitList(a){return{OFFSET:[...a.valueOffsets],children:a.type.children.map((b,c)=>this.visit(new R(b,[a.getChildAt(c)])))}}visitStruct(a){return{children:a.type.children.map((b,c)=>this.visit(new R(b,[a.getChildAt(c)])))}}visitUnion(a){return{TYPE:[...a.typeIds],OFFSET:a.type.mode===B.Dense?[...a.valueOffsets]:void 0,children:a.type.children.map((b,c)=>this.visit(new R(b,[a.getChildAt(c)])))}}visitInterval(a){return{DATA:[...a.values]}}visitFixedSizeList(a){return{children:a.type.children.map((b,
c)=>this.visit(new R(b,[a.getChildAt(c)])))}}visitMap(a){return{OFFSET:[...a.valueOffsets],children:a.type.children.map((b,c)=>this.visit(new R(b,[a.getChildAt(c)])))}}}function*aj(a){for(const b of a)yield b.reduce((c,d)=>`${c}${("0"+(d&255).toString(16)).slice(-2)}`,"").toUpperCase()}function*$i(a,b){for(let c=-1,d=a.length/b;++c<d;)yield`${hf.new(a.subarray((c+0)*b,(c+1)*b),!1)}`};function S(a,b){a.Ca&&(b=x(Uint8Array,b))&&0<b.byteLength&&(a.H.write(b),a.ya+=b.byteLength);return a}function bj(a,b){return 0<b?S(a,new Uint8Array(b)):a}function cj(a,b){let c,d,e;for(let f=-1,h=b.length;++f<h;)(c=b[f])&&0<(d=c.byteLength)&&(S(a,c),0<(e=(d+7&-8)-d)&&bj(a,e))}
class dj extends Ja{constructor(a){super();this.ya=0;this.Ca=!1;this.H=new Dg;this.u=null;this.ua=[];this.Oa=[];this.ga=new Map;v(a)||(a={autoDestroy:!0,Wb:!1});this.Ha="boolean"===typeof a.autoDestroy?a.autoDestroy:!0;this.qb="boolean"===typeof a.Wb?a.Wb:!1}static throughNode(){throw Error('"throughNode" not available in this environment');}static throughDOM(){throw Error('"throughDOM" not available in this environment');}toString(a=!1){return this.H.toString(a)}toUint8Array(a=!1){return this.H.toUint8Array(a)}writeAll(a){return v(a)&&
u(a.then)?a.then(b=>this.writeAll(b)):Sa(a)?ej(this,a):fj(this,a)}get closed(){return this.H.closed}[Symbol.asyncIterator](){return this.H[Symbol.asyncIterator]()}toDOMStream(a){return this.H.toDOMStream(a)}toNodeStream(a){return this.H.toNodeStream(a)}close(){return this.reset().H.close()}abort(a){return this.reset().H.abort(a)}finish(){this.Ha?this.close():this.reset(this.H,this.u);return this}reset(a=this.H,b=null){a===this.H||a instanceof Dg?this.H=a:(this.H=new Dg,a&&v(a)&&u(a.abort)&&u(a.getWriter)&&
!(a instanceof Ja)?this.toDOMStream({type:"bytes"}).pipeTo(a):a&&v(a)&&u(a.end)&&u(a.write)&&"boolean"===typeof a.writable&&!(a instanceof Ja)&&Ia(this.toNodeStream({uc:!1}),a));this.Ca&&this.u&&this.Ra(this.u);this.Ca=!1;this.ua=[];this.Oa=[];this.ga=new Map;b&&Qi(b,this.u)||(null===b?(this.ya=0,this.u=null):(this.Ca=!0,this.u=b,this.rb(b)));return this}write(a){let b=null;if(this.H){if(null==a||a instanceof T&&!(b=a.schema)||a instanceof Si&&!(b=a.schema))return this.finish()&&void 0}else throw Error("RecordBatchWriter is closed");
if(b&&!Qi(b,this.u)){if(this.Ca&&this.Ha)return this.close();this.reset(this.H,b)}a instanceof Si?a instanceof gj||this.Qb(a):a instanceof T?this.writeAll(a.chunks):Ra(a)&&this.writeAll(a)}Sa(a){const b=Xh.encode(a),c=b.byteLength,d=this.qb?4:8,e=c+d+7&-8,f=e-c-d;a.headerType===G.RecordBatch?this.Oa.push(new Cg(e,a.bodyLength,this.ya)):a.headerType===G.DictionaryBatch&&this.ua.push(new Cg(e,a.bodyLength,this.ya));this.qb||S(this,Int32Array.of(-1));S(this,Int32Array.of(e-d));0<c&&S(this,b);return bj(this,
f)}rb(a){this.Sa(Xh.from(a))}Ra(){return this.qb?S(this,Int32Array.of(0)):S(this,Int32Array.of(-1,0))}Qb(a){const {byteLength:b,M:c,ub:d,buffers:e}=Ri.Da(a),f=Xh.from(new Nh(a.length,c,d),b);cj(this.Qa(a).Sa(f),e)}Pb(a,b,c=!1){this.ga.set(b,a.length+(this.ga.get(b)||0));const {byteLength:d,M:e,ub:f,buffers:h}=Ri.Da(a);a=Xh.from(new $h(new Nh(a.length,e,f),b,c),d);cj(this.Sa(a),h)}Qa(a){for(let [b,c]of a.dictionaries)if(a=this.ga.get(b)||0,0===a||0<(c=c.slice(a)).length){const d="chunks"in c?c.chunks:
[c];for(const e of d)this.Pb(e,b,0<a),a+=e.length}return this}}class hj extends dj{static writeAll(a,b){const c=new hj(b);return v(a)&&u(a.then)?a.then(d=>c.writeAll(d)):Sa(a)?ej(c,a):fj(c,a)}}class ij extends dj{static writeAll(a){const b=new ij;return v(a)&&u(a.then)?a.then(c=>b.writeAll(c)):Sa(a)?ej(b,a):fj(b,a)}constructor(){super();this.Ha=!0}rb(){bj(S(this,zi),2)}Ra(a){const b=Ag.encode(new Ag(a,A.V4,this.Oa,this.ua));return S(S(S(super.Ra(a),b),Int32Array.of(b.byteLength)),zi)}}
class jj extends dj{constructor(){super();this.Ha=!0;this.ba=[];this.fa=[]}static writeAll(a){return(new jj).writeAll(a)}Sa(){return this}Ra(){return this}rb(a){S(this,`{\n  "schema": ${JSON.stringify({fields:a.fields.map(kj)},null,2)}`)}Qa(a){0<a.dictionaries.size&&this.fa.push(a);return this}Pb(a,b,c=!1){this.ga.set(b,a.length+(this.ga.get(b)||0));S(this,0===this.ua.length?"    ":",\n    ");S(this,`${lj(a,b,c)}`);this.ua.push(new Cg(0,0,0))}Qb(a){this.Qa(a);this.ba.push(a)}close(){if(0<this.fa.length){S(this,
',\n  "dictionaries": [\n');for(var a of this.fa)super.Qa(a);S(this,"\n  ]")}if(0<this.ba.length){for(let b=-1,c=this.ba.length;++b<c;)S(this,0===b?',\n  "batches": [\n    ':",\n    "),a=this.ba[b],a=JSON.stringify({count:a.length,columns:Zi.Da(a)},null,2),S(this,`${a}`),this.Oa.push(new Cg(0,0,0));S(this,"\n  ]")}this.u&&S(this,"\n}");this.fa=[];this.ba=[];return super.close()}}
function fj(a,b){let c=b;b instanceof T&&(c=b.chunks,a.reset(void 0,b.schema));for(const d of c)a.write(d);return a.finish()}async function ej(a,b){for await(const c of b)a.write(c);return a.finish()}function kj({name:a,type:b,nullable:c}){const d=new Yi;return{name:a,nullable:c,type:d.visit(b),children:(b.children||[]).map(kj),dictionary:K.isDictionary(b)?{id:b.id,isOrdered:b.isOrdered,indexType:d.visit(b.indices)}:void 0}}
function lj(a,b,c=!1){const d=Zi.Da(new R(new O(`${b}`,a.type,0<a.nullCount),[a]));return JSON.stringify({id:b,isDelta:c,data:{count:a.length,columns:d}},null,2)};const mj=new Uint8Array(0);function nj(a,b,c=b.reduce((d,e)=>Math.max(d,e.length),0)){let d,e=-1;const f=b.length,h=[...a.fields],k=[],n=(c+63&-64)>>3;for(;++e<f;)(d=b[e])&&d.length===c?k[e]=d:((a=h[e]).nullable||(h[e]=h[e].clone({nullable:!0})),k[e]=d?se(d,c):L.new(a.type,0,c,c,[mj,mj,new Uint8Array(n),mj]));return[new N(h),c,k]}function oj(a){return pj(new N(a.map(({field:b})=>b)),a)}function pj(a,b){return qj(a,b.map(c=>c instanceof Bh?c.chunks.map(d=>d.data):[c.data]))}
function qj(a,b){const c=[...a.fields],d=[],e={xb:b.reduce((fa,ob)=>Math.max(fa,ob.length),0)};let f=0,h=0,k=-1;const n=b.length;let p,w=[];for(;0<e.xb--;){h=Number.POSITIVE_INFINITY;for(k=-1;++k<n;)w[k]=p=b[k].shift(),h=Math.min(h,p?p.length:h);isFinite(h)&&(w=rj(c,h,w,b,e),0<h&&(d[f++]=[h,w.slice()]))}return[a=new N(c,a.metadata),d.map(fa=>new Si(a,...fa))]}
function rj(a,b,c,d,e){let f,h,k=0,n=-1;const p=d.length,w=(b+63&-64)>>3;for(;++n<p;)(f=c[n])&&(k=f.length)>=b?k===b?c[n]=f:(c[n]=f.slice(0,b),f=f.slice(b,k-b),e.xb=Math.max(e.xb,d[n].unshift(f))):((h=a[n]).nullable||(a[n]=h.clone({nullable:!0})),c[n]=f?se(f,b):L.new(h.type,0,b,b,[mj,mj,new Uint8Array(w),mj]));return c};class U extends z{constructor(a,b){super();this.P=b;this.numChildren=a.childData.length;this.Hb(this.data=a)}get type(){return this.data.type}get typeId(){return this.data.typeId}get length(){return this.data.length}get offset(){return this.data.offset}get stride(){return this.data.stride}get nullCount(){return this.data.nullCount}get byteLength(){return this.data.byteLength}get VectorName(){return`${H[this.typeId]}Vector`}get ArrayType(){return this.type.ArrayType}get values(){return this.data.values}get typeIds(){return this.data.typeIds}get nullBitmap(){return this.data.nullBitmap}get valueOffsets(){return this.data.valueOffsets}get [Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}clone(a,
b=this.P){return z.new(a,b)}concat(...a){return Bh.concat(this,...a)}slice(a,b){return jh(this,a,b,this.ob)}isValid(a){return 0<this.nullCount?(a=this.offset+a,0!==(this.nullBitmap[a>>3]&1<<a%8)):!0}getChildAt(a){return 0>a||a>=this.numChildren?null:(this.P||(this.P=[]))[a]||(this.P[a]=z.new(this.data.childData[a]))}toJSON(){return[...this]}ob(a,b,c){return a.clone(a.data.slice(b,c-b),null)}Hb(){}}U.prototype[Symbol.isConcatSpreadable]=!0;class sj extends U{asUtf8(){return z.new(this.data.clone(new Zc))}};class tj extends U{static from(a){return uj(()=>new cd,a)}};class yj extends U{static from(...a){return 2===a.length?uj(()=>a[1]===ub.DAY?new od:new pd,a[0]):uj(()=>new pd,a[0])}}class zj extends yj{}class Aj extends yj{};class Bj extends U{};class Cj extends U{constructor(a){super(a);this.indices=z.new(a.clone(this.type.indices))}static from(...a){if(3===a.length){const [b,c,d]=a,e=new me(b.type,c,null,null);return z.new(L.Dictionary(e,0,d.length,0,null,d,b))}return uj(()=>a[0].type,a[0])}get dictionary(){return this.data.dictionary}reverseLookup(a){return this.dictionary.indexOf(a)}getKey(a){return this.indices.get(a)}getValue(a){return this.dictionary.get(a)}setKey(a,b){return this.indices.set(a,b)}setValue(a,b){return this.dictionary.set(a,
b)}}Cj.prototype.indices=null;class Dj extends U{};class Ej extends U{};class Fj extends U{static from(a){let b=Gj(this);if(a instanceof ArrayBuffer||ArrayBuffer.isView(a)){var c=Hj(a.constructor)||b;null===b&&(b=c);if(b&&b===c){c=new b;const d=a.byteLength/c.ArrayType.BYTES_PER_ELEMENT;if(b!==Sc||a.constructor===Uint16Array)return z.new(L.Float(c,0,d,0,null,a))}}if(b)return uj(()=>new b,a);if(a instanceof DataView||a instanceof ArrayBuffer)throw new TypeError(`Cannot infer float type from instance of ${a.constructor.name}`);throw new TypeError("Unrecognized FloatVector input");
}}class Ij extends Fj{toFloat32Array(){return new Float32Array(this)}toFloat64Array(){return new Float64Array(this)}}class Jj extends Fj{}class Kj extends Fj{}const Hj=a=>{switch(a){case Uint16Array:return Sc;case Float32Array:return Tc;case Float64Array:return Uc;default:return null}},Gj=a=>{switch(a){case Ij:return Sc;case Jj:return Tc;case Kj:return Uc;default:return null}};class Lj extends U{}class Mj extends Lj{}class Nj extends Lj{};class Oj extends U{static from(...a){const [b,c=!1]=a;let d=Pj(this,c);if(b instanceof ArrayBuffer||ArrayBuffer.isView(b))if(a=Qj(b.constructor,c)||d,null===d&&(d=a),d&&d===a){a=new d;let e=b.byteLength/a.ArrayType.BYTES_PER_ELEMENT;Rj(d,b.constructor)&&(e*=.5);return z.new(L.Int(a,0,e,0,null,b))}if(d)return uj(()=>new d,b);if(b instanceof DataView||b instanceof ArrayBuffer)throw new TypeError(`Cannot infer integer type from instance of ${b.constructor.name}`);throw new TypeError("Unrecognized IntVector input");
}}class Sj extends Oj{}class Tj extends Oj{}class Uj extends Oj{}class Vj extends Oj{toBigInt64Array(){return x(Pa,this.values)}get values64(){return this.pb||(this.pb=this.toBigInt64Array())}}class Wj extends Oj{}class Xj extends Oj{}class Yj extends Oj{}class Zj extends Oj{toBigUint64Array(){return x(Qa,this.values)}get values64(){return this.pb||(this.pb=this.toBigUint64Array())}}
const Rj=(a,b)=>(a===Jc||a===Nc)&&(b===Int32Array||b===Uint32Array),Qj=(a,b)=>{switch(a){case Int8Array:return Gc;case Int16Array:return Hc;case Int32Array:return b?Jc:Ic;case Pa:return Jc;case Uint8Array:return Kc;case Uint16Array:return Lc;case Uint32Array:return b?Nc:Mc;case Qa:return Nc;default:return null}},Pj=(a,b)=>{switch(a){case Sj:return Gc;case Tj:return Hc;case Uj:return b?Jc:Ic;case Vj:return Jc;case Wj:return Kc;case Xj:return Lc;case Yj:return b?Nc:Mc;case Zj:return Nc;default:return null}};class ak extends U{};class bk extends U{asList(){return z.new(this.data.clone(new Md(this.type.children[0])))}bind(a){const b=this.getChildAt(0),{[a]:c,[a+1]:d}=this.valueOffsets;return new eh(b.slice(c,d))}};class ck extends U{};const dk=Symbol.for("rowIndex");class ek extends U{bind(a){var b=this.ic||(this.ic=new gh(this));b=Object.create(b);b[dk]=a;return b}};class fk extends U{}class gk extends fk{}class hk extends fk{}class ik extends fk{}class jk extends fk{};class kk extends U{}class lk extends kk{}class mk extends kk{}class nk extends kk{}class ok extends kk{};class pk extends U{get typeIdToChildIndex(){return this.data.type.typeIdToChildIndex}}class qk extends pk{get valueOffsets(){return this.data.valueOffsets}}class rk extends pk{};class sk extends U{static from(a){return uj(()=>new Zc,a)}asBinary(){return z.new(this.data.clone(new Vc))}};function tk(a){return function(){return a(this)}}function uk(a){return function(b){return a(this,b)}}function vk(a){return function(b,c){return a(this,b,c)}};class wk extends Tf{}
const xk=(a,b)=>4294967296*a[b+1]+(a[b]>>>0),yk=(a,b,c)=>{const {[c]:d,[c+1]:e}=b;return null!=d&&null!=e?a.subarray(d,e):null},zk=({values:a},b)=>new Date(864E5*a[b]),Ak=({values:a},b)=>new Date(xk(a,2*b)),Bk=({stride:a,values:b},c)=>b[a*c],Ck=({stride:a,values:b},c)=>Se(b[a*c]),Dk=({stride:a,values:b,type:c},d)=>hf.new(b.subarray(a*d,a*(d+1)),c.isSigned),Ek=({values:a},b)=>1E3*xk(a,2*b),Fk=({values:a},b)=>xk(a,2*b),Gk=({values:a},b)=>{b*=2;return a[b+1]/1E3*4294967296+(a[b]>>>0)/1E3},Hk=({values:a},
b)=>{b*=2;return a[b+1]/1E6*4294967296+(a[b]>>>0)/1E6},Ik=({values:a,stride:b},c)=>a[b*c],Jk=({values:a,stride:b},c)=>a[b*c],Kk=({values:a},b)=>new df(a.subarray(2*b,2*(b+1))),Lk=({values:a},b)=>new df(a.subarray(2*b,2*(b+1))),Mk=(a,b)=>{const c=a.getChildAt(a.typeIdToChildIndex[a.typeIds[b]]);return c?c.get(a.valueOffsets[b]):null},Nk=(a,b)=>(a=a.getChildAt(a.typeIdToChildIndex[a.typeIds[b]]))?a.get(b):null,Ok=({values:a},b)=>a.subarray(2*b,2*(b+1)),Pk=({values:a},b)=>{a=a[b];b=new Int32Array(2);
b[0]=a/12|0;b[1]=a%12|0;return b};g=wk.prototype;g.visitNull=()=>null;g.visitBool=({offset:a,values:b},c)=>{a+=c;return 0!==(b[a>>3]&1<<a%8)};g.visitInt=(a,b)=>64>a.type.bitWidth?Bk(a,b):Dk(a,b);g.visitInt8=Bk;g.visitInt16=Bk;g.visitInt32=Bk;g.visitInt64=Dk;g.visitUint8=Bk;g.visitUint16=Bk;g.visitUint32=Bk;g.visitUint64=Dk;g.visitFloat=(a,b)=>a.type.precision!==C.HALF?Bk(a,b):Ck(a,b);g.visitFloat16=Ck;g.visitFloat32=Bk;g.visitFloat64=Bk;
g.visitUtf8=({values:a,valueOffsets:b},c)=>{a=yk(a,b,c);return null!==a?Da.decode(a):null};g.visitBinary=({values:a,valueOffsets:b},c)=>yk(a,b,c);g.visitFixedSizeBinary=({stride:a,values:b},c)=>b.subarray(a*c,a*(c+1));g.visitDate=(a,b)=>a.type.unit===ub.DAY?zk(a,b):Ak(a,b);g.visitDateDay=zk;g.visitDateMillisecond=Ak;g.visitTimestamp=(a,b)=>{switch(a.type.unit){case D.SECOND:return Ek(a,b);case D.MILLISECOND:return Fk(a,b);case D.MICROSECOND:return Gk(a,b);case D.NANOSECOND:return Hk(a,b)}};
g.visitTimestampSecond=Ek;g.visitTimestampMillisecond=Fk;g.visitTimestampMicrosecond=Gk;g.visitTimestampNanosecond=Hk;g.visitTime=(a,b)=>{switch(a.type.unit){case D.SECOND:return Ik(a,b);case D.MILLISECOND:return Jk(a,b);case D.MICROSECOND:return Kk(a,b);case D.NANOSECOND:return Lk(a,b)}};g.visitTimeSecond=Ik;g.visitTimeMillisecond=Jk;g.visitTimeMicrosecond=Kk;g.visitTimeNanosecond=Lk;g.visitDecimal=({values:a},b)=>new ff(a.subarray(4*b,4*(b+1)));
g.visitList=(a,b)=>{const c=a.getChildAt(0),d=a.valueOffsets;a=a.stride;return c.slice(d[b*a],d[b*a+1])};g.visitStruct=(a,b)=>a.bind(b);g.visitUnion=(a,b)=>a.type.mode===B.Dense?Mk(a,b):Nk(a,b);g.visitDenseUnion=Mk;g.visitSparseUnion=Nk;g.visitDictionary=(a,b)=>a.getValue(a.getKey(b));g.visitInterval=(a,b)=>a.type.unit===xb.DAY_TIME?Ok(a,b):Pk(a,b);g.visitIntervalDayTime=Ok;g.visitIntervalYearMonth=Pk;g.visitFixedSizeList=(a,b)=>{const c=a.getChildAt(0);a=a.stride;return c.slice(b*a,(b+1)*a)};
g.visitMap=(a,b)=>a.bind(b);const Qk=new wk;class Rk extends Tf{}function V(a,b,c){if(void 0===b)return-1;if(null===b){a:{const e=a.data.nullBitmap;if(e&&!(0>=a.nullCount)){b=0;for(var d of new tc(e,a.data.offset+(c||0),a.length,e,oc)){if(!d){a=b;break a}++b}}a=-1}return a}d=mh(b);for(let e=(c||0)-1,f=a.length;++e<f;)if(d(a.get(e)))return e;return-1}function Sk(a,b,c){b=mh(b);for(let d=(c||0)-1,e=a.length;++d<e;)if(b(a.get(d)))return d;return-1}g=Rk.prototype;g.visitNull=function(a,b){return null===b&&0<a.length?0:-1};g.visitBool=V;
g.visitInt=V;g.visitInt8=V;g.visitInt16=V;g.visitInt32=V;g.visitInt64=V;g.visitUint8=V;g.visitUint16=V;g.visitUint32=V;g.visitUint64=V;g.visitFloat=V;g.visitFloat16=V;g.visitFloat32=V;g.visitFloat64=V;g.visitUtf8=V;g.visitBinary=V;g.visitFixedSizeBinary=V;g.visitDate=V;g.visitDateDay=V;g.visitDateMillisecond=V;g.visitTimestamp=V;g.visitTimestampSecond=V;g.visitTimestampMillisecond=V;g.visitTimestampMicrosecond=V;g.visitTimestampNanosecond=V;g.visitTime=V;g.visitTimeSecond=V;
g.visitTimeMillisecond=V;g.visitTimeMicrosecond=V;g.visitTimeNanosecond=V;g.visitDecimal=V;g.visitList=V;g.visitStruct=V;g.visitUnion=V;g.visitDenseUnion=Sk;g.visitSparseUnion=Sk;g.visitDictionary=V;g.visitInterval=V;g.visitIntervalDayTime=V;g.visitIntervalYearMonth=V;g.visitFixedSizeList=V;g.visitMap=V;const Tk=new Rk;class Uk extends Tf{}function Vk(a){const b=Qk.getVisitFn(a);return new tc(a.data.nullBitmap,a.data.offset,a.length,a,(c,d,e,f)=>0!==(e&1<<f)?b(c,d):null)}class Wk{constructor(a,b){this.Z=a;this.nc=b;this.index=0}next(){return this.index<this.Z.length?{value:this.nc(this.Z,this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}}
function W(a){if(0<a.nullCount)return Vk(a);const b=a.type,c=a.typeId,d=a.length;return 1===a.stride&&(c===H.Timestamp||c===H.Int&&64!==b.bitWidth||c===H.Time&&64!==b.bitWidth||c===H.Float&&0<b.precision)?a.data.values.subarray(0,d)[Symbol.iterator]():new Wk(a,Qk.getVisitFn(a))}g=Uk.prototype;g.visitNull=W;g.visitBool=W;g.visitInt=W;g.visitInt8=W;g.visitInt16=W;g.visitInt32=W;g.visitInt64=W;g.visitUint8=W;g.visitUint16=W;g.visitUint32=W;g.visitUint64=W;g.visitFloat=W;g.visitFloat16=W;
g.visitFloat32=W;g.visitFloat64=W;g.visitUtf8=W;g.visitBinary=W;g.visitFixedSizeBinary=W;g.visitDate=W;g.visitDateDay=W;g.visitDateMillisecond=W;g.visitTimestamp=W;g.visitTimestampSecond=W;g.visitTimestampMillisecond=W;g.visitTimestampMicrosecond=W;g.visitTimestampNanosecond=W;g.visitTime=W;g.visitTimeSecond=W;g.visitTimeMillisecond=W;g.visitTimeMicrosecond=W;g.visitTimeNanosecond=W;g.visitDecimal=W;g.visitList=W;g.visitStruct=W;g.visitUnion=W;g.visitDenseUnion=W;g.visitSparseUnion=W;
g.visitDictionary=W;g.visitInterval=W;g.visitIntervalDayTime=W;g.visitIntervalYearMonth=W;g.visitFixedSizeList=W;g.visitMap=W;const Xk=new Uk;class Yk extends Tf{}function X(a){const b=a.length,c=a.stride;switch(a.type.typeId){case H.Int:case H.Float:case H.Decimal:case H.Time:case H.Timestamp:return a.data.values.subarray(0,b*c)}return[...Xk.visit(a)]}g=Yk.prototype;g.visitNull=X;g.visitBool=X;g.visitInt=X;g.visitInt8=X;g.visitInt16=X;g.visitInt32=X;g.visitInt64=X;g.visitUint8=X;g.visitUint16=X;g.visitUint32=X;g.visitUint64=X;g.visitFloat=X;g.visitFloat16=X;g.visitFloat32=X;g.visitFloat64=X;g.visitUtf8=X;g.visitBinary=X;
g.visitFixedSizeBinary=X;g.visitDate=X;g.visitDateDay=X;g.visitDateMillisecond=X;g.visitTimestamp=X;g.visitTimestampSecond=X;g.visitTimestampMillisecond=X;g.visitTimestampMicrosecond=X;g.visitTimestampNanosecond=X;g.visitTime=X;g.visitTimeSecond=X;g.visitTimeMillisecond=X;g.visitTimeMicrosecond=X;g.visitTimeNanosecond=X;g.visitDecimal=X;g.visitList=X;g.visitStruct=X;g.visitUnion=X;g.visitDenseUnion=X;g.visitSparseUnion=X;g.visitDictionary=X;g.visitInterval=X;g.visitIntervalDayTime=X;
g.visitIntervalYearMonth=X;g.visitFixedSizeList=X;g.visitMap=X;const Zk=new Yk;const $k=(a,b)=>a+b,al=a=>`Cannot compute the byte width of variable-width column ${a}`;function bl(a,b){return(b||[]).map(c=>a.visit(c.type))}
class cl extends Tf{visitNull(){return 0}visitInt(a){return a.bitWidth/8}visitFloat(a){return a.ArrayType.BYTES_PER_ELEMENT}visitBinary(a){throw Error(al(a));}visitUtf8(a){throw Error(al(a));}visitBool(){return.125}visitDecimal(){return 16}visitDate(a){return 4*(a.unit+1)}visitTime(a){return a.bitWidth/8}visitTimestamp(a){return a.unit===D.SECOND?4:8}visitInterval(a){return 4*(a.unit+1)}visitList(a){throw Error(al(a));}visitStruct(a){return bl(this,a.children).reduce($k,0)}visitUnion(a){return bl(this,
a.children).reduce($k,0)}visitFixedSizeBinary(a){return a.byteWidth}visitFixedSizeList(a){return a.listSize*bl(this,a.children).reduce($k,0)}visitMap(a){return bl(this,a.children).reduce($k,0)}visitDictionary(a){return this.visit(a.indices)}}const dl=new cl;class el extends Tf{visitNull(){return ck}visitBool(){return tj}visitInt(){return Oj}visitInt8(){return Sj}visitInt16(){return Tj}visitInt32(){return Uj}visitInt64(){return Vj}visitUint8(){return Wj}visitUint16(){return Xj}visitUint32(){return Yj}visitUint64(){return Zj}visitFloat(){return Fj}visitFloat16(){return Ij}visitFloat32(){return Jj}visitFloat64(){return Kj}visitUtf8(){return sk}visitBinary(){return sj}visitFixedSizeBinary(){return Dj}visitDate(){return yj}visitDateDay(){return zj}visitDateMillisecond(){return Aj}visitTimestamp(){return fk}visitTimestampSecond(){return gk}visitTimestampMillisecond(){return hk}visitTimestampMicrosecond(){return ik}visitTimestampNanosecond(){return jk}visitTime(){return kk}visitTimeSecond(){return lk}visitTimeMillisecond(){return mk}visitTimeMicrosecond(){return nk}visitTimeNanosecond(){return ok}visitDecimal(){return Bj}visitList(){return ak}visitStruct(){return ek}visitUnion(){return pk}visitDenseUnion(){return qk}visitSparseUnion(){return rk}visitDictionary(){return Cj}visitInterval(){return Lj}visitIntervalDayTime(){return Mj}visitIntervalYearMonth(){return Nj}visitFixedSizeList(){return Ej}visitMap(){return bk}}
const fl=new el;z.new=gl;z.from=hl;function gl(a,...b){return new (fl.getVisitFn(a)())(a,...b)}function uj(a,b){if(Ra(b)||Sa(b))return z.from({nullValues:[null,void 0],type:a(),values:b});const {type:c=a(),nullValues:d=[null,void 0]}={...b};return z.from({nullValues:d,...b,type:c})}
function hl(a){const {values:b=[],...c}={nullValues:[null,void 0],...a};return Ra(b)?(a=[...M.throughIterable(c)(b)],1===a.length?a[0]:Bh.concat(a)):(async d=>{const e=M.throughAsyncIterable(c);for await(const f of e(b))d.push(f);return 1===d.length?d[0]:Bh.concat(d)})([])}g=U.prototype;g.get=function(a){return Qk.visit(this,a)};g.set=function(a,b){return sg.visit(this,a,b)};g.indexOf=function(a,b){return Tk.visit(this,a,b)};g.toArray=function(){return Zk.visit(this)};g.getByteWidth=function(){return dl.visit(this.type)};
U.prototype[Symbol.iterator]=function(){return Xk.visit(this)};U.prototype.Hb=il;Object.keys(H).map(a=>H[a]).filter(a=>"number"===typeof a).filter(a=>a!==H.NONE).forEach(a=>{const b=fl.visit(a);b.prototype.get=uk(Qk.getVisitFn(a));b.prototype.set=vk(sg.getVisitFn(a));b.prototype.indexOf=vk(Tk.getVisitFn(a));b.prototype.toArray=tk(Zk.getVisitFn(a));b.prototype.getByteWidth=jl(dl.getVisitFn(a));b.prototype[Symbol.iterator]=tk(Xk.getVisitFn(a))});
function jl(a){return function(){return a(this.type)}}function kl(a){return function(b){return this.isValid(b)?a.call(this,b):null}}function ll(a){return function(b,c){qc(this.nullBitmap,this.offset+b,null!=c)&&a.call(this,b,c)}}function il(){const a=this.nullBitmap;a&&0<a.byteLength&&(this.get=kl(this.get),this.set=ll(this.set))};class T extends Bh{constructor(...a){let b=null;a[0]instanceof N&&(b=a[0]);a=a[0]instanceof T?a[0].chunks:zh(Si,a,[],0);if(!b&&!(b=a[0]?.schema))throw new TypeError("Table must be initialized with a Schema or at least one RecordBatch");a[0]||(a[0]=new gj(b));super(new Qd(b.fields),a);this.u=b;this.o=a}static empty(a=new N([])){return new T(a,[])}static from(a){if(!a)return T.empty();if("object"===typeof a){const c=Ra(a.values)?a.type instanceof Qd?T.fromStruct(ek.from(a)):null:Sa(a.values)?ml(a):
null;if(null!==c)return c}let b=nl.from(a);return v(b)&&u(b.then)?(async()=>await T.from(await b))():b.isSync()&&(b=b.open())?b.schema?new T(b.schema,[...b]):T.empty():(async c=>{c=await c;const d=c.schema,e=[];if(d){for await(const f of c)e.push(f);return new T(d,e)}return T.empty()})(b.open())}static async fromAsync(a){return await T.from(a)}static fromStruct(a){return T.new(a.data.childData,a.type.children)}static new(...a){return new T(...oj(yh(a)))}get schema(){return this.u}get length(){return this.xa}get chunks(){return this.o}get numCols(){return this.kb}clone(a=
this.o){return new T(this.u,a)}getColumn(a){return this.getColumnAt(this.getColumnIndex(a))}getColumnAt(a){return this.getChildAt(a)}getColumnIndex(a){return this.u.fields.findIndex(b=>b.name===a)}getChildAt(a){if(0>a||a>=this.numChildren)return null;var b,c=this.u.fields;const d=this.P||(this.P=[]);if(b=d[a])return b;if(b=c[a])if(c=this.o.map(e=>e.getChildAt(a)).filter(e=>null!=e),0<c.length)return d[a]=new R(b,c);return null}serialize(a,b=!0){return(b?hj:ij).writeAll(this).toUint8Array(!0)}count(){return this.xa}select(...a){const b=
this.u.fields.reduce((c,d,e)=>c.set(d.name,e),new Map);return this.selectAt(...a.map(c=>b.get(c)).filter(c=>-1<c))}selectAt(...a){const b=this.u.selectAt(...a);return new T(b,this.o.map(({length:c,data:{childData:d}})=>new Si(b,c,a.map(e=>d[e]).filter(Boolean))))}assign(a){const b=this.u.fields,[c,d]=a.schema.fields.reduce((h,k,n)=>{const [p,w]=h,fa=b.findIndex(ob=>ob.name===k.name);~fa?w[fa]=n:p.push(n);return h},[[],[]]),e=this.u.assign(a.schema),f=[...b.map((h,k,n,p=d[k])=>void 0===p?this.getColumnAt(k):
a.getColumnAt(p)),...c.map(h=>a.getColumnAt(h))].filter(Boolean);return new T(...pj(e,f))}}function ml(a){return a.type instanceof Qd?ek.from(a).then(b=>T.fromStruct(b)):null};class Si extends ek{constructor(...a){const b=a[0];let c;if(a[1]instanceof L)[,a,c]=a;else{const d=b.fields,[,e,f]=a;a=L.Struct(new Qd(d),0,e,0,null,f)}super(a,c);this.u=b}static from(a){return T.from(a)}static new(...a){const [b,c]=xh(a,[[],[]]);a=c.filter(d=>d instanceof z);return new Si(...nj(new N(b),a.map(d=>d.data)))}clone(a,b=this.P){return new Si(this.u,a,b)}concat(...a){const b=this.u;a=Bh.flatten(this,...a);return new T(b,a.map(({data:c})=>new Si(b,c)))}get schema(){return this.u}get numCols(){return this.u.fields.length}get dictionaries(){return this.fa||
(this.fa=(new ol).visit(this.data,new Qd(this.schema.fields)).dictionaries)}select(...a){const b=this.u.fields.reduce((c,d,e)=>c.set(d.name,e),new Map);return this.selectAt(...a.map(c=>b.get(c)).filter(c=>-1<c))}selectAt(...a){const b=this.u.selectAt(...a);a=a.map(c=>this.data.childData[c]).filter(Boolean);return new Si(b,this.length,a)}}class gj extends Si{constructor(a){super(a,0,a.fields.map(b=>L.new(b.type,0,0,0)))}}
class ol extends Tf{constructor(){super(...arguments);this.dictionaries=new Map}visit(a,b){if(K.isDictionary(b))return this.visitDictionary(a,b);a.childData.forEach((c,d)=>this.visit(c,b.children[d].type));return this}visitDictionary(a,b){(a=a.dictionary)&&0<a.length&&this.dictionaries.set(b.id,a);return this}};class nl extends Ja{constructor(a){super();this.s=a}get closed(){return this.s.closed}get schema(){return this.s.schema}get autoDestroy(){return this.s.autoDestroy}get dictionaries(){return this.s.dictionaries}get numDictionaries(){return this.s.numDictionaries}get numRecordBatches(){return this.s.numRecordBatches}get footer(){return this.s.isFile()?this.s.footer:null}isSync(){return this.s.isSync()}isAsync(){return this.s.isAsync()}isFile(){return this.s.isFile()}isStream(){return this.s.isStream()}next(){return this.s.next()}throw(a){return this.s.throw(a)}return(a){return this.s.return(a)}cancel(){return this.s.cancel()}reset(a){this.s.reset(a);
this.Nb=this.Fb=void 0;return this}open(a){a=this.s.open(a);return v(a)&&u(a.then)?a.then(()=>this):this}readRecordBatch(a){return this.s.isFile()?this.s.readRecordBatch(a):null}[Symbol.iterator](){return this.s[Symbol.iterator]()}[Symbol.asyncIterator](){return this.s[Symbol.asyncIterator]()}toDOMStream(){return La(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return Ma(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}static throughNode(){throw Error('"throughNode" not available in this environment');
}static throughDOM(){throw Error('"throughDOM" not available in this environment');}static from(a){return a instanceof nl?a:v(a)&&v(a.schema)?new pl(new ql(a)):v(a)&&u(a.stat)&&"number"===typeof a.fd?rl(a):v(a)&&u(a.then)?(async()=>await nl.from(await a))():v(a)&&Ta(a.body)||Ta(a)||Ua(a)||Sa(a)?sl(new Gg(a)):tl(new Eg(a))}static readAll(a){return a instanceof nl?a.isSync()?ul(a):vl(a):v(a)&&v(a.schema)||ArrayBuffer.isView(a)||Ra(a)||v(a)&&"done"in a&&"value"in a?ul(a):vl(a)}}
class pl extends nl{constructor(a){super(a);this.s=a}[Symbol.iterator](){return this.s[Symbol.iterator]()}async*[Symbol.asyncIterator](){yield*this[Symbol.iterator]()}}class wl extends nl{constructor(a){super(a);this.s=a}[Symbol.iterator](){throw Error("AsyncRecordBatchStreamReader is not Iterable");}[Symbol.asyncIterator](){return this.s[Symbol.asyncIterator]()}}class xl extends pl{constructor(a){super(a);this.s=a}}class yl extends wl{constructor(a){super(a);this.s=a}}
function zl(a,b,c){return new Si(a.schema,b.length,a.Na(b,c,a.schema.fields))}function Al(a,b,c){var d=b.id;const e=b.Za;b=b.data;const f=a.schema,h=a.dictionaries.get(d);return e||!h?(d=f.dictionaries.get(d),h&&e?h.concat(z.new(a.Na(b,c,[d])[0])):z.new(a.Na(b,c,[d])[0])):h}
class Bl{constructor(a=new Map){this.closed=!1;this.autoDestroy=!0;this.N=this.X=0;this.dictionaries=a}get numDictionaries(){return this.X}get numRecordBatches(){return this.N}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(a){this.N=this.X=0;this.schema=a;this.dictionaries=new Map;return this}Na(a,b,c){return(new Tg(b,a.M,a.buffers,this.dictionaries)).visitMany(c)}}
class Cl extends Bl{constructor(a,b){super(b);this.A=v(a)&&v(a.schema)?new yi(this.J=a):new wi(this.J=a)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset().A.return(),this.dictionaries=this.A=null)}open(a){this.closed||(this.autoDestroy=Dl(this,a),this.schema||(this.schema=this.A.readSchema())||this.cancel());return this}throw(a){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset().A.throw(a):t}return(a){return!this.closed&&
this.autoDestroy&&(this.closed=!0)?this.reset().A.return(a):t}next(){if(this.closed)return t;for(var a,b=this.A;a=this.za();)if(a.isSchema())this.reset(a.header());else{if(a.isRecordBatch()){this.N++;var c=a.header();b=b.readMessageBody(a.bodyLength);return{done:!1,value:zl(this,c,b)}}a.isDictionaryBatch()&&(this.X++,c=a.header(),a=b.readMessageBody(a.bodyLength),a=Al(this,c,a),this.dictionaries.set(c.id,a))}return this.schema&&0===this.N?(this.N++,{done:!1,value:new gj(this.schema)}):this.return()}za(){return this.A.readMessage(void 0)}}
class El extends Bl{constructor(a,b){super(b);this.A=new xi(this.J=a)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}async cancel(){!this.closed&&(this.closed=!0)&&(await this.reset().A.return(),this.dictionaries=this.A=null)}async open(a){this.closed||(this.autoDestroy=Dl(this,a),this.schema||(this.schema=await this.A.readSchema())||await this.cancel());return this}async throw(a){return!this.closed&&this.autoDestroy&&(this.closed=!0)?await this.reset().A.throw(a):t}async return(a){return!this.closed&&
this.autoDestroy&&(this.closed=!0)?await this.reset().A.return(a):t}async next(){if(this.closed)return t;for(var a,b=this.A;a=await this.za();)if(a.isSchema())await this.reset(a.header());else{if(a.isRecordBatch()){this.N++;var c=a.header();b=await b.readMessageBody(a.bodyLength);return{done:!1,value:zl(this,c,b)}}a.isDictionaryBatch()&&(this.X++,c=a.header(),a=await b.readMessageBody(a.bodyLength),a=Al(this,c,a),this.dictionaries.set(c.id,a))}return this.schema&&0===this.N?(this.N++,{done:!1,value:new gj(this.schema)}):
await this.return()}async za(){return await this.A.readMessage(void 0)}}
class Fl extends Cl{constructor(a){super(a instanceof Ig?a:new Ig(a),void 0)}get footer(){return this.j}get numDictionaries(){return this.j?this.j.numDictionaries:0}get numRecordBatches(){return this.j?this.j.numRecordBatches:0}isSync(){return!0}isFile(){return!0}open(a){if(!this.closed&&!this.j){this.schema=(this.j=this.nb()).schema;for(const b of zg(this.j))b&&this.mb(this.X++)}return super.open(a)}readRecordBatch(a){if(this.closed)return null;this.j||this.open();if((a=this.j&&this.j.na(a))&&this.J.seek(a.offset)){var b=
this.A.readMessage(G.RecordBatch);if(b?.isRecordBatch())return a=b.header(),b=this.A.readMessageBody(b.bodyLength),zl(this,a,b)}return null}mb(a){if((a=this.j&&this.j.Ya(a))&&this.J.seek(a.offset)){var b=this.A.readMessage(G.DictionaryBatch);b?.isDictionaryBatch()&&(a=b.header(),b=this.A.readMessageBody(b.bodyLength),b=Al(this,a,b),this.dictionaries.set(a.id,b))}}nb(){var a=this.J;const b=a.size-Ci,c=a.v(b);a=a.oa(b-c,c);return Ag.decode(a)}za(){this.j||this.open();if(this.j&&this.N<this.numRecordBatches){const a=
this.j&&this.j.na(this.N);if(a&&this.J.seek(a.offset))return this.A.readMessage(void 0)}return null}}
class Gl extends El{constructor(a){var b=[];const c="number"!==typeof b[0]?b.shift():void 0;b=b[0]instanceof Map?b.shift():void 0;super(a instanceof Jg?a:new Jg(a,c),b)}get footer(){return this.j}get numDictionaries(){return this.j?this.j.numDictionaries:0}get numRecordBatches(){return this.j?this.j.numRecordBatches:0}isFile(){return!0}isAsync(){return!0}async open(a){if(!this.closed&&!this.j){this.schema=(this.j=await this.nb()).schema;for(const b of zg(this.j))b&&await this.mb(this.X++)}return await super.open(a)}async readRecordBatch(a){if(this.closed)return null;
this.j||await this.open();if((a=this.j&&this.j.na(a))&&await this.J.seek(a.offset)){var b=await this.A.readMessage(G.RecordBatch);if(b?.isRecordBatch())return a=b.header(),b=await this.A.readMessageBody(b.bodyLength),zl(this,a,b)}return null}async mb(a){if((a=this.j&&this.j.Ya(a))&&await this.J.seek(a.offset)){var b=await this.A.readMessage(G.DictionaryBatch);b?.isDictionaryBatch()&&(a=b.header(),b=await this.A.readMessageBody(b.bodyLength),b=Al(this,a,b),this.dictionaries.set(a.id,b))}}async nb(){var a=
this.J;a.F&&await a.F;const b=a.size-Ci,c=await a.v(b);a=await a.oa(b-c,c);return Ag.decode(a)}async za(){this.j||await this.open();if(this.j&&this.N<this.numRecordBatches){const a=this.j.na(this.N);if(a&&await this.J.seek(a.offset))return await this.A.readMessage(void 0)}return null}}class ql extends Cl{constructor(a){super(a,void 0)}Na(a,b,c){return(new Ug(b,a.M,a.buffers,this.dictionaries)).visitMany(c)}}function Dl(a,b){return b&&"boolean"===typeof b.autoDestroy?b.autoDestroy:a.autoDestroy}
function*ul(a){a=nl.from(a);try{if(!a.open({autoDestroy:!1}).closed){do yield a;while(!a.reset().open().closed)}}finally{a.cancel()}}async function*vl(a){a=await nl.from(a);try{if(!(await a.open({autoDestroy:!1})).closed){do yield a;while(!(await a.reset().open()).closed)}}finally{await a.cancel()}}function tl(a){const b=a.peek(Bi+7&-8);return b&&4<=b.byteLength?Ai(b)?new xl(new Fl(a.read())):new pl(new Cl(a)):new pl(new Cl(function*(){}()))}
async function sl(a){const b=await a.peek(Bi+7&-8);return b&&4<=b.byteLength?Ai(b)?new xl(new Fl(await a.read())):new wl(new El(a)):new wl(new El(async function*(){}()))}async function rl(a){const {size:b}=await a.stat();a=new Jg(a,b);return b>=Di&&Ai(await a.oa(0,Bi+7&-8))?new yl(new Gl(a)):new wl(new El(a))};function Hl(a,b){function c(f,h){let k,n,p=f.desiredSize||null;for(;!(n=h.next(e?p:null)).done;)if(ArrayBuffer.isView(n.value)&&(k=x(Uint8Array,n.value))&&(null!=p&&e&&(p=p-k.byteLength+1),n.value=k),f.enqueue(n.value),null!=p&&0>=--p)return;f.close()}let d=null;const e="bytes"===b?.type||!1;return new ReadableStream({...b,start(f){c(f,d||(d=a[Symbol.iterator]()))},pull(f){d?c(f,d):f.close()},cancel(){d?.return&&d.return();d=null}},{highWaterMark:e?b?.highWaterMark||2**24:void 0,...b})}
function Il(a,b){async function c(f,h){let k,n,p=f.desiredSize||null;for(;!(n=await h.next(e?p:null)).done;)if(ArrayBuffer.isView(n.value)&&(k=x(Uint8Array,n.value))&&(null!=p&&e&&(p=p-k.byteLength+1),n.value=k),f.enqueue(n.value),null!=p&&0>=--p)return;f.close()}let d=null;const e="bytes"===b?.type||!1;return new ReadableStream({...b,async start(f){await c(f,d||(d=a[Symbol.asyncIterator]()))},async pull(f){d?await c(f,d):f.close()},async cancel(){d?.return&&await d.return();d=null}},{highWaterMark:e?
b?.highWaterMark||2**24:void 0,...b})};function Jl(a,b,c){null!==c&&(a.sa>=c.desiredSize&&++a.lb&&Kl(a,c,b.toVector()),b.finished&&((0<b.length||0===a.lb)&&++a.lb&&Kl(a,c,b.toVector()),!a.Jb&&(a.Jb=!0)&&Kl(a,c,null)))}function Kl(a,b,c){a.sa=0;a.ta=null;null===c?b.close():b.enqueue(c)}
class Ll{constructor(a){this.lb=0;this.Jb=!1;this.sa=0;const {["readableStrategy"]:b,["writableStrategy"]:c,["queueingStrategy"]:d="count",...e}=a;this.ta=null;this.ca=M.new(e);this.dc="bytes"!==d?Ml:Nl;({["highWaterMark"]:a="bytes"===d?16384:1E3}={...b});const {["highWaterMark"]:f="bytes"===d?16384:1E3}={...c};this.readable=new ReadableStream({["cancel"]:()=>{this.ca.clear()},["pull"]:h=>{Jl(this,this.ca,this.ta=h)},["start"]:h=>{Jl(this,this.ca,this.ta=h)}},{highWaterMark:a,size:"bytes"!==d?Ml:
Nl});this.writable=new WritableStream({["abort"]:()=>{this.ca.clear()},["write"]:()=>{Jl(this,this.ca,this.ta)},["close"]:()=>{Jl(this,this.ca.finish(),this.ta)}},{highWaterMark:f,size:h=>{const k=this.sa;this.sa=this.dc(this.ca.append(h));return this.sa-k}})}}const Ml=a=>a.length,Nl=a=>a.byteLength;function Ol(a,b){async function c(){return await (await nl.from(e)).open(b)}async function d(k,n){let p=k.desiredSize,w;for(;!(w=await n.next()).done;)if(k.enqueue(w.value),null!=p&&0>=--p)return;k.close()}const e=new Dg;let f=null;const h=new ReadableStream({async cancel(){await e.close()},async start(k){await d(k,f||(f=await c()))},async pull(k){f?await d(k,f):k.close()}});return{writable:new WritableStream(e,{highWaterMark:16384,...a}),readable:h}};function Pl(a,b){async function c(f){let h,k=f.desiredSize;for(;h=await e.read(k||null);)if(f.enqueue(h),null!=k&&0>=(k-=h.byteLength))return;f.close()}const d=new this(a),e=new Gg(d);b=new ReadableStream({type:"bytes",async cancel(){await e.cancel()},async pull(f){await c(f)},async start(f){await c(f)}},{highWaterMark:16384,...b});return{writable:new WritableStream(d,a),readable:b}};class Ql{eq(a){a instanceof Ql||(a=new Rl(a));return new Sl(this,a)}le(a){a instanceof Ql||(a=new Rl(a));return new Tl(this,a)}ge(a){a instanceof Ql||(a=new Rl(a));return new Ul(this,a)}lt(a){return new Vl(this.ge(a))}gt(a){return new Vl(this.le(a))}ne(a){return new Vl(this.eq(a))}}class Rl extends Ql{constructor(a){super();this.O=a}}
class Wl extends Ql{constructor(a){super();this.name=a}bind(a){if(!this.Va){this.Va=-1;const c=a.schema.fields;for(let d=-1;++d<c.length;)if(c[d].name===this.name){this.Va=d;break}if(0>this.Va)throw Error(`Failed to bind Col "${this.name}"`);}const b=this.Z=a.getChildAt(this.Va);return c=>b.get(c)}}class Xl{and(...a){return new Yl(this,...a)}or(...a){return new Zl(this,...a)}not(){return new Vl(this)}}
class $l extends Xl{constructor(a,b){super();this.left=a;this.right=b}bind(a){return this.left instanceof Rl?this.right instanceof Rl?this.cb(this.left,this.right):this.bb(a,this.left,this.right):this.right instanceof Rl?this.Ia(a,this.left,this.right):this.ab(a,this.left,this.right)}}class am extends Xl{constructor(...a){super();this.children=a}}am.prototype.children=Object.freeze([]);
class Yl extends am{constructor(...a){a=a.reduce((b,c)=>b.concat(c instanceof Yl?c.children:c),[]);super(...a)}bind(a){const b=this.children.map(c=>c.bind(a));return(c,d)=>b.every(e=>e(c,d))}}class Zl extends am{constructor(...a){a=a.reduce((b,c)=>b.concat(c instanceof Zl?c.children:c),[]);super(...a)}bind(a){const b=this.children.map(c=>c.bind(a));return(c,d)=>b.some(e=>e(c,d))}}
class Sl extends $l{cb(a,b){const c=a.O==b.O;return()=>c}ab(a,b,c){const d=b.bind(a),e=c.bind(a);return(f,h)=>d(f,h)==e(f,h)}Ia(a,b,c){const d=b.bind(a);if(b.Z instanceof Cj){let e;const f=b.Z;f.dictionary!==this.oc?(e=f.reverseLookup(c.O),this.oc=f.dictionary,this.pc=e):e=this.pc;return-1===e?()=>!1:h=>f.getKey(h)===e}return(e,f)=>d(e,f)==c.O}bb(a,b,c){return this.Ia(a,c,b)}}
class Tl extends $l{cb(a,b){const c=a.O<=b.O;return()=>c}ab(a,b,c){const d=b.bind(a),e=c.bind(a);return(f,h)=>d(f,h)<=e(f,h)}Ia(a,b,c){const d=b.bind(a);return(e,f)=>d(e,f)<=c.O}bb(a,b,c){const d=c.bind(a);return(e,f)=>b.O<=d(e,f)}}class Ul extends $l{cb(a,b){const c=a.O>=b.O;return()=>c}ab(a,b,c){const d=b.bind(a),e=c.bind(a);return(f,h)=>d(f,h)>=e(f,h)}Ia(a,b,c){const d=b.bind(a);return(e,f)=>d(e,f)>=c.O}bb(a,b,c){const d=c.bind(a);return(e,f)=>b.O>=d(e,f)}}
class Vl extends Xl{constructor(a){super();this.mc=a}bind(a){const b=this.mc.bind(a);return(c,d)=>!b(c,d)}}class bm extends Xl{constructor(a,b){super();this.next=a;this.kc=b}bind(a){this.kc(a);return this.next}}var Y={};Y.And=Yl;Y.Col=Wl;Y.CombinationPredicate=am;Y.ComparisonPredicate=$l;Y.CustomPredicate=bm;Y.Equals=Sl;Y.GTeq=Ul;Y.LTeq=Tl;Y.Literal=Rl;Y.Not=Vl;Y.Or=Zl;Y.Predicate=Xl;Y.Value=Ql;Y.and=function(...a){return new Yl(...a)};Y.col=function(a){return new Wl(a)};
Y.custom=function(a,b){return new bm(a,b)};Y.lit=function(a){return new Rl(a)};Y.or=function(...a){return new Zl(...a)};class cm extends T{filter(a){return new dm(this.chunks,a)}scan(a,b){const c=this.chunks,d=c.length;for(let e=-1;++e<d;){const f=c[e];b&&b(f);for(let h=-1,k=f.length;++h<k;)a(h,f)}}scanReverse(a,b){const c=this.chunks;for(var d=c.length;0<=--d;){const e=c[d];b&&b(e);for(let f=e.length;0<=--f;)a(f,e)}}countBy(a){const b=this.chunks,c=b.length;a="string"===typeof a?new Wl(a):a;a.bind(b[c-1]);const d=a.Z;if(!K.isDictionary(d.type))throw Error("countBy currently only supports dictionary-encoded columns");
var e=Math.ceil(Math.log(d.length)/Math.log(256));e=new (4==e?Uint32Array:2<=e?Uint16Array:Uint8Array)(d.dictionary.length);for(let h=-1;++h<c;){var f=b[h];a.bind(f);const k=a.Z.indices;for(let n=-1,p=f.length;++n<p;)f=k.get(n),null!==f&&e[f]++}return new em(d.dictionary,Oj.from(e))}}
class em extends T{constructor(a,b){const c=new N([new O("values",a.type),new O("counts",b.type)]);super(new Si(c,b.length,[a,b]))}toJSON(){const a=this.getColumnAt(0),b=this.getColumnAt(1),c={};for(let d=-1;++d<this.length;)c[a.get(d)]=b.get(d);return c}}
class fm{constructor(a,b){this.ea=a;this.predicate=b;this.index=this.Ta=0;this.ja=this.ea[this.Ta];this.Ub=this.predicate.bind(this.ja)}next(){for(;this.Ta<this.ea.length;){for(;this.index<this.ja.length;){if(this.Ub(this.index,this.ja))return{value:this.ja.get(this.index++)};this.index++}++this.Ta<this.ea.length&&(this.index=0,this.ja=this.ea[this.Ta],this.Ub=this.predicate.bind(this.ja))}return{done:!0,value:null}}[Symbol.iterator](){return this}}
class dm extends cm{constructor(a,b){super(a);this.ia=b}scan(a,b){const c=this.o,d=c.length;for(let e=-1;++e<d;){const f=c[e],h=this.ia.bind(f);let k=!1;for(let n=-1,p=f.length;++n<p;)h(n,f)&&(b&&!k&&(b(f),k=!0),a(n,f))}}scanReverse(a,b){const c=this.o;for(var d=c.length;0<=--d;){const e=c[d],f=this.ia.bind(e);let h=!1;for(let k=e.length;0<=--k;)f(k,e)&&(b&&!h&&(b(e),h=!0),a(k,e))}}count(){let a=0;const b=this.o,c=b.length;for(let d=-1;++d<c;){const e=b[d],f=this.ia.bind(e);for(let h=-1,k=e.length;++h<
k;)f(h,e)&&++a}return a}[Symbol.iterator](){return new fm(this.o,this.ia)}filter(a){return new dm(this.o,this.ia.and(a))}countBy(a){const b=this.o,c=b.length;a="string"===typeof a?new Wl(a):a;a.bind(b[c-1]);const d=a.Z;if(!K.isDictionary(d.type))throw Error("countBy currently only supports dictionary-encoded columns");var e=Math.ceil(Math.log(d.length)/Math.log(256));e=new (4==e?Uint32Array:2<=e?Uint16Array:Uint8Array)(d.dictionary.length);for(let f=-1;++f<c;){const h=b[f],k=this.ia.bind(h);a.bind(h);
const n=a.Z.indices;for(let p=-1,w=h.length;++p<w;){const fa=n.get(p);null!==fa&&k(p,h)&&e[fa]++}}return new em(d.dictionary,Oj.from(e))}};const gm={...jf,...Rg,...xc,...Ue,...y,...th,compareSchemas:Qi,compareFields:function(a,b){return Oi.compareFields(a,b)},compareTypes:function(a,b){return Oi.visit(a,b)}};La=function(a,b){if(Sa(a))return Il(a,b);if(Ra(a))return Hl(a,b);throw Error("toDOMStream() must be called with an Iterable or AsyncIterable");};M.throughDOM=function(a){return new Ll(a)};nl.throughDOM=Ol;xl.throughDOM=Ol;pl.throughDOM=Ol;dj.throughDOM=Pl;ij.throughDOM=Pl;hj.throughDOM=Pl;var Z={};Z.AsyncByteQueue=Dg;Z.AsyncByteStream=Gg;Z.AsyncMessageReader=xi;Z.AsyncRecordBatchFileReader=yl;Z.AsyncRecordBatchStreamReader=wl;Z.BaseVector=U;Z.Binary=Vc;Z.BinaryBuilder=Hf;Z.BinaryVector=sj;
Z.Bool=cd;Z.BoolBuilder=Ie;Z.BoolVector=tj;Z.BufferType=J;Z.Builder=M;Z.ByteStream=Eg;Z.Chunked=Bh;Z.Column=R;Z.CountByResult=em;Z.Data=L;Z.DataFrame=cm;Z.DataType=K;Z.DateBuilder=Ke;Z.DateDay=od;Z.DateDayBuilder=Le;Z.DateDayVector=zj;Z.DateMillisecond=pd;Z.DateMillisecondBuilder=Me;Z.DateMillisecondVector=Aj;Z.DateUnit=ub;Z.DateVector=yj;Z.Date_=kd;Z.Decimal=gd;Z.DecimalBuilder=Ne;Z.DecimalVector=Bj;Z.DenseUnion=Yd;Z.DenseUnionBuilder=Sf;Z.DenseUnionVector=qk;Z.Dictionary=me;
Z.DictionaryBuilder=Oe;Z.DictionaryVector=Cj;Z.Field=O;Z.FilteredDataFrame=dm;Z.FixedSizeBinary=$d;Z.FixedSizeBinaryBuilder=Pe;Z.FixedSizeBinaryVector=Dj;Z.FixedSizeList=de;Z.FixedSizeListBuilder=Nf;Z.FixedSizeListVector=Ej;Z.Float=Oc;Z.Float16=Sc;Z.Float16Builder=We;Z.Float16Vector=Ij;Z.Float32=Tc;Z.Float32Builder=Xe;Z.Float32Vector=Jj;Z.Float64=Uc;Z.Float64Builder=Ye;Z.Float64Vector=Kj;Z.FloatBuilder=Ve;Z.FloatVector=Fj;Z.Int=Cc;Z.Int16=Hc;Z.Int16Builder=mf;Z.Int16Vector=Tj;Z.Int32=Ic;
Z.Int32Builder=nf;Z.Int32Vector=Uj;Z.Int64=Jc;Z.Int64Builder=of;Z.Int64Vector=Vj;Z.Int8=Gc;Z.Int8Builder=lf;Z.Int8Vector=Sj;Z.IntBuilder=kf;Z.IntVector=Oj;Z.Interval=Gd;Z.IntervalBuilder=Ef;Z.IntervalDayTime=Kd;Z.IntervalDayTimeBuilder=Ff;Z.IntervalDayTimeVector=Mj;Z.IntervalUnit=xb;Z.IntervalVector=Lj;Z.IntervalYearMonth=Ld;Z.IntervalYearMonthBuilder=Gf;Z.IntervalYearMonthVector=Nj;Z.JSONMessageReader=yi;Z.List=Md;Z.ListBuilder=Mf;Z.ListVector=ak;Z.MapBuilder=Of;Z.MapVector=bk;Z.Map_=he;
Z.Message=Xh;Z.MessageHeader=G;Z.MessageReader=wi;Z.MetadataVersion=A;Z.Null=Bc;Z.NullBuilder=Je;Z.NullVector=ck;Z.Precision=C;Z.RecordBatch=Si;Z.RecordBatchFileReader=xl;Z.RecordBatchFileWriter=ij;Z.RecordBatchJSONWriter=jj;Z.RecordBatchReader=nl;Z.RecordBatchStreamReader=pl;Z.RecordBatchStreamWriter=hj;Z.RecordBatchWriter=dj;Z.Schema=N;Z.SparseUnion=Zd;Z.SparseUnionBuilder=Rf;Z.SparseUnionVector=rk;Z.Struct=Qd;Z.StructBuilder=Pf;Z.StructVector=ek;Z.Table=T;Z.Time=qd;Z.TimeBuilder=uf;
Z.TimeMicrosecond=wd;Z.TimeMicrosecondBuilder=xf;Z.TimeMicrosecondVector=nk;Z.TimeMillisecond=vd;Z.TimeMillisecondBuilder=wf;Z.TimeMillisecondVector=mk;Z.TimeNanosecond=xd;Z.TimeNanosecondBuilder=yf;Z.TimeNanosecondVector=ok;Z.TimeSecond=ud;Z.TimeSecondBuilder=vf;Z.TimeSecondVector=lk;Z.TimeUnit=D;Z.TimeVector=kk;Z.Timestamp=yd;Z.TimestampBuilder=zf;Z.TimestampMicrosecond=Ed;Z.TimestampMicrosecondBuilder=Cf;Z.TimestampMicrosecondVector=ik;Z.TimestampMillisecond=Dd;Z.TimestampMillisecondBuilder=Bf;
Z.TimestampMillisecondVector=hk;Z.TimestampNanosecond=Fd;Z.TimestampNanosecondBuilder=Df;Z.TimestampNanosecondVector=jk;Z.TimestampSecond=Cd;Z.TimestampSecondBuilder=Af;Z.TimestampSecondVector=gk;Z.TimestampVector=fk;Z.Type=H;Z.Uint16=Lc;Z.Uint16Builder=rf;Z.Uint16Vector=Xj;Z.Uint32=Mc;Z.Uint32Builder=sf;Z.Uint32Vector=Yj;Z.Uint64=Nc;Z.Uint64Builder=tf;Z.Uint64Vector=Zj;Z.Uint8=Kc;Z.Uint8Builder=qf;Z.Uint8Vector=Wj;Z.Union=Ud;Z.UnionBuilder=Qf;Z.UnionMode=B;Z.UnionVector=pk;Z.Utf8=Zc;
Z.Utf8Builder=If;Z.Utf8Vector=sk;Z.Vector=z;Z.Visitor=Tf;Z.isTypedArray=vh;Z.predicate=Y;Z.util=gm;Object.assign(arguments[0],Z);}.bind(this))));

//# sourceMappingURL=Arrow.esnext.min.js.map
